var Os=Object.defineProperty;var Is=(d,e,ot)=>e in d?Os(d,e,{enumerable:!0,configurable:!0,writable:!0,value:ot}):d[e]=ot;var Ie=(d,e,ot)=>(Is(d,typeof e!="symbol"?e+"":e,ot),ot),yn=(d,e,ot)=>{if(!e.has(d))throw TypeError("Cannot "+ot)};var s=(d,e,ot)=>(yn(d,e,"read from private field"),ot?ot.call(d):e.get(d)),Et=(d,e,ot)=>{if(e.has(d))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(d):e.set(d,ot)},Ut=(d,e,ot,i)=>(yn(d,e,"write to private field"),i?i.call(d,ot):e.set(d,ot),ot);var Ke=(d,e,ot,i)=>({set _(b){Ut(d,e,b,ot)},get _(){return s(d,e,i)}}),xt=(d,e,ot)=>(yn(d,e,"access private method"),ot);function _mergeNamespaces(d,e){for(var ot=0;ot<e.length;ot++){const i=e[ot];if(typeof i!="string"&&!Array.isArray(i)){for(const b in i)if(b!=="default"&&!(b in d)){const St=Object.getOwnPropertyDescriptor(i,b);St&&Object.defineProperty(d,b,St.get?St:{enumerable:!0,get:()=>i[b]})}}}return Object.freeze(Object.defineProperty(d,Symbol.toStringTag,{value:"Module"}))}function getDefaultExportFromCjs(d){return d&&d.__esModule&&Object.prototype.hasOwnProperty.call(d,"default")?d.default:d}function getAugmentedNamespace(d){if(d.__esModule)return d;var e=d.default;if(typeof e=="function"){var ot=function i(){return this instanceof i?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};ot.prototype=e.prototype}else ot={};return Object.defineProperty(ot,"__esModule",{value:!0}),Object.keys(d).forEach(function(i){var b=Object.getOwnPropertyDescriptor(d,i);Object.defineProperty(ot,i,b.get?b:{enumerable:!0,get:function(){return d[i]}})}),ot}var react={exports:{}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l=Symbol.for("react.element"),n=Symbol.for("react.portal"),p=Symbol.for("react.fragment"),q=Symbol.for("react.strict_mode"),r$1=Symbol.for("react.profiler"),t=Symbol.for("react.provider"),u=Symbol.for("react.context"),v=Symbol.for("react.forward_ref"),w=Symbol.for("react.suspense"),x=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),z=Symbol.iterator;function A(d){return d===null||typeof d!="object"?null:(d=z&&d[z]||d["@@iterator"],typeof d=="function"?d:null)}var B={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C=Object.assign,D={};function E(d,e,ot){this.props=d,this.context=e,this.refs=D,this.updater=ot||B}E.prototype.isReactComponent={};E.prototype.setState=function(d,e){if(typeof d!="object"&&typeof d!="function"&&d!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,d,e,"setState")};E.prototype.forceUpdate=function(d){this.updater.enqueueForceUpdate(this,d,"forceUpdate")};function F(){}F.prototype=E.prototype;function G(d,e,ot){this.props=d,this.context=e,this.refs=D,this.updater=ot||B}var H=G.prototype=new F;H.constructor=G;C(H,E.prototype);H.isPureReactComponent=!0;var I=Array.isArray,J=Object.prototype.hasOwnProperty,K={current:null},L={key:!0,ref:!0,__self:!0,__source:!0};function M(d,e,ot){var i,b={},St=null,bt=null;if(e!=null)for(i in e.ref!==void 0&&(bt=e.ref),e.key!==void 0&&(St=""+e.key),e)J.call(e,i)&&!L.hasOwnProperty(i)&&(b[i]=e[i]);var Wt=arguments.length-2;if(Wt===1)b.children=ot;else if(1<Wt){for(var ht=Array(Wt),rt=0;rt<Wt;rt++)ht[rt]=arguments[rt+2];b.children=ht}if(d&&d.defaultProps)for(i in Wt=d.defaultProps,Wt)b[i]===void 0&&(b[i]=Wt[i]);return{$$typeof:l,type:d,key:St,ref:bt,props:b,_owner:K.current}}function N(d,e){return{$$typeof:l,type:d.type,key:e,ref:d.ref,props:d.props,_owner:d._owner}}function O(d){return typeof d=="object"&&d!==null&&d.$$typeof===l}function escape$1(d){var e={"=":"=0",":":"=2"};return"$"+d.replace(/[=:]/g,function(ot){return e[ot]})}var P=/\/+/g;function Q(d,e){return typeof d=="object"&&d!==null&&d.key!=null?escape$1(""+d.key):e.toString(36)}function R(d,e,ot,i,b){var St=typeof d;(St==="undefined"||St==="boolean")&&(d=null);var bt=!1;if(d===null)bt=!0;else switch(St){case"string":case"number":bt=!0;break;case"object":switch(d.$$typeof){case l:case n:bt=!0}}if(bt)return bt=d,b=b(bt),d=i===""?"."+Q(bt,0):i,I(b)?(ot="",d!=null&&(ot=d.replace(P,"$&/")+"/"),R(b,e,ot,"",function(rt){return rt})):b!=null&&(O(b)&&(b=N(b,ot+(!b.key||bt&&bt.key===b.key?"":(""+b.key).replace(P,"$&/")+"/")+d)),e.push(b)),1;if(bt=0,i=i===""?".":i+":",I(d))for(var Wt=0;Wt<d.length;Wt++){St=d[Wt];var ht=i+Q(St,Wt);bt+=R(St,e,ot,ht,b)}else if(ht=A(d),typeof ht=="function")for(d=ht.call(d),Wt=0;!(St=d.next()).done;)St=St.value,ht=i+Q(St,Wt++),bt+=R(St,e,ot,ht,b);else if(St==="object")throw e=String(d),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(d).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return bt}function S(d,e,ot){if(d==null)return d;var i=[],b=0;return R(d,i,"","",function(St){return e.call(ot,St,b++)}),i}function T(d){if(d._status===-1){var e=d._result;e=e(),e.then(function(ot){(d._status===0||d._status===-1)&&(d._status=1,d._result=ot)},function(ot){(d._status===0||d._status===-1)&&(d._status=2,d._result=ot)}),d._status===-1&&(d._status=0,d._result=e)}if(d._status===1)return d._result.default;throw d._result}var U={current:null},V={transition:null},W={ReactCurrentDispatcher:U,ReactCurrentBatchConfig:V,ReactCurrentOwner:K};react_production_min.Children={map:S,forEach:function(d,e,ot){S(d,function(){e.apply(this,arguments)},ot)},count:function(d){var e=0;return S(d,function(){e++}),e},toArray:function(d){return S(d,function(e){return e})||[]},only:function(d){if(!O(d))throw Error("React.Children.only expected to receive a single React element child.");return d}};react_production_min.Component=E;react_production_min.Fragment=p;react_production_min.Profiler=r$1;react_production_min.PureComponent=G;react_production_min.StrictMode=q;react_production_min.Suspense=w;react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W;react_production_min.cloneElement=function(d,e,ot){if(d==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+d+".");var i=C({},d.props),b=d.key,St=d.ref,bt=d._owner;if(e!=null){if(e.ref!==void 0&&(St=e.ref,bt=K.current),e.key!==void 0&&(b=""+e.key),d.type&&d.type.defaultProps)var Wt=d.type.defaultProps;for(ht in e)J.call(e,ht)&&!L.hasOwnProperty(ht)&&(i[ht]=e[ht]===void 0&&Wt!==void 0?Wt[ht]:e[ht])}var ht=arguments.length-2;if(ht===1)i.children=ot;else if(1<ht){Wt=Array(ht);for(var rt=0;rt<ht;rt++)Wt[rt]=arguments[rt+2];i.children=Wt}return{$$typeof:l,type:d.type,key:b,ref:St,props:i,_owner:bt}};react_production_min.createContext=function(d){return d={$$typeof:u,_currentValue:d,_currentValue2:d,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},d.Provider={$$typeof:t,_context:d},d.Consumer=d};react_production_min.createElement=M;react_production_min.createFactory=function(d){var e=M.bind(null,d);return e.type=d,e};react_production_min.createRef=function(){return{current:null}};react_production_min.forwardRef=function(d){return{$$typeof:v,render:d}};react_production_min.isValidElement=O;react_production_min.lazy=function(d){return{$$typeof:y,_payload:{_status:-1,_result:d},_init:T}};react_production_min.memo=function(d,e){return{$$typeof:x,type:d,compare:e===void 0?null:e}};react_production_min.startTransition=function(d){var e=V.transition;V.transition={};try{d()}finally{V.transition=e}};react_production_min.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};react_production_min.useCallback=function(d,e){return U.current.useCallback(d,e)};react_production_min.useContext=function(d){return U.current.useContext(d)};react_production_min.useDebugValue=function(){};react_production_min.useDeferredValue=function(d){return U.current.useDeferredValue(d)};react_production_min.useEffect=function(d,e){return U.current.useEffect(d,e)};react_production_min.useId=function(){return U.current.useId()};react_production_min.useImperativeHandle=function(d,e,ot){return U.current.useImperativeHandle(d,e,ot)};react_production_min.useInsertionEffect=function(d,e){return U.current.useInsertionEffect(d,e)};react_production_min.useLayoutEffect=function(d,e){return U.current.useLayoutEffect(d,e)};react_production_min.useMemo=function(d,e){return U.current.useMemo(d,e)};react_production_min.useReducer=function(d,e,ot){return U.current.useReducer(d,e,ot)};react_production_min.useRef=function(d){return U.current.useRef(d)};react_production_min.useState=function(d){return U.current.useState(d)};react_production_min.useSyncExternalStore=function(d,e,ot){return U.current.useSyncExternalStore(d,e,ot)};react_production_min.useTransition=function(){return U.current.useTransition()};react_production_min.version="18.2.0";react.exports=react_production_min;var reactExports=react.exports;const React=getDefaultExportFromCjs(reactExports),React$1=_mergeNamespaces({__proto__:null,default:React},[reactExports]);var propTypes={exports:{}},ReactPropTypesSecret$1="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",ReactPropTypesSecret_1=ReactPropTypesSecret$1,ReactPropTypesSecret=ReactPropTypesSecret_1;function emptyFunction(){}function emptyFunctionWithReset(){}emptyFunctionWithReset.resetWarningCache=emptyFunction;var factoryWithThrowingShims=function(){function d(i,b,St,bt,Wt,ht){if(ht!==ReactPropTypesSecret){var rt=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw rt.name="Invariant Violation",rt}}d.isRequired=d;function e(){return d}var ot={array:d,bigint:d,bool:d,func:d,number:d,object:d,string:d,symbol:d,any:d,arrayOf:e,element:d,elementType:d,instanceOf:e,node:d,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:emptyFunctionWithReset,resetWarningCache:emptyFunction};return ot.PropTypes=ot,ot};propTypes.exports=factoryWithThrowingShims();var propTypesExports=propTypes.exports;const PropTypes=getDefaultExportFromCjs(propTypesExports);var has=Object.prototype.hasOwnProperty;function find(d,e,ot){for(ot of d.keys())if(dequal(ot,e))return ot}function dequal(d,e){var ot,i,b;if(d===e)return!0;if(d&&e&&(ot=d.constructor)===e.constructor){if(ot===Date)return d.getTime()===e.getTime();if(ot===RegExp)return d.toString()===e.toString();if(ot===Array){if((i=d.length)===e.length)for(;i--&&dequal(d[i],e[i]););return i===-1}if(ot===Set){if(d.size!==e.size)return!1;for(i of d)if(b=i,b&&typeof b=="object"&&(b=find(e,b),!b)||!e.has(b))return!1;return!0}if(ot===Map){if(d.size!==e.size)return!1;for(i of d)if(b=i[0],b&&typeof b=="object"&&(b=find(e,b),!b)||!dequal(i[1],e.get(b)))return!1;return!0}if(ot===ArrayBuffer)d=new Uint8Array(d),e=new Uint8Array(e);else if(ot===DataView){if((i=d.byteLength)===e.byteLength)for(;i--&&d.getInt8(i)===e.getInt8(i););return i===-1}if(ArrayBuffer.isView(d)){if((i=d.byteLength)===e.byteLength)for(;i--&&d[i]===e[i];);return i===-1}if(!ot||typeof d=="object"){i=0;for(ot in d)if(has.call(d,ot)&&++i&&!has.call(e,ot)||!(ot in e)||!dequal(d[ot],e[ot]))return!1;return Object.keys(e).length===i}}return d!==d&&e!==e}var warning=function(){},warning_1=warning;const warning$1=getDefaultExportFromCjs(warning_1);function commonjsRequire(d){throw new Error('Could not dynamically require "'+d+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf$1={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);(function(module,exports){(function(e,ot){module.exports=e.pdfjsLib=ot()})(globalThis,()=>(()=>{var __webpack_modules__=[,(d,e)=>{var Ce;Object.defineProperty(e,"__esModule",{value:!0}),e.VerbosityLevel=e.Util=e.UnknownErrorException=e.UnexpectedResponseException=e.TextRenderingMode=e.RenderingIntentFlag=e.PromiseCapability=e.PermissionFlag=e.PasswordResponses=e.PasswordException=e.PageActionEventType=e.OPS=e.MissingPDFException=e.MAX_IMAGE_SIZE_TO_CACHE=e.LINE_FACTOR=e.LINE_DESCENT_FACTOR=e.InvalidPDFException=e.ImageKind=e.IDENTITY_MATRIX=e.FormatError=e.FeatureTest=e.FONT_IDENTITY_MATRIX=e.DocumentActionEventType=e.CMapCompressionType=e.BaseException=e.BASELINE_FACTOR=e.AnnotationType=e.AnnotationReplyType=e.AnnotationPrefix=e.AnnotationMode=e.AnnotationFlag=e.AnnotationFieldFlag=e.AnnotationEditorType=e.AnnotationEditorPrefix=e.AnnotationEditorParamsType=e.AnnotationBorderStyleType=e.AnnotationActionEventType=e.AbortException=void 0,e.assert=Vt,e.bytesToString=vt,e.createValidAbsoluteUrl=se,e.getModificationDate=oe,e.getUuid=Te,e.getVerbosityLevel=Rt,e.info=Bt,e.isArrayBuffer=Xt,e.isArrayEqual=ae,e.isNodeJS=void 0,e.normalizeUnicode=we,e.objectFromMap=zt,e.objectSize=jt,e.setVerbosityLevel=at,e.shadow=re,e.string32=Lt,e.stringToBytes=Nt,e.stringToPDFString=Kt,e.stringToUTF8String=Ot,e.unreachable=Pt,e.utf8StringToString=It,e.warn=$t;const ot=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");e.isNodeJS=ot;const i=[1,0,0,1,0,0];e.IDENTITY_MATRIX=i;const b=[.001,0,0,.001,0,0];e.FONT_IDENTITY_MATRIX=b;const St=1e7;e.MAX_IMAGE_SIZE_TO_CACHE=St;const bt=1.35;e.LINE_FACTOR=bt;const Wt=.35;e.LINE_DESCENT_FACTOR=Wt;const ht=Wt/bt;e.BASELINE_FACTOR=ht;const rt={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};e.RenderingIntentFlag=rt;const X={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};e.AnnotationMode=X;const mt="pdfjs_internal_editor_";e.AnnotationEditorPrefix=mt;const _t={DISABLE:-1,NONE:0,FREETEXT:3,STAMP:13,INK:15};e.AnnotationEditorType=_t;const dt={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23};e.AnnotationEditorParamsType=dt;const st={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};e.PermissionFlag=st;const nt={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};e.TextRenderingMode=nt;const j={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};e.ImageKind=j;const tt={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};e.AnnotationType=tt;const ct={GROUP:"Group",REPLY:"R"};e.AnnotationReplyType=ct;const lt={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};e.AnnotationFlag=lt;const et={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};e.AnnotationFieldFlag=et;const f={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};e.AnnotationBorderStyleType=f;const _={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};e.AnnotationActionEventType=_;const pt={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};e.DocumentActionEventType=pt;const Y={O:"PageOpen",C:"PageClose"};e.PageActionEventType=Y;const g={ERRORS:0,WARNINGS:1,INFOS:5};e.VerbosityLevel=g;const ft={NONE:0,BINARY:1};e.CMapCompressionType=ft;const $={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};e.OPS=$;const Tt={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};e.PasswordResponses=Tt;let wt=g.WARNINGS;function at(qt){Number.isInteger(qt)&&(wt=qt)}function Rt(){return wt}function Bt(qt){wt>=g.INFOS&&console.log(`Info: ${qt}`)}function $t(qt){wt>=g.WARNINGS&&console.log(`Warning: ${qt}`)}function Pt(qt){throw new Error(qt)}function Vt(qt,Dt){qt||Pt(Dt)}function Jt(qt){switch(qt==null?void 0:qt.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function se(qt,Dt=null,kt=null){if(!qt)return null;try{if(kt&&typeof qt=="string"){if(kt.addDefaultProtocol&&qt.startsWith("www.")){const ee=qt.match(/\./g);(ee==null?void 0:ee.length)>=2&&(qt=`http://${qt}`)}if(kt.tryConvertEncoding)try{qt=Ot(qt)}catch{}}const Zt=Dt?new URL(qt,Dt):new URL(qt);if(Jt(Zt))return Zt}catch{}return null}function re(qt,Dt,kt,Zt=!1){return Object.defineProperty(qt,Dt,{value:kt,enumerable:!Zt,configurable:!0,writable:!1}),kt}const ut=function(){function Dt(kt,Zt){this.constructor===Dt&&Pt("Cannot initialize BaseException."),this.message=kt,this.name=Zt}return Dt.prototype=new Error,Dt.constructor=Dt,Dt}();e.BaseException=ut;class o extends ut{constructor(Dt,kt){super(Dt,"PasswordException"),this.code=kt}}e.PasswordException=o;class h extends ut{constructor(Dt,kt){super(Dt,"UnknownErrorException"),this.details=kt}}e.UnknownErrorException=h;class c extends ut{constructor(Dt){super(Dt,"InvalidPDFException")}}e.InvalidPDFException=c;class m extends ut{constructor(Dt){super(Dt,"MissingPDFException")}}e.MissingPDFException=m;class k extends ut{constructor(Dt,kt){super(Dt,"UnexpectedResponseException"),this.status=kt}}e.UnexpectedResponseException=k;class it extends ut{constructor(Dt){super(Dt,"FormatError")}}e.FormatError=it;class gt extends ut{constructor(Dt){super(Dt,"AbortException")}}e.AbortException=gt;function vt(qt){(typeof qt!="object"||(qt==null?void 0:qt.length)===void 0)&&Pt("Invalid argument for bytesToString");const Dt=qt.length,kt=8192;if(Dt<kt)return String.fromCharCode.apply(null,qt);const Zt=[];for(let ee=0;ee<Dt;ee+=kt){const Oe=Math.min(ee+kt,Dt),Le=qt.subarray(ee,Oe);Zt.push(String.fromCharCode.apply(null,Le))}return Zt.join("")}function Nt(qt){typeof qt!="string"&&Pt("Invalid argument for stringToBytes");const Dt=qt.length,kt=new Uint8Array(Dt);for(let Zt=0;Zt<Dt;++Zt)kt[Zt]=qt.charCodeAt(Zt)&255;return kt}function Lt(qt){return String.fromCharCode(qt>>24&255,qt>>16&255,qt>>8&255,qt&255)}function jt(qt){return Object.keys(qt).length}function zt(qt){const Dt=Object.create(null);for(const[kt,Zt]of qt)Dt[kt]=Zt;return Dt}function Yt(){const qt=new Uint8Array(4);return qt[0]=1,new Uint32Array(qt.buffer,0,1)[0]===1}function Gt(){try{return new Function(""),!0}catch{return!1}}class le{static get isLittleEndian(){return re(this,"isLittleEndian",Yt())}static get isEvalSupported(){return re(this,"isEvalSupported",Gt())}static get isOffscreenCanvasSupported(){return re(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?re(this,"platform",{isWin:!1,isMac:!1}):re(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}static get isCSSRoundSupported(){var Dt,kt;return re(this,"isCSSRoundSupported",(kt=(Dt=globalThis.CSS)==null?void 0:Dt.supports)==null?void 0:kt.call(Dt,"width: round(1.5px, 1px)"))}}e.FeatureTest=le;const ge=[...Array(256).keys()].map(qt=>qt.toString(16).padStart(2,"0"));class ne{static makeHexColor(Dt,kt,Zt){return`#${ge[Dt]}${ge[kt]}${ge[Zt]}`}static scaleMinMax(Dt,kt){let Zt;Dt[0]?(Dt[0]<0&&(Zt=kt[0],kt[0]=kt[1],kt[1]=Zt),kt[0]*=Dt[0],kt[1]*=Dt[0],Dt[3]<0&&(Zt=kt[2],kt[2]=kt[3],kt[3]=Zt),kt[2]*=Dt[3],kt[3]*=Dt[3]):(Zt=kt[0],kt[0]=kt[2],kt[2]=Zt,Zt=kt[1],kt[1]=kt[3],kt[3]=Zt,Dt[1]<0&&(Zt=kt[2],kt[2]=kt[3],kt[3]=Zt),kt[2]*=Dt[1],kt[3]*=Dt[1],Dt[2]<0&&(Zt=kt[0],kt[0]=kt[1],kt[1]=Zt),kt[0]*=Dt[2],kt[1]*=Dt[2]),kt[0]+=Dt[4],kt[1]+=Dt[4],kt[2]+=Dt[5],kt[3]+=Dt[5]}static transform(Dt,kt){return[Dt[0]*kt[0]+Dt[2]*kt[1],Dt[1]*kt[0]+Dt[3]*kt[1],Dt[0]*kt[2]+Dt[2]*kt[3],Dt[1]*kt[2]+Dt[3]*kt[3],Dt[0]*kt[4]+Dt[2]*kt[5]+Dt[4],Dt[1]*kt[4]+Dt[3]*kt[5]+Dt[5]]}static applyTransform(Dt,kt){const Zt=Dt[0]*kt[0]+Dt[1]*kt[2]+kt[4],ee=Dt[0]*kt[1]+Dt[1]*kt[3]+kt[5];return[Zt,ee]}static applyInverseTransform(Dt,kt){const Zt=kt[0]*kt[3]-kt[1]*kt[2],ee=(Dt[0]*kt[3]-Dt[1]*kt[2]+kt[2]*kt[5]-kt[4]*kt[3])/Zt,Oe=(-Dt[0]*kt[1]+Dt[1]*kt[0]+kt[4]*kt[1]-kt[5]*kt[0])/Zt;return[ee,Oe]}static getAxialAlignedBoundingBox(Dt,kt){const Zt=this.applyTransform(Dt,kt),ee=this.applyTransform(Dt.slice(2,4),kt),Oe=this.applyTransform([Dt[0],Dt[3]],kt),Le=this.applyTransform([Dt[2],Dt[1]],kt);return[Math.min(Zt[0],ee[0],Oe[0],Le[0]),Math.min(Zt[1],ee[1],Oe[1],Le[1]),Math.max(Zt[0],ee[0],Oe[0],Le[0]),Math.max(Zt[1],ee[1],Oe[1],Le[1])]}static inverseTransform(Dt){const kt=Dt[0]*Dt[3]-Dt[1]*Dt[2];return[Dt[3]/kt,-Dt[1]/kt,-Dt[2]/kt,Dt[0]/kt,(Dt[2]*Dt[5]-Dt[4]*Dt[3])/kt,(Dt[4]*Dt[1]-Dt[5]*Dt[0])/kt]}static singularValueDecompose2dScale(Dt){const kt=[Dt[0],Dt[2],Dt[1],Dt[3]],Zt=Dt[0]*kt[0]+Dt[1]*kt[2],ee=Dt[0]*kt[1]+Dt[1]*kt[3],Oe=Dt[2]*kt[0]+Dt[3]*kt[2],Le=Dt[2]*kt[1]+Dt[3]*kt[3],Mt=(Zt+Le)/2,ie=Math.sqrt((Zt+Le)**2-4*(Zt*Le-Oe*ee))/2,be=Mt+ie||1,ce=Mt-ie||1;return[Math.sqrt(be),Math.sqrt(ce)]}static normalizeRect(Dt){const kt=Dt.slice(0);return Dt[0]>Dt[2]&&(kt[0]=Dt[2],kt[2]=Dt[0]),Dt[1]>Dt[3]&&(kt[1]=Dt[3],kt[3]=Dt[1]),kt}static intersect(Dt,kt){const Zt=Math.max(Math.min(Dt[0],Dt[2]),Math.min(kt[0],kt[2])),ee=Math.min(Math.max(Dt[0],Dt[2]),Math.max(kt[0],kt[2]));if(Zt>ee)return null;const Oe=Math.max(Math.min(Dt[1],Dt[3]),Math.min(kt[1],kt[3])),Le=Math.min(Math.max(Dt[1],Dt[3]),Math.max(kt[1],kt[3]));return Oe>Le?null:[Zt,Oe,ee,Le]}static bezierBoundingBox(Dt,kt,Zt,ee,Oe,Le,Mt,ie){const be=[],ce=[[],[]];let _e,ye,Me,te,ke,me,yt,a;for(let Ft=0;Ft<2;++Ft){if(Ft===0?(ye=6*Dt-12*Zt+6*Oe,_e=-3*Dt+9*Zt-9*Oe+3*Mt,Me=3*Zt-3*Dt):(ye=6*kt-12*ee+6*Le,_e=-3*kt+9*ee-9*Le+3*ie,Me=3*ee-3*kt),Math.abs(_e)<1e-12){if(Math.abs(ye)<1e-12)continue;te=-Me/ye,0<te&&te<1&&be.push(te);continue}yt=ye*ye-4*Me*_e,a=Math.sqrt(yt),!(yt<0)&&(ke=(-ye+a)/(2*_e),0<ke&&ke<1&&be.push(ke),me=(-ye-a)/(2*_e),0<me&&me<1&&be.push(me))}let Z=be.length,At;const Ct=Z;for(;Z--;)te=be[Z],At=1-te,ce[0][Z]=At*At*At*Dt+3*At*At*te*Zt+3*At*te*te*Oe+te*te*te*Mt,ce[1][Z]=At*At*At*kt+3*At*At*te*ee+3*At*te*te*Le+te*te*te*ie;return ce[0][Ct]=Dt,ce[1][Ct]=kt,ce[0][Ct+1]=Mt,ce[1][Ct+1]=ie,ce[0].length=ce[1].length=Ct+2,[Math.min(...ce[0]),Math.min(...ce[1]),Math.max(...ce[0]),Math.max(...ce[1])]}}e.Util=ne;const pe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function Kt(qt){if(qt[0]>="ï"){let kt;if(qt[0]==="þ"&&qt[1]==="ÿ"?kt="utf-16be":qt[0]==="ÿ"&&qt[1]==="þ"?kt="utf-16le":qt[0]==="ï"&&qt[1]==="»"&&qt[2]==="¿"&&(kt="utf-8"),kt)try{const Zt=new TextDecoder(kt,{fatal:!0}),ee=Nt(qt);return Zt.decode(ee)}catch(Zt){$t(`stringToPDFString: "${Zt}".`)}}const Dt=[];for(let kt=0,Zt=qt.length;kt<Zt;kt++){const ee=pe[qt.charCodeAt(kt)];Dt.push(ee?String.fromCharCode(ee):qt.charAt(kt))}return Dt.join("")}function Ot(qt){return decodeURIComponent(escape(qt))}function It(qt){return unescape(encodeURIComponent(qt))}function Xt(qt){return typeof qt=="object"&&(qt==null?void 0:qt.byteLength)!==void 0}function ae(qt,Dt){if(qt.length!==Dt.length)return!1;for(let kt=0,Zt=qt.length;kt<Zt;kt++)if(qt[kt]!==Dt[kt])return!1;return!0}function oe(qt=new Date){return[qt.getUTCFullYear().toString(),(qt.getUTCMonth()+1).toString().padStart(2,"0"),qt.getUTCDate().toString().padStart(2,"0"),qt.getUTCHours().toString().padStart(2,"0"),qt.getUTCMinutes().toString().padStart(2,"0"),qt.getUTCSeconds().toString().padStart(2,"0")].join("")}class Ae{constructor(){Et(this,Ce,!1);this.promise=new Promise((Dt,kt)=>{this.resolve=Zt=>{Ut(this,Ce,!0),Dt(Zt)},this.reject=Zt=>{Ut(this,Ce,!0),kt(Zt)}})}get settled(){return s(this,Ce)}}Ce=new WeakMap,e.PromiseCapability=Ae;let Pe=null,ve=null;function we(qt){return Pe||(Pe=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,ve=new Map([["ﬅ","ſt"]])),qt.replaceAll(Pe,(Dt,kt,Zt)=>kt?kt.normalize("NFKC"):ve.get(Zt))}function Te(){if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.randomUUID)=="function")return crypto.randomUUID();const qt=new Uint8Array(32);if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.getRandomValues)=="function")crypto.getRandomValues(qt);else for(let Dt=0;Dt<32;Dt++)qt[Dt]=Math.floor(Math.random()*255);return vt(qt)}const Ee="pdfjs_internal_id_";e.AnnotationPrefix=Ee},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var d,ot,i,b,Ve,bt,rn,ht,rt,X,mt,_t,dt,st,nt,j,an,ct,lt,An,f,_;Object.defineProperty(exports,"__esModule",{value:!0}),exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,Object.defineProperty(exports,"SVGGraphics",{enumerable:!0,get:function(){return _displaySvg.SVGGraphics}}),exports.build=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_displayNode_utils=__w_pdfjs_require__(10),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_displayFetch_stream=__w_pdfjs_require__(19),_displayNetwork=__w_pdfjs_require__(22),_displayNode_stream=__w_pdfjs_require__(23),_displaySvg=__w_pdfjs_require__(24),_xfa_text=__w_pdfjs_require__(25);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3,DefaultCanvasFactory=_util.isNodeJS?_displayNode_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;const DefaultCMapReaderFactory=_util.isNodeJS?_displayNode_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;const DefaultFilterFactory=_util.isNodeJS?_displayNode_utils.NodeFilterFactory:_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;const DefaultStandardFontDataFactory=_util.isNodeJS?_displayNode_utils.NodeStandardFontDataFactory:_display_utils.DOMStandardFontDataFactory;exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory;function getDocument(Y){if(typeof Y=="string"||Y instanceof URL?Y={url:Y}:(0,_util.isArrayBuffer)(Y)&&(Y={data:Y}),typeof Y!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!Y.url&&!Y.data&&!Y.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const g=new PDFDocumentLoadingTask,{docId:ft}=g,$=Y.url?getUrlProp(Y.url):null,Tt=Y.data?getDataProp(Y.data):null,wt=Y.httpHeaders||null,at=Y.withCredentials===!0,Rt=Y.password??null,Bt=Y.range instanceof PDFDataRangeTransport?Y.range:null,$t=Number.isInteger(Y.rangeChunkSize)&&Y.rangeChunkSize>0?Y.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let Pt=Y.worker instanceof PDFWorker?Y.worker:null;const Vt=Y.verbosity,Jt=typeof Y.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(Y.docBaseUrl)?Y.docBaseUrl:null,se=typeof Y.cMapUrl=="string"?Y.cMapUrl:null,re=Y.cMapPacked!==!1,ut=Y.CMapReaderFactory||DefaultCMapReaderFactory,o=typeof Y.standardFontDataUrl=="string"?Y.standardFontDataUrl:null,h=Y.StandardFontDataFactory||DefaultStandardFontDataFactory,c=Y.stopAtErrors!==!0,m=Number.isInteger(Y.maxImageSize)&&Y.maxImageSize>-1?Y.maxImageSize:-1,k=Y.isEvalSupported!==!1,it=typeof Y.isOffscreenCanvasSupported=="boolean"?Y.isOffscreenCanvasSupported:!_util.isNodeJS,gt=Number.isInteger(Y.canvasMaxAreaInBytes)?Y.canvasMaxAreaInBytes:-1,vt=typeof Y.disableFontFace=="boolean"?Y.disableFontFace:_util.isNodeJS,Nt=Y.fontExtraProperties===!0,Lt=Y.enableXfa===!0,jt=Y.ownerDocument||globalThis.document,zt=Y.disableRange===!0,Yt=Y.disableStream===!0,Gt=Y.disableAutoFetch===!0,le=Y.pdfBug===!0,ge=Bt?Bt.length:Y.length??NaN,ne=typeof Y.useSystemFonts=="boolean"?Y.useSystemFonts:!_util.isNodeJS&&!vt,pe=typeof Y.useWorkerFetch=="boolean"?Y.useWorkerFetch:ut===_display_utils.DOMCMapReaderFactory&&h===_display_utils.DOMStandardFontDataFactory&&se&&o&&(0,_display_utils.isValidFetchUrl)(se,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(o,document.baseURI),Kt=Y.canvasFactory||new DefaultCanvasFactory({ownerDocument:jt}),Ot=Y.filterFactory||new DefaultFilterFactory({docId:ft,ownerDocument:jt}),It=null;(0,_util.setVerbosityLevel)(Vt);const Xt={canvasFactory:Kt,filterFactory:Ot};if(pe||(Xt.cMapReaderFactory=new ut({baseUrl:se,isCompressed:re}),Xt.standardFontDataFactory=new h({baseUrl:o})),!Pt){const Ae={verbosity:Vt,port:_worker_options.GlobalWorkerOptions.workerPort};Pt=Ae.port?PDFWorker.fromPort(Ae):new PDFWorker(Ae),g._worker=Pt}const ae={docId:ft,apiVersion:"3.11.174",data:Tt,password:Rt,disableAutoFetch:Gt,rangeChunkSize:$t,length:ge,docBaseUrl:Jt,enableXfa:Lt,evaluatorOptions:{maxImageSize:m,disableFontFace:vt,ignoreErrors:c,isEvalSupported:k,isOffscreenCanvasSupported:it,canvasMaxAreaInBytes:gt,fontExtraProperties:Nt,useSystemFonts:ne,cMapUrl:pe?se:null,standardFontDataUrl:pe?o:null}},oe={ignoreErrors:c,isEvalSupported:k,disableFontFace:vt,fontExtraProperties:Nt,enableXfa:Lt,ownerDocument:jt,disableAutoFetch:Gt,pdfBug:le,styleElement:It};return Pt.promise.then(function(){if(g.destroyed)throw new Error("Loading aborted");const Ae=_fetchDocument(Pt,ae),Pe=new Promise(function(ve){let we;Bt?we=new _transport_stream.PDFDataTransportStream({length:ge,initialData:Bt.initialData,progressiveDone:Bt.progressiveDone,contentDispositionFilename:Bt.contentDispositionFilename,disableRange:zt,disableStream:Yt},Bt):Tt||(we=(Ee=>_util.isNodeJS?new _displayNode_stream.PDFNodeStream(Ee):(0,_display_utils.isValidFetchUrl)(Ee.url)?new _displayFetch_stream.PDFFetchStream(Ee):new _displayNetwork.PDFNetworkStream(Ee))({url:$,length:ge,httpHeaders:wt,withCredentials:at,rangeChunkSize:$t,disableRange:zt,disableStream:Yt})),ve(we)});return Promise.all([Ae,Pe]).then(function([ve,we]){if(g.destroyed)throw new Error("Loading aborted");const Te=new _message_handler.MessageHandler(ft,ve,Pt.port),Ee=new WorkerTransport(Te,g,we,oe,Xt);g._transport=Ee,Te.send("Ready",null)})}).catch(g._capability.reject),g}async function _fetchDocument(Y,g){if(Y.destroyed)throw new Error("Worker was destroyed");const ft=await Y.messageHandler.sendWithPromise("GetDocRequest",g,g.data?[g.data.buffer]:null);if(Y.destroyed)throw new Error("Worker was destroyed");return ft}function getUrlProp(Y){if(Y instanceof URL)return Y.href;try{return new URL(Y,window.location).href}catch{if(_util.isNodeJS&&typeof Y=="string")return Y}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(Y){if(_util.isNodeJS&&typeof Buffer<"u"&&Y instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(Y instanceof Uint8Array&&Y.byteLength===Y.buffer.byteLength)return Y;if(typeof Y=="string")return(0,_util.stringToBytes)(Y);if(typeof Y=="object"&&!isNaN(Y==null?void 0:Y.length)||(0,_util.isArrayBuffer)(Y))return new Uint8Array(Y);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}const e=class e{constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${Ke(e,d)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var g,ft,$;this.destroyed=!0;try{(g=this._worker)!=null&&g.port&&(this._worker._pendingDestroy=!0),await((ft=this._transport)==null?void 0:ft.destroy())}catch(Tt){throw($=this._worker)!=null&&$.port&&delete this._worker._pendingDestroy,Tt}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};d=new WeakMap,Et(e,d,0);let PDFDocumentLoadingTask=e;exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(g,ft,$=!1,Tt=null){this.length=g,this.initialData=ft,this.progressiveDone=$,this.contentDispositionFilename=Tt,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(g){this._rangeListeners.push(g)}addProgressListener(g){this._progressListeners.push(g)}addProgressiveReadListener(g){this._progressiveReadListeners.push(g)}addProgressiveDoneListener(g){this._progressiveDoneListeners.push(g)}onDataRange(g,ft){for(const $ of this._rangeListeners)$(g,ft)}onDataProgress(g,ft){this._readyCapability.promise.then(()=>{for(const $ of this._progressListeners)$(g,ft)})}onDataProgressiveRead(g){this._readyCapability.promise.then(()=>{for(const ft of this._progressiveReadListeners)ft(g)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const g of this._progressiveDoneListeners)g()})}transportReady(){this._readyCapability.resolve()}requestDataRange(g,ft){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(g,ft){this._pdfInfo=g,this._transport=ft,Object.defineProperty(this,"getJavaScript",{value:()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getJavaScript`, please use `PDFDocumentProxy.getJSActions` instead."),this.getJSActions().then($=>{if(!$)return $;const Tt=[];for(const wt in $)Tt.push(...$[wt]);return Tt}))})}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(g){return this._transport.getPage(g)}getPageIndex(g){return this._transport.getPageIndex(g)}getDestinations(){return this._transport.getDestinations()}getDestination(g){return this._transport.getDestination(g)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(g=!1){return this._transport.startCleanup(g||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(g,ft,$,Tt=!1){Et(this,b);Et(this,bt);Et(this,ot,null);Et(this,i,!1);this._pageIndex=g,this._pageInfo=ft,this._transport=$,this._stats=Tt?new _display_utils.StatTimer:null,this._pdfBug=Tt,this.commonObjs=$.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:g,rotation:ft=this.rotate,offsetX:$=0,offsetY:Tt=0,dontFlip:wt=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:g,rotation:ft,offsetX:$,offsetY:Tt,dontFlip:wt})}getAnnotations({intent:g="display"}={}){const ft=this._transport.getRenderingIntent(g);return this._transport.getAnnotations(this._pageIndex,ft.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var g;return((g=this._transport._htmlForXfa)==null?void 0:g.children[this._pageIndex])||null}render({canvasContext:g,viewport:ft,intent:$="display",annotationMode:Tt=_util.AnnotationMode.ENABLE,transform:wt=null,background:at=null,optionalContentConfigPromise:Rt=null,annotationCanvasMap:Bt=null,pageColors:$t=null,printAnnotationStorage:Pt=null}){var h,c;(h=this._stats)==null||h.time("Overall");const Vt=this._transport.getRenderingIntent($,Tt,Pt);Ut(this,i,!1),xt(this,bt,rn).call(this),Rt||(Rt=this._transport.getOptionalContentConfig());let Jt=this._intentStates.get(Vt.cacheKey);Jt||(Jt=Object.create(null),this._intentStates.set(Vt.cacheKey,Jt)),Jt.streamReaderCancelTimeout&&(clearTimeout(Jt.streamReaderCancelTimeout),Jt.streamReaderCancelTimeout=null);const se=!!(Vt.renderingIntent&_util.RenderingIntentFlag.PRINT);Jt.displayReadyCapability||(Jt.displayReadyCapability=new _util.PromiseCapability,Jt.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(c=this._stats)==null||c.time("Page Request"),this._pumpOperatorList(Vt));const re=m=>{var k,it;Jt.renderTasks.delete(ut),(this._maybeCleanupAfterRender||se)&&Ut(this,i,!0),xt(this,b,Ve).call(this,!se),m?(ut.capability.reject(m),this._abortOperatorList({intentState:Jt,reason:m instanceof Error?m:new Error(m)})):ut.capability.resolve(),(k=this._stats)==null||k.timeEnd("Rendering"),(it=this._stats)==null||it.timeEnd("Overall")},ut=new InternalRenderTask({callback:re,params:{canvasContext:g,viewport:ft,transform:wt,background:at},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:Bt,operatorList:Jt.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!se,pdfBug:this._pdfBug,pageColors:$t});(Jt.renderTasks||(Jt.renderTasks=new Set)).add(ut);const o=ut.task;return Promise.all([Jt.displayReadyCapability.promise,Rt]).then(([m,k])=>{var it;if(this.destroyed){re();return}(it=this._stats)==null||it.time("Rendering"),ut.initializeGraphics({transparency:m,optionalContentConfig:k}),ut.operatorListChanged()}).catch(re),o}getOperatorList({intent:g="display",annotationMode:ft=_util.AnnotationMode.ENABLE,printAnnotationStorage:$=null}={}){var Bt;function Tt(){at.operatorList.lastChunk&&(at.opListReadCapability.resolve(at.operatorList),at.renderTasks.delete(Rt))}const wt=this._transport.getRenderingIntent(g,ft,$,!0);let at=this._intentStates.get(wt.cacheKey);at||(at=Object.create(null),this._intentStates.set(wt.cacheKey,at));let Rt;return at.opListReadCapability||(Rt=Object.create(null),Rt.operatorListChanged=Tt,at.opListReadCapability=new _util.PromiseCapability,(at.renderTasks||(at.renderTasks=new Set)).add(Rt),at.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(Bt=this._stats)==null||Bt.time("Page Request"),this._pumpOperatorList(wt)),at.opListReadCapability.promise}streamTextContent({includeMarkedContent:g=!1,disableNormalization:ft=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:g===!0,disableNormalization:ft===!0},{highWaterMark:100,size(Tt){return Tt.items.length}})}getTextContent(g={}){if(this._transport._htmlForXfa)return this.getXfa().then($=>_xfa_text.XfaText.textContent($));const ft=this.streamTextContent(g);return new Promise(function($,Tt){function wt(){at.read().then(function({value:Bt,done:$t}){if($t){$(Rt);return}Object.assign(Rt.styles,Bt.styles),Rt.items.push(...Bt.items),wt()},Tt)}const at=ft.getReader(),Rt={items:[],styles:Object.create(null)};wt()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const g=[];for(const ft of this._intentStates.values())if(this._abortOperatorList({intentState:ft,reason:new Error("Page was destroyed."),force:!0}),!ft.opListReadCapability)for(const $ of ft.renderTasks)g.push($.completed),$.cancel();return this.objs.clear(),Ut(this,i,!1),xt(this,bt,rn).call(this),Promise.all(g)}cleanup(g=!1){Ut(this,i,!0);const ft=xt(this,b,Ve).call(this,!1);return g&&ft&&this._stats&&(this._stats=new _display_utils.StatTimer),ft}_startRenderPage(g,ft){var Tt,wt;const $=this._intentStates.get(ft);$&&((Tt=this._stats)==null||Tt.timeEnd("Page Request"),(wt=$.displayReadyCapability)==null||wt.resolve(g))}_renderPageChunk(g,ft){for(let $=0,Tt=g.length;$<Tt;$++)ft.operatorList.fnArray.push(g.fnArray[$]),ft.operatorList.argsArray.push(g.argsArray[$]);ft.operatorList.lastChunk=g.lastChunk,ft.operatorList.separateAnnots=g.separateAnnots;for(const $ of ft.renderTasks)$.operatorListChanged();g.lastChunk&&xt(this,b,Ve).call(this,!0)}_pumpOperatorList({renderingIntent:g,cacheKey:ft,annotationStorageSerializable:$}){const{map:Tt,transfers:wt}=$,Rt=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:g,cacheKey:ft,annotationStorage:Tt},wt).getReader(),Bt=this._intentStates.get(ft);Bt.streamReader=Rt;const $t=()=>{Rt.read().then(({value:Pt,done:Vt})=>{if(Vt){Bt.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(Pt,Bt),$t())},Pt=>{if(Bt.streamReader=null,!this._transport.destroyed){if(Bt.operatorList){Bt.operatorList.lastChunk=!0;for(const Vt of Bt.renderTasks)Vt.operatorListChanged();xt(this,b,Ve).call(this,!0)}if(Bt.displayReadyCapability)Bt.displayReadyCapability.reject(Pt);else if(Bt.opListReadCapability)Bt.opListReadCapability.reject(Pt);else throw Pt}})};$t()}_abortOperatorList({intentState:g,reason:ft,force:$=!1}){if(g.streamReader){if(g.streamReaderCancelTimeout&&(clearTimeout(g.streamReaderCancelTimeout),g.streamReaderCancelTimeout=null),!$){if(g.renderTasks.size>0)return;if(ft instanceof _display_utils.RenderingCancelledException){let Tt=RENDERING_CANCELLED_TIMEOUT;ft.extraDelay>0&&ft.extraDelay<1e3&&(Tt+=ft.extraDelay),g.streamReaderCancelTimeout=setTimeout(()=>{g.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:g,reason:ft,force:!0})},Tt);return}}if(g.streamReader.cancel(new _util.AbortException(ft.message)).catch(()=>{}),g.streamReader=null,!this._transport.destroyed){for(const[Tt,wt]of this._intentStates)if(wt===g){this._intentStates.delete(Tt);break}this.cleanup()}}}get stats(){return this._stats}}ot=new WeakMap,i=new WeakMap,b=new WeakSet,Ve=function(g=!1){if(xt(this,bt,rn).call(this),!s(this,i)||this.destroyed)return!1;if(g)return Ut(this,ot,setTimeout(()=>{Ut(this,ot,null),xt(this,b,Ve).call(this,!1)},DELAYED_CLEANUP_TIMEOUT)),!1;for(const{renderTasks:ft,operatorList:$}of this._intentStates.values())if(ft.size>0||!$.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),Ut(this,i,!1),!0},bt=new WeakSet,rn=function(){s(this,ot)&&(clearTimeout(s(this,ot)),Ut(this,ot,null))},exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){Et(this,ht,new Set);Et(this,rt,Promise.resolve())}postMessage(g,ft){const $={data:structuredClone(g,ft?{transfer:ft}:null)};s(this,rt).then(()=>{for(const Tt of s(this,ht))Tt.call(this,$)})}addEventListener(g,ft){s(this,ht).add(ft)}removeEventListener(g,ft){s(this,ht).delete(ft)}terminate(){s(this,ht).clear()}}ht=new WeakMap,rt=new WeakMap,exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_util.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const Y=(X=document==null?void 0:document.currentScript)==null?void 0:X.src;Y&&(PDFWorkerUtil.fallbackWorkerSrc=Y.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(Y,g){let ft;try{if(ft=new URL(Y),!ft.origin||ft.origin==="null")return!1}catch{return!1}const $=new URL(g,ft);return ft.origin===$.origin},PDFWorkerUtil.createCDNWrapper=function(Y){const g=`importScripts("${Y}");`;return URL.createObjectURL(new Blob([g]))}}const _PDFWorker=class _PDFWorker{constructor({name:Y=null,port:g=null,verbosity:ft=(0,_util.getVerbosityLevel)()}={}){var $;if(this.name=Y,this.destroyed=!1,this.verbosity=ft,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,g){if(($=s(_PDFWorker,mt))!=null&&$.has(g))throw new Error("Cannot use more than one PDFWorker per port.");(s(_PDFWorker,mt)||Ut(_PDFWorker,mt,new WeakMap)).set(g,this),this._initializeFromPort(g);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(Y){this._port=Y,this._messageHandler=new _message_handler.MessageHandler("main","worker",Y),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:Y}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,Y)||(Y=PDFWorkerUtil.createCDNWrapper(new URL(Y,window.location).href));const g=new Worker(Y),ft=new _message_handler.MessageHandler("main","worker",g),$=()=>{g.removeEventListener("error",Tt),ft.destroy(),g.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},Tt=()=>{this._webWorker||$()};g.addEventListener("error",Tt),ft.on("test",at=>{if(g.removeEventListener("error",Tt),this.destroyed){$();return}at?(this._messageHandler=ft,this._port=g,this._webWorker=g,this._readyCapability.resolve(),ft.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),ft.destroy(),g.terminate())}),ft.on("ready",at=>{if(g.removeEventListener("error",Tt),this.destroyed){$();return}try{wt()}catch{this._setupFakeWorker()}});const wt=()=>{const at=new Uint8Array;ft.send("test",at,[at.buffer])};wt();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(Y=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const g=new LoopbackPort;this._port=g;const ft=`fake${PDFWorkerUtil.fakeWorkerId++}`,$=new _message_handler.MessageHandler(ft+"_worker",ft,g);Y.setup($,g);const Tt=new _message_handler.MessageHandler(ft,ft+"_worker",g);this._messageHandler=Tt,this._readyCapability.resolve(),Tt.send("configure",{verbosity:this.verbosity})}).catch(Y=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${Y.message}".`))})}destroy(){var Y;this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),(Y=s(_PDFWorker,mt))==null||Y.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(Y){var ft;if(!(Y!=null&&Y.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const g=(ft=s(this,mt))==null?void 0:ft.get(Y.port);if(g){if(g._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return g}return new _PDFWorker(Y)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _util.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var Y;try{return((Y=globalThis.pdfjsWorker)==null?void 0:Y.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_util.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};mt=new WeakMap,Et(_PDFWorker,mt,void 0);let PDFWorker=_PDFWorker;exports.PDFWorker=PDFWorker;class WorkerTransport{constructor(g,ft,$,Tt,wt){Et(this,j);Et(this,_t,new Map);Et(this,dt,new Map);Et(this,st,new Map);Et(this,nt,null);this.messageHandler=g,this.loadingTask=ft,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:Tt.ownerDocument,styleElement:Tt.styleElement}),this._params=Tt,this.canvasFactory=wt.canvasFactory,this.filterFactory=wt.filterFactory,this.cMapReaderFactory=wt.cMapReaderFactory,this.standardFontDataFactory=wt.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=$,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(g,ft=_util.AnnotationMode.ENABLE,$=null,Tt=!1){let wt=_util.RenderingIntentFlag.DISPLAY,at=_annotation_storage.SerializableEmpty;switch(g){case"any":wt=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":wt=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${g}`)}switch(ft){case _util.AnnotationMode.DISABLE:wt+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:wt+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:wt+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,at=(wt&_util.RenderingIntentFlag.PRINT&&$ instanceof _annotation_storage.PrintAnnotationStorage?$:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${ft}`)}return Tt&&(wt+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:wt,cacheKey:`${wt}_${at.hash}`,annotationStorageSerializable:at}}destroy(){var $;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,($=s(this,nt))==null||$.reject(new Error("Worker was destroyed during onPassword callback"));const g=[];for(const Tt of s(this,dt).values())g.push(Tt._destroy());s(this,dt).clear(),s(this,st).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const ft=this.messageHandler.sendWithPromise("Terminate",null);return g.push(ft),Promise.all(g).then(()=>{var Tt;this.commonObjs.clear(),this.fontLoader.clear(),s(this,_t).clear(),this.filterFactory.destroy(),(Tt=this._networkStream)==null||Tt.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:g,loadingTask:ft}=this;g.on("GetReader",($,Tt)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=wt=>{this._lastProgress={loaded:wt.loaded,total:wt.total}},Tt.onPull=()=>{this._fullReader.read().then(function({value:wt,done:at}){if(at){Tt.close();return}(0,_util.assert)(wt instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),Tt.enqueue(new Uint8Array(wt),1,[wt])}).catch(wt=>{Tt.error(wt)})},Tt.onCancel=wt=>{this._fullReader.cancel(wt),Tt.ready.catch(at=>{if(!this.destroyed)throw at})}}),g.on("ReaderHeadersReady",$=>{const Tt=new _util.PromiseCapability,wt=this._fullReader;return wt.headersReady.then(()=>{var at;(!wt.isStreamingSupported||!wt.isRangeSupported)&&(this._lastProgress&&((at=ft.onProgress)==null||at.call(ft,this._lastProgress)),wt.onProgress=Rt=>{var Bt;(Bt=ft.onProgress)==null||Bt.call(ft,{loaded:Rt.loaded,total:Rt.total})}),Tt.resolve({isStreamingSupported:wt.isStreamingSupported,isRangeSupported:wt.isRangeSupported,contentLength:wt.contentLength})},Tt.reject),Tt.promise}),g.on("GetRangeReader",($,Tt)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const wt=this._networkStream.getRangeReader($.begin,$.end);if(!wt){Tt.close();return}Tt.onPull=()=>{wt.read().then(function({value:at,done:Rt}){if(Rt){Tt.close();return}(0,_util.assert)(at instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),Tt.enqueue(new Uint8Array(at),1,[at])}).catch(at=>{Tt.error(at)})},Tt.onCancel=at=>{wt.cancel(at),Tt.ready.catch(Rt=>{if(!this.destroyed)throw Rt})}}),g.on("GetDoc",({pdfInfo:$})=>{this._numPages=$.numPages,this._htmlForXfa=$.htmlForXfa,delete $.htmlForXfa,ft._capability.resolve(new PDFDocumentProxy($,this))}),g.on("DocException",function($){let Tt;switch($.name){case"PasswordException":Tt=new _util.PasswordException($.message,$.code);break;case"InvalidPDFException":Tt=new _util.InvalidPDFException($.message);break;case"MissingPDFException":Tt=new _util.MissingPDFException($.message);break;case"UnexpectedResponseException":Tt=new _util.UnexpectedResponseException($.message,$.status);break;case"UnknownErrorException":Tt=new _util.UnknownErrorException($.message,$.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}ft._capability.reject(Tt)}),g.on("PasswordRequest",$=>{if(Ut(this,nt,new _util.PromiseCapability),ft.onPassword){const Tt=wt=>{wt instanceof Error?s(this,nt).reject(wt):s(this,nt).resolve({password:wt})};try{ft.onPassword(Tt,$.code)}catch(wt){s(this,nt).reject(wt)}}else s(this,nt).reject(new _util.PasswordException($.message,$.code));return s(this,nt).promise}),g.on("DataLoaded",$=>{var Tt;(Tt=ft.onProgress)==null||Tt.call(ft,{loaded:$.length,total:$.length}),this.downloadInfoCapability.resolve($)}),g.on("StartRenderPage",$=>{if(this.destroyed)return;s(this,dt).get($.pageIndex)._startRenderPage($.transparency,$.cacheKey)}),g.on("commonobj",([$,Tt,wt])=>{var at;if(!this.destroyed&&!this.commonObjs.has($))switch(Tt){case"Font":const Rt=this._params;if("error"in wt){const Pt=wt.error;(0,_util.warn)(`Error during font loading: ${Pt}`),this.commonObjs.resolve($,Pt);break}const Bt=Rt.pdfBug&&((at=globalThis.FontInspector)!=null&&at.enabled)?(Pt,Vt)=>globalThis.FontInspector.fontAdded(Pt,Vt):null,$t=new _font_loader.FontFaceObject(wt,{isEvalSupported:Rt.isEvalSupported,disableFontFace:Rt.disableFontFace,ignoreErrors:Rt.ignoreErrors,inspectFont:Bt});this.fontLoader.bind($t).catch(Pt=>g.sendWithPromise("FontFallback",{id:$})).finally(()=>{!Rt.fontExtraProperties&&$t.data&&($t.data=null),this.commonObjs.resolve($,$t)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve($,wt);break;default:throw new Error(`Got unknown common object type ${Tt}`)}}),g.on("obj",([$,Tt,wt,at])=>{var Bt;if(this.destroyed)return;const Rt=s(this,dt).get(Tt);if(!Rt.objs.has($))switch(wt){case"Image":if(Rt.objs.resolve($,at),at){let $t;if(at.bitmap){const{width:Pt,height:Vt}=at;$t=Pt*Vt*4}else $t=((Bt=at.data)==null?void 0:Bt.length)||0;$t>_util.MAX_IMAGE_SIZE_TO_CACHE&&(Rt._maybeCleanupAfterRender=!0)}break;case"Pattern":Rt.objs.resolve($,at);break;default:throw new Error(`Got unknown object type ${wt}`)}}),g.on("DocProgress",$=>{var Tt;this.destroyed||(Tt=ft.onProgress)==null||Tt.call(ft,{loaded:$.loaded,total:$.total})}),g.on("FetchBuiltInCMap",$=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch($):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),g.on("FetchStandardFontData",$=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch($):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var $;this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:g,transfers:ft}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:g,filename:(($=this._fullReader)==null?void 0:$.filename)??null},ft).finally(()=>{this.annotationStorage.resetModified()})}getPage(g){if(!Number.isInteger(g)||g<=0||g>this._numPages)return Promise.reject(new Error("Invalid page request."));const ft=g-1,$=s(this,st).get(ft);if($)return $;const Tt=this.messageHandler.sendWithPromise("GetPage",{pageIndex:ft}).then(wt=>{if(this.destroyed)throw new Error("Transport destroyed");const at=new PDFPageProxy(ft,wt,this,this._params.pdfBug);return s(this,dt).set(ft,at),at});return s(this,st).set(ft,Tt),Tt}getPageIndex(g){return typeof g!="object"||g===null||!Number.isInteger(g.num)||g.num<0||!Number.isInteger(g.gen)||g.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:g.num,gen:g.gen})}getAnnotations(g,ft){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:g,intent:ft})}getFieldObjects(){return xt(this,j,an).call(this,"GetFieldObjects")}hasJSActions(){return xt(this,j,an).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(g){return typeof g!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:g})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return xt(this,j,an).call(this,"GetDocJSActions")}getPageJSActions(g){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:g})}getStructTree(g){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:g})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(g=>new _optional_content_config.OptionalContentConfig(g))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const g="GetMetadata",ft=s(this,_t).get(g);if(ft)return ft;const $=this.messageHandler.sendWithPromise(g,null).then(Tt=>{var wt,at;return{info:Tt[0],metadata:Tt[1]?new _metadata.Metadata(Tt[1]):null,contentDispositionFilename:((wt=this._fullReader)==null?void 0:wt.filename)??null,contentLength:((at=this._fullReader)==null?void 0:at.contentLength)??null}});return s(this,_t).set(g,$),$}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(g=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const ft of s(this,dt).values())if(!ft.cleanup())throw new Error(`startCleanup: Page ${ft.pageNumber} is currently rendering.`);this.commonObjs.clear(),g||this.fontLoader.clear(),s(this,_t).clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:g,enableXfa:ft}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:g,enableXfa:ft})}}_t=new WeakMap,dt=new WeakMap,st=new WeakMap,nt=new WeakMap,j=new WeakSet,an=function(g,ft=null){const $=s(this,_t).get(g);if($)return $;const Tt=this.messageHandler.sendWithPromise(g,ft);return s(this,_t).set(g,Tt),Tt};class PDFObjects{constructor(){Et(this,lt);Et(this,ct,Object.create(null))}get(g,ft=null){if(ft){const Tt=xt(this,lt,An).call(this,g);return Tt.capability.promise.then(()=>ft(Tt.data)),null}const $=s(this,ct)[g];if(!($!=null&&$.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${g}.`);return $.data}has(g){const ft=s(this,ct)[g];return(ft==null?void 0:ft.capability.settled)||!1}resolve(g,ft=null){const $=xt(this,lt,An).call(this,g);$.data=ft,$.capability.resolve()}clear(){var g;for(const ft in s(this,ct)){const{data:$}=s(this,ct)[ft];(g=$==null?void 0:$.bitmap)==null||g.close()}Ut(this,ct,Object.create(null))}}ct=new WeakMap,lt=new WeakSet,An=function(g){var ft;return(ft=s(this,ct))[g]||(ft[g]={capability:new _util.PromiseCapability,data:null})};class RenderTask{constructor(g){Et(this,f,null);Ut(this,f,g),this.onContinue=null}get promise(){return s(this,f).capability.promise}cancel(g=0){s(this,f).cancel(null,g)}get separateAnnots(){const{separateAnnots:g}=s(this,f).operatorList;if(!g)return!1;const{annotationCanvasMap:ft}=s(this,f);return g.form||g.canvas&&(ft==null?void 0:ft.size)>0}}f=new WeakMap,exports.RenderTask=RenderTask;const pt=class pt{constructor({callback:g,params:ft,objs:$,commonObjs:Tt,annotationCanvasMap:wt,operatorList:at,pageIndex:Rt,canvasFactory:Bt,filterFactory:$t,useRequestAnimationFrame:Pt=!1,pdfBug:Vt=!1,pageColors:Jt=null}){this.callback=g,this.params=ft,this.objs=$,this.commonObjs=Tt,this.annotationCanvasMap=wt,this.operatorListIdx=null,this.operatorList=at,this._pageIndex=Rt,this.canvasFactory=Bt,this.filterFactory=$t,this._pdfBug=Vt,this.pageColors=Jt,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=Pt===!0&&typeof window<"u",this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=ft.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:g=!1,optionalContentConfig:ft}){var Rt,Bt;if(this.cancelled)return;if(this._canvas){if(s(pt,_).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");s(pt,_).add(this._canvas)}this._pdfBug&&((Rt=globalThis.StepperManager)!=null&&Rt.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:$,viewport:Tt,transform:wt,background:at}=this.params;this.gfx=new _canvas.CanvasGraphics($,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:ft},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:wt,viewport:Tt,transparency:g,background:at}),this.operatorListIdx=0,this.graphicsReady=!0,(Bt=this.graphicsReadyCallback)==null||Bt.call(this)}cancel(g=null,ft=0){var $;this.running=!1,this.cancelled=!0,($=this.gfx)==null||$.endDrawing(),s(pt,_).delete(this._canvas),this.callback(g||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,ft))}operatorListChanged(){var g;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(g=this.stepper)==null||g.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),s(pt,_).delete(this._canvas),this.callback())))}};_=new WeakMap,Et(pt,_,new WeakSet);let InternalRenderTask=pt;const version="3.11.174";exports.version=version;const build="ce8716743";exports.build=build},(d,e,ot)=>{var rt,X,mt,es,dt;Object.defineProperty(e,"__esModule",{value:!0}),e.SerializableEmpty=e.PrintAnnotationStorage=e.AnnotationStorage=void 0;var i=ot(1),b=ot(4),St=ot(8);const bt=Object.freeze({map:null,hash:"",transfers:void 0});e.SerializableEmpty=bt;class Wt{constructor(){Et(this,mt);Et(this,rt,!1);Et(this,X,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(nt,j){const tt=s(this,X).get(nt);return tt===void 0?j:Object.assign(j,tt)}getRawValue(nt){return s(this,X).get(nt)}remove(nt){if(s(this,X).delete(nt),s(this,X).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const j of s(this,X).values())if(j instanceof b.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(nt,j){const tt=s(this,X).get(nt);let ct=!1;if(tt!==void 0)for(const[lt,et]of Object.entries(j))tt[lt]!==et&&(ct=!0,tt[lt]=et);else ct=!0,s(this,X).set(nt,j);ct&&xt(this,mt,es).call(this),j instanceof b.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(j.constructor._type)}has(nt){return s(this,X).has(nt)}getAll(){return s(this,X).size>0?(0,i.objectFromMap)(s(this,X)):null}setAll(nt){for(const[j,tt]of Object.entries(nt))this.setValue(j,tt)}get size(){return s(this,X).size}resetModified(){s(this,rt)&&(Ut(this,rt,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new ht(this)}get serializable(){if(s(this,X).size===0)return bt;const nt=new Map,j=new St.MurmurHash3_64,tt=[],ct=Object.create(null);let lt=!1;for(const[et,f]of s(this,X)){const _=f instanceof b.AnnotationEditor?f.serialize(!1,ct):f;_&&(nt.set(et,_),j.update(`${et}:${JSON.stringify(_)}`),lt||(lt=!!_.bitmap))}if(lt)for(const et of nt.values())et.bitmap&&tt.push(et.bitmap);return nt.size>0?{map:nt,hash:j.hexdigest(),transfers:tt}:bt}}rt=new WeakMap,X=new WeakMap,mt=new WeakSet,es=function(){s(this,rt)||(Ut(this,rt,!0),typeof this.onSetModified=="function"&&this.onSetModified())},e.AnnotationStorage=Wt;class ht extends Wt{constructor(j){super();Et(this,dt,void 0);const{map:tt,hash:ct,transfers:lt}=j.serializable,et=structuredClone(tt,lt?{transfer:lt}:null);Ut(this,dt,{map:et,hash:ct,transfers:lt})}get print(){(0,i.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return s(this,dt)}}dt=new WeakMap,e.PrintAnnotationStorage=ht},(d,e,ot)=>{var ht,rt,X,mt,_t,dt,st,nt,j,tt,ct,lt,et,f,_,vn,Y,En,ft,Sn,Tt,Tn,at,ns,Bt,ss,Pt,is,Jt,Pn,re,rs;Object.defineProperty(e,"__esModule",{value:!0}),e.AnnotationEditor=void 0;var i=ot(5),b=ot(1),St=ot(6);const o=class o{constructor(c){Et(this,_);Et(this,Y);Et(this,Tt);Et(this,at);Et(this,Bt);Et(this,Pt);Et(this,Jt);Et(this,re);Et(this,ht,"");Et(this,rt,!1);Et(this,X,null);Et(this,mt,null);Et(this,_t,null);Et(this,dt,!1);Et(this,st,null);Et(this,nt,this.focusin.bind(this));Et(this,j,this.focusout.bind(this));Et(this,tt,!1);Et(this,ct,!1);Et(this,lt,!1);Ie(this,"_initialOptions",Object.create(null));Ie(this,"_uiManager",null);Ie(this,"_focusEventsAllowed",!0);Ie(this,"_l10nPromise",null);Et(this,et,!1);Et(this,f,o._zIndex++);this.constructor===o&&(0,b.unreachable)("Cannot initialize AnnotationEditor."),this.parent=c.parent,this.id=c.id,this.width=this.height=null,this.pageIndex=c.parent.pageIndex,this.name=c.name,this.div=null,this._uiManager=c.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=c.isCentered,this._structTreeParentId=null;const{rotation:m,rawDims:{pageWidth:k,pageHeight:it,pageX:gt,pageY:vt}}=this.parent.viewport;this.rotation=m,this.pageRotation=(360+m-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[k,it],this.pageTranslation=[gt,vt];const[Nt,Lt]=this.parentDimensions;this.x=c.x/Nt,this.y=c.y/Lt,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,b.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(c){const m=new Wt({id:c.parent.getNextId(),parent:c.parent,uiManager:c._uiManager});m.annotationElementId=c.annotationElementId,m.deleted=!0,m._uiManager.addToAnnotationStorage(m)}static initialize(c,m=null){if(o._l10nPromise||(o._l10nPromise=new Map(["editor_alt_text_button_label","editor_alt_text_edit_button_label","editor_alt_text_decorative_tooltip"].map(it=>[it,c.get(it)]))),m!=null&&m.strings)for(const it of m.strings)o._l10nPromise.set(it,c.get(it));if(o._borderLineWidth!==-1)return;const k=getComputedStyle(document.documentElement);o._borderLineWidth=parseFloat(k.getPropertyValue("--outline-width"))||0}static updateDefaultParams(c,m){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(c){return!1}static paste(c,m){(0,b.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return s(this,et)}set _isDraggable(c){var m;Ut(this,et,c),(m=this.div)==null||m.classList.toggle("draggable",c)}center(){const[c,m]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*m/(c*2),this.y+=this.width*c/(m*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*m/(c*2),this.y-=this.width*c/(m*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(c){this._uiManager.addCommands(c)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=s(this,f)}setParent(c){c!==null&&(this.pageIndex=c.pageIndex,this.pageDimensions=c.pageDimensions),this.parent=c}focusin(c){this._focusEventsAllowed&&(s(this,tt)?Ut(this,tt,!1):this.parent.setSelected(this))}focusout(c){var k;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const m=c.relatedTarget;m!=null&&m.closest(`#${this.id}`)||(c.preventDefault(),(k=this.parent)!=null&&k.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(c,m,k,it){const[gt,vt]=this.parentDimensions;[k,it]=this.screenToPageTranslation(k,it),this.x=(c+k)/gt,this.y=(m+it)/vt,this.fixAndSetPosition()}translate(c,m){xt(this,_,vn).call(this,this.parentDimensions,c,m)}translateInPage(c,m){xt(this,_,vn).call(this,this.pageDimensions,c,m),this.div.scrollIntoView({block:"nearest"})}drag(c,m){const[k,it]=this.parentDimensions;if(this.x+=c/k,this.y+=m/it,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:jt,y:zt}=this.div.getBoundingClientRect();this.parent.findNewParent(this,jt,zt)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:gt,y:vt}=this;const[Nt,Lt]=xt(this,Y,En).call(this);gt+=Nt,vt+=Lt,this.div.style.left=`${(100*gt).toFixed(2)}%`,this.div.style.top=`${(100*vt).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}fixAndSetPosition(){const[c,m]=this.pageDimensions;let{x:k,y:it,width:gt,height:vt}=this;switch(gt*=c,vt*=m,k*=c,it*=m,this.rotation){case 0:k=Math.max(0,Math.min(c-gt,k)),it=Math.max(0,Math.min(m-vt,it));break;case 90:k=Math.max(0,Math.min(c-vt,k)),it=Math.min(m,Math.max(gt,it));break;case 180:k=Math.min(c,Math.max(gt,k)),it=Math.min(m,Math.max(vt,it));break;case 270:k=Math.min(c,Math.max(vt,k)),it=Math.max(0,Math.min(m-gt,it));break}this.x=k/=c,this.y=it/=m;const[Nt,Lt]=xt(this,Y,En).call(this);k+=Nt,it+=Lt;const{style:jt}=this.div;jt.left=`${(100*k).toFixed(2)}%`,jt.top=`${(100*it).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(c,m){var k;return xt(k=o,ft,Sn).call(k,c,m,this.parentRotation)}pageTranslationToScreen(c,m){var k;return xt(k=o,ft,Sn).call(k,c,m,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:c,pageDimensions:[m,k]}=this,it=m*c,gt=k*c;return b.FeatureTest.isCSSRoundSupported?[Math.round(it),Math.round(gt)]:[it,gt]}setDims(c,m){var gt;const[k,it]=this.parentDimensions;this.div.style.width=`${(100*c/k).toFixed(2)}%`,s(this,dt)||(this.div.style.height=`${(100*m/it).toFixed(2)}%`),(gt=s(this,X))==null||gt.classList.toggle("small",c<o.SMALL_EDITOR_SIZE||m<o.SMALL_EDITOR_SIZE)}fixDims(){const{style:c}=this.div,{height:m,width:k}=c,it=k.endsWith("%"),gt=!s(this,dt)&&m.endsWith("%");if(it&&gt)return;const[vt,Nt]=this.parentDimensions;it||(c.width=`${(100*parseFloat(k)/vt).toFixed(2)}%`),!s(this,dt)&&!gt&&(c.height=`${(100*parseFloat(m)/Nt).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}async addAltTextButton(){if(s(this,X))return;const c=Ut(this,X,document.createElement("button"));c.className="altText";const m=await o._l10nPromise.get("editor_alt_text_button_label");c.textContent=m,c.setAttribute("aria-label",m),c.tabIndex="0",c.addEventListener("contextmenu",St.noContextMenu),c.addEventListener("pointerdown",k=>k.stopPropagation()),c.addEventListener("click",k=>{k.preventDefault(),this._uiManager.editAltText(this)},{capture:!0}),c.addEventListener("keydown",k=>{k.target===c&&k.key==="Enter"&&(k.preventDefault(),this._uiManager.editAltText(this))}),xt(this,Jt,Pn).call(this),this.div.append(c),o.SMALL_EDITOR_SIZE||(o.SMALL_EDITOR_SIZE=Math.min(128,Math.round(c.getBoundingClientRect().width*1.4)))}getClientDimensions(){return this.div.getBoundingClientRect()}get altTextData(){return{altText:s(this,ht),decorative:s(this,rt)}}set altTextData({altText:c,decorative:m}){s(this,ht)===c&&s(this,rt)===m||(Ut(this,ht,c),Ut(this,rt,m),xt(this,Jt,Pn).call(this))}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",s(this,nt)),this.div.addEventListener("focusout",s(this,j));const[c,m]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*m/c).toFixed(2)}%`,this.div.style.maxHeight=`${(100*c/m).toFixed(2)}%`);const[k,it]=this.getInitialTranslation();return this.translate(k,it),(0,i.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(c){const{isMac:m}=b.FeatureTest.platform;if(c.button!==0||c.ctrlKey&&m){c.preventDefault();return}Ut(this,tt,!0),xt(this,re,rs).call(this,c)}moveInDOM(){var c;(c=this.parent)==null||c.moveEditorInDOM(this)}_setParentAndPosition(c,m,k){c.changeParent(this),this.x=m,this.y=k,this.fixAndSetPosition()}getRect(c,m){const k=this.parentScale,[it,gt]=this.pageDimensions,[vt,Nt]=this.pageTranslation,Lt=c/k,jt=m/k,zt=this.x*it,Yt=this.y*gt,Gt=this.width*it,le=this.height*gt;switch(this.rotation){case 0:return[zt+Lt+vt,gt-Yt-jt-le+Nt,zt+Lt+Gt+vt,gt-Yt-jt+Nt];case 90:return[zt+jt+vt,gt-Yt+Lt+Nt,zt+jt+le+vt,gt-Yt+Lt+Gt+Nt];case 180:return[zt-Lt-Gt+vt,gt-Yt+jt+Nt,zt-Lt+vt,gt-Yt+jt+le+Nt];case 270:return[zt-jt-le+vt,gt-Yt-Lt-Gt+Nt,zt-jt+vt,gt-Yt-Lt+Nt];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(c,m){const[k,it,gt,vt]=c,Nt=gt-k,Lt=vt-it;switch(this.rotation){case 0:return[k,m-vt,Nt,Lt];case 90:return[k,m-it,Lt,Nt];case 180:return[gt,m-it,Nt,Lt];case 270:return[gt,m-vt,Lt,Nt];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){Ut(this,lt,!0)}disableEditMode(){Ut(this,lt,!1)}isInEditMode(){return s(this,lt)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var c,m;(c=this.div)==null||c.addEventListener("focusin",s(this,nt)),(m=this.div)==null||m.addEventListener("focusout",s(this,j))}serialize(c=!1,m=null){(0,b.unreachable)("An editor must be serializable")}static deserialize(c,m,k){const it=new this.prototype.constructor({parent:m,id:m.getNextId(),uiManager:k});it.rotation=c.rotation;const[gt,vt]=it.pageDimensions,[Nt,Lt,jt,zt]=it.getRectInCurrentCoords(c.rect,vt);return it.x=Nt/gt,it.y=Lt/vt,it.width=jt/gt,it.height=zt/vt,it}remove(){var c;this.div.removeEventListener("focusin",s(this,nt)),this.div.removeEventListener("focusout",s(this,j)),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),(c=s(this,X))==null||c.remove(),Ut(this,X,null),Ut(this,mt,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(xt(this,at,ns).call(this),s(this,st).classList.remove("hidden"))}select(){var c;this.makeResizable(),(c=this.div)==null||c.classList.add("selectedEditor")}unselect(){var c,m,k;(c=s(this,st))==null||c.classList.add("hidden"),(m=this.div)==null||m.classList.remove("selectedEditor"),(k=this.div)!=null&&k.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus()}updateParams(c,m){}disableEditing(){s(this,X)&&(s(this,X).hidden=!0)}enableEditing(){s(this,X)&&(s(this,X).hidden=!1)}enterInEditMode(){}get contentDiv(){return this.div}get isEditing(){return s(this,ct)}set isEditing(c){Ut(this,ct,c),this.parent&&(c?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(c,m){Ut(this,dt,!0);const k=c/m,{style:it}=this.div;it.aspectRatio=k,it.height="auto"}static get MIN_SIZE(){return 16}};ht=new WeakMap,rt=new WeakMap,X=new WeakMap,mt=new WeakMap,_t=new WeakMap,dt=new WeakMap,st=new WeakMap,nt=new WeakMap,j=new WeakMap,tt=new WeakMap,ct=new WeakMap,lt=new WeakMap,et=new WeakMap,f=new WeakMap,_=new WeakSet,vn=function([c,m],k,it){[k,it]=this.screenToPageTranslation(k,it),this.x+=k/c,this.y+=it/m,this.fixAndSetPosition()},Y=new WeakSet,En=function(){const[c,m]=this.parentDimensions,{_borderLineWidth:k}=o,it=k/c,gt=k/m;switch(this.rotation){case 90:return[-it,gt];case 180:return[it,gt];case 270:return[it,-gt];default:return[-it,-gt]}},ft=new WeakSet,Sn=function(c,m,k){switch(k){case 90:return[m,-c];case 180:return[-c,-m];case 270:return[-m,c];default:return[c,m]}},Tt=new WeakSet,Tn=function(c){switch(c){case 90:{const[m,k]=this.pageDimensions;return[0,-m/k,k/m,0]}case 180:return[-1,0,0,-1];case 270:{const[m,k]=this.pageDimensions;return[0,m/k,-k/m,0]}default:return[1,0,0,1]}},at=new WeakSet,ns=function(){if(s(this,st))return;Ut(this,st,document.createElement("div")),s(this,st).classList.add("resizers");const c=["topLeft","topRight","bottomRight","bottomLeft"];this._willKeepAspectRatio||c.push("topMiddle","middleRight","bottomMiddle","middleLeft");for(const m of c){const k=document.createElement("div");s(this,st).append(k),k.classList.add("resizer",m),k.addEventListener("pointerdown",xt(this,Bt,ss).bind(this,m)),k.addEventListener("contextmenu",St.noContextMenu)}this.div.prepend(s(this,st))},Bt=new WeakSet,ss=function(c,m){m.preventDefault();const{isMac:k}=b.FeatureTest.platform;if(m.button!==0||m.ctrlKey&&k)return;const it=xt(this,Pt,is).bind(this,c),gt=this._isDraggable;this._isDraggable=!1;const vt={passive:!0,capture:!0};window.addEventListener("pointermove",it,vt);const Nt=this.x,Lt=this.y,jt=this.width,zt=this.height,Yt=this.parent.div.style.cursor,Gt=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(m.target).cursor;const le=()=>{this._isDraggable=gt,window.removeEventListener("pointerup",le),window.removeEventListener("blur",le),window.removeEventListener("pointermove",it,vt),this.parent.div.style.cursor=Yt,this.div.style.cursor=Gt;const ge=this.x,ne=this.y,pe=this.width,Kt=this.height;ge===Nt&&ne===Lt&&pe===jt&&Kt===zt||this.addCommands({cmd:()=>{this.width=pe,this.height=Kt,this.x=ge,this.y=ne;const[Ot,It]=this.parentDimensions;this.setDims(Ot*pe,It*Kt),this.fixAndSetPosition()},undo:()=>{this.width=jt,this.height=zt,this.x=Nt,this.y=Lt;const[Ot,It]=this.parentDimensions;this.setDims(Ot*jt,It*zt),this.fixAndSetPosition()},mustExec:!0})};window.addEventListener("pointerup",le),window.addEventListener("blur",le)},Pt=new WeakSet,is=function(c,m){const[k,it]=this.parentDimensions,gt=this.x,vt=this.y,Nt=this.width,Lt=this.height,jt=o.MIN_SIZE/k,zt=o.MIN_SIZE/it,Yt=Zt=>Math.round(Zt*1e4)/1e4,Gt=xt(this,Tt,Tn).call(this,this.rotation),le=(Zt,ee)=>[Gt[0]*Zt+Gt[2]*ee,Gt[1]*Zt+Gt[3]*ee],ge=xt(this,Tt,Tn).call(this,360-this.rotation),ne=(Zt,ee)=>[ge[0]*Zt+ge[2]*ee,ge[1]*Zt+ge[3]*ee];let pe,Kt,Ot=!1,It=!1;switch(c){case"topLeft":Ot=!0,pe=(Zt,ee)=>[0,0],Kt=(Zt,ee)=>[Zt,ee];break;case"topMiddle":pe=(Zt,ee)=>[Zt/2,0],Kt=(Zt,ee)=>[Zt/2,ee];break;case"topRight":Ot=!0,pe=(Zt,ee)=>[Zt,0],Kt=(Zt,ee)=>[0,ee];break;case"middleRight":It=!0,pe=(Zt,ee)=>[Zt,ee/2],Kt=(Zt,ee)=>[0,ee/2];break;case"bottomRight":Ot=!0,pe=(Zt,ee)=>[Zt,ee],Kt=(Zt,ee)=>[0,0];break;case"bottomMiddle":pe=(Zt,ee)=>[Zt/2,ee],Kt=(Zt,ee)=>[Zt/2,0];break;case"bottomLeft":Ot=!0,pe=(Zt,ee)=>[0,ee],Kt=(Zt,ee)=>[Zt,0];break;case"middleLeft":It=!0,pe=(Zt,ee)=>[0,ee/2],Kt=(Zt,ee)=>[Zt,ee/2];break}const Xt=pe(Nt,Lt),ae=Kt(Nt,Lt);let oe=le(...ae);const Ae=Yt(gt+oe[0]),Pe=Yt(vt+oe[1]);let ve=1,we=1,[Te,Ee]=this.screenToPageTranslation(m.movementX,m.movementY);if([Te,Ee]=ne(Te/k,Ee/it),Ot){const Zt=Math.hypot(Nt,Lt);ve=we=Math.max(Math.min(Math.hypot(ae[0]-Xt[0]-Te,ae[1]-Xt[1]-Ee)/Zt,1/Nt,1/Lt),jt/Nt,zt/Lt)}else It?ve=Math.max(jt,Math.min(1,Math.abs(ae[0]-Xt[0]-Te)))/Nt:we=Math.max(zt,Math.min(1,Math.abs(ae[1]-Xt[1]-Ee)))/Lt;const Ce=Yt(Nt*ve),qt=Yt(Lt*we);oe=le(...Kt(Ce,qt));const Dt=Ae-oe[0],kt=Pe-oe[1];this.width=Ce,this.height=qt,this.x=Dt,this.y=kt,this.setDims(k*Ce,it*qt),this.fixAndSetPosition()},Jt=new WeakSet,Pn=async function(){var k;const c=s(this,X);if(!c)return;if(!s(this,ht)&&!s(this,rt)){c.classList.remove("done"),(k=s(this,mt))==null||k.remove();return}o._l10nPromise.get("editor_alt_text_edit_button_label").then(it=>{c.setAttribute("aria-label",it)});let m=s(this,mt);if(!m){Ut(this,mt,m=document.createElement("span")),m.className="tooltip",m.setAttribute("role","tooltip");const it=m.id=`alt-text-tooltip-${this.id}`;c.setAttribute("aria-describedby",it);const gt=100;c.addEventListener("mouseenter",()=>{Ut(this,_t,setTimeout(()=>{Ut(this,_t,null),s(this,mt).classList.add("show"),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"alt_text_tooltip"}}})},gt))}),c.addEventListener("mouseleave",()=>{var vt;clearTimeout(s(this,_t)),Ut(this,_t,null),(vt=s(this,mt))==null||vt.classList.remove("show")})}c.classList.add("done"),m.innerText=s(this,rt)?await o._l10nPromise.get("editor_alt_text_decorative_tooltip"):s(this,ht),m.parentNode||c.append(m)},re=new WeakSet,rs=function(c){if(!this._isDraggable)return;const m=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let k,it;m&&(k={passive:!0,capture:!0},it=vt=>{const[Nt,Lt]=this.screenToPageTranslation(vt.movementX,vt.movementY);this._uiManager.dragSelectedEditors(Nt,Lt)},window.addEventListener("pointermove",it,k));const gt=()=>{if(window.removeEventListener("pointerup",gt),window.removeEventListener("blur",gt),m&&window.removeEventListener("pointermove",it,k),Ut(this,tt,!1),!this._uiManager.endDragSession()){const{isMac:vt}=b.FeatureTest.platform;c.ctrlKey&&!vt||c.shiftKey||c.metaKey&&vt?this.parent.toggleSelected(this):this.parent.setSelected(this)}};window.addEventListener("pointerup",gt),window.addEventListener("blur",gt)},Et(o,ft),Ie(o,"_borderLineWidth",-1),Ie(o,"_colorManager",new i.ColorManager),Ie(o,"_zIndex",1),Ie(o,"SMALL_EDITOR_SIZE",0);let bt=o;e.AnnotationEditor=bt;class Wt extends bt{constructor(c){super(c),this.annotationElementId=c.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},(d,e,ot)=>{var dt,st,nt,j,tt,wn,et,f,_,pt,Y,as,$,Tt,wt,at,Rt,Bt,$t,Pt,Vt,Jt,se,re,ut,o,h,c,m,k,it,gt,vt,Nt,Lt,jt,zt,Yt,Gt,le,ge,ne,pe,Kt,Ot,It,Xt,os,oe,Cn,Pe,xn,we,on,Ee,Rn,qt,kn,kt,je,ee,Je,Le,ls,ie,cs,ce,Fn,ye,Qe,te,Mn;Object.defineProperty(e,"__esModule",{value:!0}),e.KeyboardManager=e.CommandManager=e.ColorManager=e.AnnotationEditorUIManager=void 0,e.bindEvents=St,e.opacityToHex=bt;var i=ot(1),b=ot(6);function St(yt,a,Z){for(const At of Z)a.addEventListener(At,yt[At].bind(yt))}function bt(yt){return Math.round(Math.min(255,Math.max(1,255*yt))).toString(16).padStart(2,"0")}class Wt{constructor(){Et(this,dt,0)}getId(){return`${i.AnnotationEditorPrefix}${Ke(this,dt)._++}`}}dt=new WeakMap;const lt=class lt{constructor(){Et(this,tt);Et(this,st,(0,i.getUuid)());Et(this,nt,0);Et(this,j,null)}static get _isSVGFittingCanvas(){const a='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',At=new OffscreenCanvas(1,3).getContext("2d"),Ct=new Image;Ct.src=a;const Ft=Ct.decode().then(()=>(At.drawImage(Ct,0,0,1,1,0,0,1,3),new Uint32Array(At.getImageData(0,0,1,1).data.buffer)[0]===0));return(0,i.shadow)(this,"_isSVGFittingCanvas",Ft)}async getFromFile(a){const{lastModified:Z,name:At,size:Ct,type:Ft}=a;return xt(this,tt,wn).call(this,`${Z}_${At}_${Ct}_${Ft}`,a)}async getFromUrl(a){return xt(this,tt,wn).call(this,a,a)}async getFromId(a){s(this,j)||Ut(this,j,new Map);const Z=s(this,j).get(a);return Z?Z.bitmap?(Z.refCounter+=1,Z):Z.file?this.getFromFile(Z.file):this.getFromUrl(Z.url):null}getSvgUrl(a){const Z=s(this,j).get(a);return Z!=null&&Z.isSvg?Z.svgUrl:null}deleteId(a){s(this,j)||Ut(this,j,new Map);const Z=s(this,j).get(a);Z&&(Z.refCounter-=1,Z.refCounter===0&&(Z.bitmap=null))}isValidId(a){return a.startsWith(`image_${s(this,st)}_`)}};st=new WeakMap,nt=new WeakMap,j=new WeakMap,tt=new WeakSet,wn=async function(a,Z){s(this,j)||Ut(this,j,new Map);let At=s(this,j).get(a);if(At===null)return null;if(At!=null&&At.bitmap)return At.refCounter+=1,At;try{At||(At={bitmap:null,id:`image_${s(this,st)}_${Ke(this,nt)._++}`,refCounter:0,isSvg:!1});let Ct;if(typeof Z=="string"){At.url=Z;const Ft=await fetch(Z);if(!Ft.ok)throw new Error(Ft.statusText);Ct=await Ft.blob()}else Ct=At.file=Z;if(Ct.type==="image/svg+xml"){const Ft=lt._isSVGFittingCanvas,Ht=new FileReader,Qt=new Image,ue=new Promise((he,xe)=>{Qt.onload=()=>{At.bitmap=Qt,At.isSvg=!0,he()},Ht.onload=async()=>{const de=At.svgUrl=Ht.result;Qt.src=await Ft?`${de}#svgView(preserveAspectRatio(none))`:de},Qt.onerror=Ht.onerror=xe});Ht.readAsDataURL(Ct),await ue}else At.bitmap=await createImageBitmap(Ct);At.refCounter=1}catch(Ct){console.error(Ct),At=null}return s(this,j).set(a,At),At&&s(this,j).set(At.id,At),At};let ht=lt;class rt{constructor(a=128){Et(this,et,[]);Et(this,f,!1);Et(this,_,void 0);Et(this,pt,-1);Ut(this,_,a)}add({cmd:a,undo:Z,mustExec:At,type:Ct=NaN,overwriteIfSameType:Ft=!1,keepUndo:Ht=!1}){if(At&&a(),s(this,f))return;const Qt={cmd:a,undo:Z,type:Ct};if(s(this,pt)===-1){s(this,et).length>0&&(s(this,et).length=0),Ut(this,pt,0),s(this,et).push(Qt);return}if(Ft&&s(this,et)[s(this,pt)].type===Ct){Ht&&(Qt.undo=s(this,et)[s(this,pt)].undo),s(this,et)[s(this,pt)]=Qt;return}const ue=s(this,pt)+1;ue===s(this,_)?s(this,et).splice(0,1):(Ut(this,pt,ue),ue<s(this,et).length&&s(this,et).splice(ue)),s(this,et).push(Qt)}undo(){s(this,pt)!==-1&&(Ut(this,f,!0),s(this,et)[s(this,pt)].undo(),Ut(this,f,!1),Ut(this,pt,s(this,pt)-1))}redo(){s(this,pt)<s(this,et).length-1&&(Ut(this,pt,s(this,pt)+1),Ut(this,f,!0),s(this,et)[s(this,pt)].cmd(),Ut(this,f,!1))}hasSomethingToUndo(){return s(this,pt)!==-1}hasSomethingToRedo(){return s(this,pt)<s(this,et).length-1}destroy(){Ut(this,et,null)}}et=new WeakMap,f=new WeakMap,_=new WeakMap,pt=new WeakMap,e.CommandManager=rt;class X{constructor(a){Et(this,Y);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:Z}=i.FeatureTest.platform;for(const[At,Ct,Ft={}]of a)for(const Ht of At){const Qt=Ht.startsWith("mac+");Z&&Qt?(this.callbacks.set(Ht.slice(4),{callback:Ct,options:Ft}),this.allKeys.add(Ht.split("+").at(-1))):!Z&&!Qt&&(this.callbacks.set(Ht,{callback:Ct,options:Ft}),this.allKeys.add(Ht.split("+").at(-1)))}}exec(a,Z){if(!this.allKeys.has(Z.key))return;const At=this.callbacks.get(xt(this,Y,as).call(this,Z));if(!At)return;const{callback:Ct,options:{bubbles:Ft=!1,args:Ht=[],checker:Qt=null}}=At;Qt&&!Qt(a,Z)||(Ct.bind(a,...Ht)(),Ft||(Z.stopPropagation(),Z.preventDefault()))}}Y=new WeakSet,as=function(a){a.altKey&&this.buffer.push("alt"),a.ctrlKey&&this.buffer.push("ctrl"),a.metaKey&&this.buffer.push("meta"),a.shiftKey&&this.buffer.push("shift"),this.buffer.push(a.key);const Z=this.buffer.join("+");return this.buffer.length=0,Z},e.KeyboardManager=X;const ft=class ft{get _colors(){const a=new Map([["CanvasText",null],["Canvas",null]]);return(0,b.getColorValues)(a),(0,i.shadow)(this,"_colors",a)}convert(a){const Z=(0,b.getRGB)(a);if(!window.matchMedia("(forced-colors: active)").matches)return Z;for(const[At,Ct]of this._colors)if(Ct.every((Ft,Ht)=>Ft===Z[Ht]))return ft._colorsMapping.get(At);return Z}getHexCode(a){const Z=this._colors.get(a);return Z?i.Util.makeHexColor(...Z):a}};Ie(ft,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let mt=ft;e.ColorManager=mt;const me=class me{constructor(a,Z,At,Ct,Ft,Ht){Et(this,Xt);Et(this,oe);Et(this,Pe);Et(this,we);Et(this,Ee);Et(this,qt);Et(this,kt);Et(this,ee);Et(this,Le);Et(this,ie);Et(this,ce);Et(this,ye);Et(this,te);Et(this,$,null);Et(this,Tt,new Map);Et(this,wt,new Map);Et(this,at,null);Et(this,Rt,null);Et(this,Bt,new rt);Et(this,$t,0);Et(this,Pt,new Set);Et(this,Vt,null);Et(this,Jt,null);Et(this,se,new Set);Et(this,re,null);Et(this,ut,new Wt);Et(this,o,!1);Et(this,h,!1);Et(this,c,null);Et(this,m,i.AnnotationEditorType.NONE);Et(this,k,new Set);Et(this,it,null);Et(this,gt,this.blur.bind(this));Et(this,vt,this.focus.bind(this));Et(this,Nt,this.copy.bind(this));Et(this,Lt,this.cut.bind(this));Et(this,jt,this.paste.bind(this));Et(this,zt,this.keydown.bind(this));Et(this,Yt,this.onEditingAction.bind(this));Et(this,Gt,this.onPageChanging.bind(this));Et(this,le,this.onScaleChanging.bind(this));Et(this,ge,this.onRotationChanging.bind(this));Et(this,ne,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});Et(this,pe,[0,0]);Et(this,Kt,null);Et(this,Ot,null);Et(this,It,null);Ut(this,Ot,a),Ut(this,It,Z),Ut(this,at,At),this._eventBus=Ct,this._eventBus._on("editingaction",s(this,Yt)),this._eventBus._on("pagechanging",s(this,Gt)),this._eventBus._on("scalechanging",s(this,le)),this._eventBus._on("rotationchanging",s(this,ge)),Ut(this,Rt,Ft.annotationStorage),Ut(this,re,Ft.filterFactory),Ut(this,it,Ht),this.viewParameters={realScale:b.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}static get _keyboardManager(){const a=me.prototype,Z=Ft=>{const{activeElement:Ht}=document;return Ht&&s(Ft,Ot).contains(Ht)&&Ft.hasSomethingToControl()},At=this.TRANSLATE_SMALL,Ct=this.TRANSLATE_BIG;return(0,i.shadow)(this,"_keyboardManager",new X([[["ctrl+a","mac+meta+a"],a.selectAll],[["ctrl+z","mac+meta+z"],a.undo],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],a.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],a.delete],[["Escape","mac+Escape"],a.unselectAll],[["ArrowLeft","mac+ArrowLeft"],a.translateSelectedEditors,{args:[-At,0],checker:Z}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],a.translateSelectedEditors,{args:[-Ct,0],checker:Z}],[["ArrowRight","mac+ArrowRight"],a.translateSelectedEditors,{args:[At,0],checker:Z}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],a.translateSelectedEditors,{args:[Ct,0],checker:Z}],[["ArrowUp","mac+ArrowUp"],a.translateSelectedEditors,{args:[0,-At],checker:Z}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],a.translateSelectedEditors,{args:[0,-Ct],checker:Z}],[["ArrowDown","mac+ArrowDown"],a.translateSelectedEditors,{args:[0,At],checker:Z}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],a.translateSelectedEditors,{args:[0,Ct],checker:Z}]]))}destroy(){xt(this,we,on).call(this),xt(this,oe,Cn).call(this),this._eventBus._off("editingaction",s(this,Yt)),this._eventBus._off("pagechanging",s(this,Gt)),this._eventBus._off("scalechanging",s(this,le)),this._eventBus._off("rotationchanging",s(this,ge));for(const a of s(this,wt).values())a.destroy();s(this,wt).clear(),s(this,Tt).clear(),s(this,se).clear(),Ut(this,$,null),s(this,k).clear(),s(this,Bt).destroy(),s(this,at).destroy()}get hcmFilter(){return(0,i.shadow)(this,"hcmFilter",s(this,it)?s(this,re).addHCMFilter(s(this,it).foreground,s(this,it).background):"none")}get direction(){return(0,i.shadow)(this,"direction",getComputedStyle(s(this,Ot)).direction)}editAltText(a){var Z;(Z=s(this,at))==null||Z.editAltText(this,a)}onPageChanging({pageNumber:a}){Ut(this,$t,a-1)}focusMainContainer(){s(this,Ot).focus()}findParent(a,Z){for(const At of s(this,wt).values()){const{x:Ct,y:Ft,width:Ht,height:Qt}=At.div.getBoundingClientRect();if(a>=Ct&&a<=Ct+Ht&&Z>=Ft&&Z<=Ft+Qt)return At}return null}disableUserSelect(a=!1){s(this,It).classList.toggle("noUserSelect",a)}addShouldRescale(a){s(this,se).add(a)}removeShouldRescale(a){s(this,se).delete(a)}onScaleChanging({scale:a}){this.commitOrRemove(),this.viewParameters.realScale=a*b.PixelsPerInch.PDF_TO_CSS_UNITS;for(const Z of s(this,se))Z.onScaleChanging()}onRotationChanging({pagesRotation:a}){this.commitOrRemove(),this.viewParameters.rotation=a}addToAnnotationStorage(a){!a.isEmpty()&&s(this,Rt)&&!s(this,Rt).has(a.id)&&s(this,Rt).setValue(a.id,a)}blur(){if(!this.hasSelection)return;const{activeElement:a}=document;for(const Z of s(this,k))if(Z.div.contains(a)){Ut(this,c,[Z,a]),Z._focusEventsAllowed=!1;break}}focus(){if(!s(this,c))return;const[a,Z]=s(this,c);Ut(this,c,null),Z.addEventListener("focusin",()=>{a._focusEventsAllowed=!0},{once:!0}),Z.focus()}addEditListeners(){xt(this,Pe,xn).call(this),xt(this,Ee,Rn).call(this)}removeEditListeners(){xt(this,we,on).call(this),xt(this,qt,kn).call(this)}copy(a){var At;if(a.preventDefault(),(At=s(this,$))==null||At.commitOrRemove(),!this.hasSelection)return;const Z=[];for(const Ct of s(this,k)){const Ft=Ct.serialize(!0);Ft&&Z.push(Ft)}Z.length!==0&&a.clipboardData.setData("application/pdfjs",JSON.stringify(Z))}cut(a){this.copy(a),this.delete()}paste(a){a.preventDefault();const{clipboardData:Z}=a;for(const Ft of Z.items)for(const Ht of s(this,Jt))if(Ht.isHandlingMimeForPasting(Ft.type)){Ht.paste(Ft,this.currentLayer);return}let At=Z.getData("application/pdfjs");if(!At)return;try{At=JSON.parse(At)}catch(Ft){(0,i.warn)(`paste: "${Ft.message}".`);return}if(!Array.isArray(At))return;this.unselectAll();const Ct=this.currentLayer;try{const Ft=[];for(const ue of At){const he=Ct.deserialize(ue);if(!he)return;Ft.push(he)}const Ht=()=>{for(const ue of Ft)xt(this,ce,Fn).call(this,ue);xt(this,te,Mn).call(this,Ft)},Qt=()=>{for(const ue of Ft)ue.remove()};this.addCommands({cmd:Ht,undo:Qt,mustExec:!0})}catch(Ft){(0,i.warn)(`paste: "${Ft.message}".`)}}keydown(a){var Z;(Z=this.getActive())!=null&&Z.shouldGetKeyboardEvents()||me._keyboardManager.exec(this,a)}onEditingAction(a){["undo","redo","delete","selectAll"].includes(a.name)&&this[a.name]()}setEditingState(a){a?(xt(this,Xt,os).call(this),xt(this,Pe,xn).call(this),xt(this,Ee,Rn).call(this),xt(this,kt,je).call(this,{isEditing:s(this,m)!==i.AnnotationEditorType.NONE,isEmpty:xt(this,ye,Qe).call(this),hasSomethingToUndo:s(this,Bt).hasSomethingToUndo(),hasSomethingToRedo:s(this,Bt).hasSomethingToRedo(),hasSelectedEditor:!1})):(xt(this,oe,Cn).call(this),xt(this,we,on).call(this),xt(this,qt,kn).call(this),xt(this,kt,je).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(a){if(!s(this,Jt)){Ut(this,Jt,a);for(const Z of s(this,Jt))xt(this,ee,Je).call(this,Z.defaultPropertiesToUpdate)}}getId(){return s(this,ut).getId()}get currentLayer(){return s(this,wt).get(s(this,$t))}getLayer(a){return s(this,wt).get(a)}get currentPageIndex(){return s(this,$t)}addLayer(a){s(this,wt).set(a.pageIndex,a),s(this,o)?a.enable():a.disable()}removeLayer(a){s(this,wt).delete(a.pageIndex)}updateMode(a,Z=null){if(s(this,m)!==a){if(Ut(this,m,a),a===i.AnnotationEditorType.NONE){this.setEditingState(!1),xt(this,ie,cs).call(this);return}this.setEditingState(!0),xt(this,Le,ls).call(this),this.unselectAll();for(const At of s(this,wt).values())At.updateMode(a);if(Z){for(const At of s(this,Tt).values())if(At.annotationElementId===Z){this.setSelected(At),At.enterInEditMode();break}}}}updateToolbar(a){a!==s(this,m)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:a})}updateParams(a,Z){if(s(this,Jt)){if(a===i.AnnotationEditorParamsType.CREATE){this.currentLayer.addNewEditor(a);return}for(const At of s(this,k))At.updateParams(a,Z);for(const At of s(this,Jt))At.updateDefaultParams(a,Z)}}enableWaiting(a=!1){if(s(this,h)!==a){Ut(this,h,a);for(const Z of s(this,wt).values())a?Z.disableClick():Z.enableClick(),Z.div.classList.toggle("waiting",a)}}getEditors(a){const Z=[];for(const At of s(this,Tt).values())At.pageIndex===a&&Z.push(At);return Z}getEditor(a){return s(this,Tt).get(a)}addEditor(a){s(this,Tt).set(a.id,a)}removeEditor(a){var Z;s(this,Tt).delete(a.id),this.unselect(a),(!a.annotationElementId||!s(this,Pt).has(a.annotationElementId))&&((Z=s(this,Rt))==null||Z.remove(a.id))}addDeletedAnnotationElement(a){s(this,Pt).add(a.annotationElementId),a.deleted=!0}isDeletedAnnotationElement(a){return s(this,Pt).has(a)}removeDeletedAnnotationElement(a){s(this,Pt).delete(a.annotationElementId),a.deleted=!1}setActiveEditor(a){s(this,$)!==a&&(Ut(this,$,a),a&&xt(this,ee,Je).call(this,a.propertiesToUpdate))}toggleSelected(a){if(s(this,k).has(a)){s(this,k).delete(a),a.unselect(),xt(this,kt,je).call(this,{hasSelectedEditor:this.hasSelection});return}s(this,k).add(a),a.select(),xt(this,ee,Je).call(this,a.propertiesToUpdate),xt(this,kt,je).call(this,{hasSelectedEditor:!0})}setSelected(a){for(const Z of s(this,k))Z!==a&&Z.unselect();s(this,k).clear(),s(this,k).add(a),a.select(),xt(this,ee,Je).call(this,a.propertiesToUpdate),xt(this,kt,je).call(this,{hasSelectedEditor:!0})}isSelected(a){return s(this,k).has(a)}unselect(a){a.unselect(),s(this,k).delete(a),xt(this,kt,je).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return s(this,k).size!==0}undo(){s(this,Bt).undo(),xt(this,kt,je).call(this,{hasSomethingToUndo:s(this,Bt).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:xt(this,ye,Qe).call(this)})}redo(){s(this,Bt).redo(),xt(this,kt,je).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:s(this,Bt).hasSomethingToRedo(),isEmpty:xt(this,ye,Qe).call(this)})}addCommands(a){s(this,Bt).add(a),xt(this,kt,je).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:xt(this,ye,Qe).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const a=[...s(this,k)],Z=()=>{for(const Ct of a)Ct.remove()},At=()=>{for(const Ct of a)xt(this,ce,Fn).call(this,Ct)};this.addCommands({cmd:Z,undo:At,mustExec:!0})}commitOrRemove(){var a;(a=s(this,$))==null||a.commitOrRemove()}hasSomethingToControl(){return s(this,$)||this.hasSelection}selectAll(){for(const a of s(this,k))a.commit();xt(this,te,Mn).call(this,s(this,Tt).values())}unselectAll(){if(s(this,$)){s(this,$).commitOrRemove();return}if(this.hasSelection){for(const a of s(this,k))a.unselect();s(this,k).clear(),xt(this,kt,je).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(a,Z,At=!1){if(At||this.commitOrRemove(),!this.hasSelection)return;s(this,pe)[0]+=a,s(this,pe)[1]+=Z;const[Ct,Ft]=s(this,pe),Ht=[...s(this,k)],Qt=1e3;s(this,Kt)&&clearTimeout(s(this,Kt)),Ut(this,Kt,setTimeout(()=>{Ut(this,Kt,null),s(this,pe)[0]=s(this,pe)[1]=0,this.addCommands({cmd:()=>{for(const ue of Ht)s(this,Tt).has(ue.id)&&ue.translateInPage(Ct,Ft)},undo:()=>{for(const ue of Ht)s(this,Tt).has(ue.id)&&ue.translateInPage(-Ct,-Ft)},mustExec:!1})},Qt));for(const ue of Ht)ue.translateInPage(a,Z)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),Ut(this,Vt,new Map);for(const a of s(this,k))s(this,Vt).set(a,{savedX:a.x,savedY:a.y,savedPageIndex:a.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!s(this,Vt))return!1;this.disableUserSelect(!1);const a=s(this,Vt);Ut(this,Vt,null);let Z=!1;for(const[{x:Ct,y:Ft,pageIndex:Ht},Qt]of a)Qt.newX=Ct,Qt.newY=Ft,Qt.newPageIndex=Ht,Z||(Z=Ct!==Qt.savedX||Ft!==Qt.savedY||Ht!==Qt.savedPageIndex);if(!Z)return!1;const At=(Ct,Ft,Ht,Qt)=>{if(s(this,Tt).has(Ct.id)){const ue=s(this,wt).get(Qt);ue?Ct._setParentAndPosition(ue,Ft,Ht):(Ct.pageIndex=Qt,Ct.x=Ft,Ct.y=Ht)}};return this.addCommands({cmd:()=>{for(const[Ct,{newX:Ft,newY:Ht,newPageIndex:Qt}]of a)At(Ct,Ft,Ht,Qt)},undo:()=>{for(const[Ct,{savedX:Ft,savedY:Ht,savedPageIndex:Qt}]of a)At(Ct,Ft,Ht,Qt)},mustExec:!0}),!0}dragSelectedEditors(a,Z){if(s(this,Vt))for(const At of s(this,Vt).keys())At.drag(a,Z)}rebuild(a){if(a.parent===null){const Z=this.getLayer(a.pageIndex);Z?(Z.changeParent(a),Z.addOrRebuild(a)):(this.addEditor(a),this.addToAnnotationStorage(a),a.rebuild())}else a.parent.addOrRebuild(a)}isActive(a){return s(this,$)===a}getActive(){return s(this,$)}getMode(){return s(this,m)}get imageManager(){return(0,i.shadow)(this,"imageManager",new ht)}};$=new WeakMap,Tt=new WeakMap,wt=new WeakMap,at=new WeakMap,Rt=new WeakMap,Bt=new WeakMap,$t=new WeakMap,Pt=new WeakMap,Vt=new WeakMap,Jt=new WeakMap,se=new WeakMap,re=new WeakMap,ut=new WeakMap,o=new WeakMap,h=new WeakMap,c=new WeakMap,m=new WeakMap,k=new WeakMap,it=new WeakMap,gt=new WeakMap,vt=new WeakMap,Nt=new WeakMap,Lt=new WeakMap,jt=new WeakMap,zt=new WeakMap,Yt=new WeakMap,Gt=new WeakMap,le=new WeakMap,ge=new WeakMap,ne=new WeakMap,pe=new WeakMap,Kt=new WeakMap,Ot=new WeakMap,It=new WeakMap,Xt=new WeakSet,os=function(){window.addEventListener("focus",s(this,vt)),window.addEventListener("blur",s(this,gt))},oe=new WeakSet,Cn=function(){window.removeEventListener("focus",s(this,vt)),window.removeEventListener("blur",s(this,gt))},Pe=new WeakSet,xn=function(){window.addEventListener("keydown",s(this,zt),{capture:!0})},we=new WeakSet,on=function(){window.removeEventListener("keydown",s(this,zt),{capture:!0})},Ee=new WeakSet,Rn=function(){document.addEventListener("copy",s(this,Nt)),document.addEventListener("cut",s(this,Lt)),document.addEventListener("paste",s(this,jt))},qt=new WeakSet,kn=function(){document.removeEventListener("copy",s(this,Nt)),document.removeEventListener("cut",s(this,Lt)),document.removeEventListener("paste",s(this,jt))},kt=new WeakSet,je=function(a){Object.entries(a).some(([At,Ct])=>s(this,ne)[At]!==Ct)&&this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(s(this,ne),a)})},ee=new WeakSet,Je=function(a){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:a})},Le=new WeakSet,ls=function(){if(!s(this,o)){Ut(this,o,!0);for(const a of s(this,wt).values())a.enable()}},ie=new WeakSet,cs=function(){if(this.unselectAll(),s(this,o)){Ut(this,o,!1);for(const a of s(this,wt).values())a.disable()}},ce=new WeakSet,Fn=function(a){const Z=s(this,wt).get(a.pageIndex);Z?Z.addOrRebuild(a):this.addEditor(a)},ye=new WeakSet,Qe=function(){if(s(this,Tt).size===0)return!0;if(s(this,Tt).size===1)for(const a of s(this,Tt).values())return a.isEmpty();return!1},te=new WeakSet,Mn=function(a){s(this,k).clear();for(const Z of a)Z.isEmpty()||(s(this,k).add(Z),Z.select());xt(this,kt,je).call(this,{hasSelectedEditor:!0})},Ie(me,"TRANSLATE_SMALL",1),Ie(me,"TRANSLATE_BIG",10);let _t=me;e.AnnotationEditorUIManager=_t},(d,e,ot)=>{var $t,Pt,Vt,Jt,se,re,ut,o,h,c,m,k,ze,gt,qe,Nt,Dn,jt,ln,Yt,cn,le,Ze,ne,tn;Object.defineProperty(e,"__esModule",{value:!0}),e.StatTimer=e.RenderingCancelledException=e.PixelsPerInch=e.PageViewport=e.PDFDateString=e.DOMStandardFontDataFactory=e.DOMSVGFactory=e.DOMFilterFactory=e.DOMCanvasFactory=e.DOMCMapReaderFactory=void 0,e.deprecated=pt,e.getColorValues=Tt,e.getCurrentTransform=wt,e.getCurrentTransformInverse=at,e.getFilenameFromUrl=tt,e.getPdfFilenameFromUrl=ct,e.getRGB=$,e.getXfaPageViewport=ft,e.isDataScheme=nt,e.isPdfFile=j,e.isValidFetchUrl=et,e.loadScript=_,e.noContextMenu=f,e.setLayerDimensions=Rt;var i=ot(7),b=ot(1);const St="http://www.w3.org/2000/svg",Bt=class Bt{};Ie(Bt,"CSS",96),Ie(Bt,"PDF",72),Ie(Bt,"PDF_TO_CSS_UNITS",Bt.CSS/Bt.PDF);let bt=Bt;e.PixelsPerInch=bt;class Wt extends i.BaseFilterFactory{constructor({docId:It,ownerDocument:Xt=globalThis.document}={}){super();Et(this,k);Et(this,gt);Et(this,Nt);Et(this,jt);Et(this,Yt);Et(this,le);Et(this,ne);Et(this,$t,void 0);Et(this,Pt,void 0);Et(this,Vt,void 0);Et(this,Jt,void 0);Et(this,se,void 0);Et(this,re,void 0);Et(this,ut,void 0);Et(this,o,void 0);Et(this,h,void 0);Et(this,c,void 0);Et(this,m,0);Ut(this,Vt,It),Ut(this,Jt,Xt)}addFilter(It){if(!It)return"none";let Xt=s(this,k,ze).get(It);if(Xt)return Xt;let ae,oe,Ae,Pe;if(It.length===1){const Ee=It[0],Ce=new Array(256);for(let qt=0;qt<256;qt++)Ce[qt]=Ee[qt]/255;Pe=ae=oe=Ae=Ce.join(",")}else{const[Ee,Ce,qt]=It,Dt=new Array(256),kt=new Array(256),Zt=new Array(256);for(let ee=0;ee<256;ee++)Dt[ee]=Ee[ee]/255,kt[ee]=Ce[ee]/255,Zt[ee]=qt[ee]/255;ae=Dt.join(","),oe=kt.join(","),Ae=Zt.join(","),Pe=`${ae}${oe}${Ae}`}if(Xt=s(this,k,ze).get(Pe),Xt)return s(this,k,ze).set(It,Xt),Xt;const ve=`g_${s(this,Vt)}_transfer_map_${Ke(this,m)._++}`,we=`url(#${ve})`;s(this,k,ze).set(It,we),s(this,k,ze).set(Pe,we);const Te=xt(this,jt,ln).call(this,ve);return xt(this,le,Ze).call(this,ae,oe,Ae,Te),we}addHCMFilter(It,Xt){var Ce;const ae=`${It}-${Xt}`;if(s(this,re)===ae)return s(this,ut);if(Ut(this,re,ae),Ut(this,ut,"none"),(Ce=s(this,se))==null||Ce.remove(),!It||!Xt)return s(this,ut);const oe=xt(this,ne,tn).call(this,It);It=b.Util.makeHexColor(...oe);const Ae=xt(this,ne,tn).call(this,Xt);if(Xt=b.Util.makeHexColor(...Ae),s(this,gt,qe).style.color="",It==="#000000"&&Xt==="#ffffff"||It===Xt)return s(this,ut);const Pe=new Array(256);for(let qt=0;qt<=255;qt++){const Dt=qt/255;Pe[qt]=Dt<=.03928?Dt/12.92:((Dt+.055)/1.055)**2.4}const ve=Pe.join(","),we=`g_${s(this,Vt)}_hcm_filter`,Te=Ut(this,o,xt(this,jt,ln).call(this,we));xt(this,le,Ze).call(this,ve,ve,ve,Te),xt(this,Nt,Dn).call(this,Te);const Ee=(qt,Dt)=>{const kt=oe[qt]/255,Zt=Ae[qt]/255,ee=new Array(Dt+1);for(let Oe=0;Oe<=Dt;Oe++)ee[Oe]=kt+Oe/Dt*(Zt-kt);return ee.join(",")};return xt(this,le,Ze).call(this,Ee(0,5),Ee(1,5),Ee(2,5),Te),Ut(this,ut,`url(#${we})`),s(this,ut)}addHighlightHCMFilter(It,Xt,ae,oe){var Zt;const Ae=`${It}-${Xt}-${ae}-${oe}`;if(s(this,h)===Ae)return s(this,c);if(Ut(this,h,Ae),Ut(this,c,"none"),(Zt=s(this,o))==null||Zt.remove(),!It||!Xt)return s(this,c);const[Pe,ve]=[It,Xt].map(xt(this,ne,tn).bind(this));let we=Math.round(.2126*Pe[0]+.7152*Pe[1]+.0722*Pe[2]),Te=Math.round(.2126*ve[0]+.7152*ve[1]+.0722*ve[2]),[Ee,Ce]=[ae,oe].map(xt(this,ne,tn).bind(this));Te<we&&([we,Te,Ee,Ce]=[Te,we,Ce,Ee]),s(this,gt,qe).style.color="";const qt=(ee,Oe,Le)=>{const Mt=new Array(256),ie=(Te-we)/Le,be=ee/255,ce=(Oe-ee)/(255*Le);let _e=0;for(let ye=0;ye<=Le;ye++){const Me=Math.round(we+ye*ie),te=be+ye*ce;for(let ke=_e;ke<=Me;ke++)Mt[ke]=te;_e=Me+1}for(let ye=_e;ye<256;ye++)Mt[ye]=Mt[_e-1];return Mt.join(",")},Dt=`g_${s(this,Vt)}_hcm_highlight_filter`,kt=Ut(this,o,xt(this,jt,ln).call(this,Dt));return xt(this,Nt,Dn).call(this,kt),xt(this,le,Ze).call(this,qt(Ee[0],Ce[0],5),qt(Ee[1],Ce[1],5),qt(Ee[2],Ce[2],5),kt),Ut(this,c,`url(#${Dt})`),s(this,c)}destroy(It=!1){It&&(s(this,ut)||s(this,c))||(s(this,Pt)&&(s(this,Pt).parentNode.parentNode.remove(),Ut(this,Pt,null)),s(this,$t)&&(s(this,$t).clear(),Ut(this,$t,null)),Ut(this,m,0))}}$t=new WeakMap,Pt=new WeakMap,Vt=new WeakMap,Jt=new WeakMap,se=new WeakMap,re=new WeakMap,ut=new WeakMap,o=new WeakMap,h=new WeakMap,c=new WeakMap,m=new WeakMap,k=new WeakSet,ze=function(){return s(this,$t)||Ut(this,$t,new Map)},gt=new WeakSet,qe=function(){if(!s(this,Pt)){const It=s(this,Jt).createElement("div"),{style:Xt}=It;Xt.visibility="hidden",Xt.contain="strict",Xt.width=Xt.height=0,Xt.position="absolute",Xt.top=Xt.left=0,Xt.zIndex=-1;const ae=s(this,Jt).createElementNS(St,"svg");ae.setAttribute("width",0),ae.setAttribute("height",0),Ut(this,Pt,s(this,Jt).createElementNS(St,"defs")),It.append(ae),ae.append(s(this,Pt)),s(this,Jt).body.append(It)}return s(this,Pt)},Nt=new WeakSet,Dn=function(It){const Xt=s(this,Jt).createElementNS(St,"feColorMatrix");Xt.setAttribute("type","matrix"),Xt.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),It.append(Xt)},jt=new WeakSet,ln=function(It){const Xt=s(this,Jt).createElementNS(St,"filter");return Xt.setAttribute("color-interpolation-filters","sRGB"),Xt.setAttribute("id",It),s(this,gt,qe).append(Xt),Xt},Yt=new WeakSet,cn=function(It,Xt,ae){const oe=s(this,Jt).createElementNS(St,Xt);oe.setAttribute("type","discrete"),oe.setAttribute("tableValues",ae),It.append(oe)},le=new WeakSet,Ze=function(It,Xt,ae,oe){const Ae=s(this,Jt).createElementNS(St,"feComponentTransfer");oe.append(Ae),xt(this,Yt,cn).call(this,Ae,"feFuncR",It),xt(this,Yt,cn).call(this,Ae,"feFuncG",Xt),xt(this,Yt,cn).call(this,Ae,"feFuncB",ae)},ne=new WeakSet,tn=function(It){return s(this,gt,qe).style.color=It,$(getComputedStyle(s(this,gt,qe)).getPropertyValue("color"))},e.DOMFilterFactory=Wt;class ht extends i.BaseCanvasFactory{constructor({ownerDocument:Ot=globalThis.document}={}){super(),this._document=Ot}_createCanvas(Ot,It){const Xt=this._document.createElement("canvas");return Xt.width=Ot,Xt.height=It,Xt}}e.DOMCanvasFactory=ht;async function rt(Kt,Ot=!1){if(et(Kt,document.baseURI)){const It=await fetch(Kt);if(!It.ok)throw new Error(It.statusText);return Ot?new Uint8Array(await It.arrayBuffer()):(0,b.stringToBytes)(await It.text())}return new Promise((It,Xt)=>{const ae=new XMLHttpRequest;ae.open("GET",Kt,!0),Ot&&(ae.responseType="arraybuffer"),ae.onreadystatechange=()=>{if(ae.readyState===XMLHttpRequest.DONE){if(ae.status===200||ae.status===0){let oe;if(Ot&&ae.response?oe=new Uint8Array(ae.response):!Ot&&ae.responseText&&(oe=(0,b.stringToBytes)(ae.responseText)),oe){It(oe);return}}Xt(new Error(ae.statusText))}},ae.send(null)})}class X extends i.BaseCMapReaderFactory{_fetchData(Ot,It){return rt(Ot,this.isCompressed).then(Xt=>({cMapData:Xt,compressionType:It}))}}e.DOMCMapReaderFactory=X;class mt extends i.BaseStandardFontDataFactory{_fetchData(Ot){return rt(Ot,!0)}}e.DOMStandardFontDataFactory=mt;class _t extends i.BaseSVGFactory{_createSVG(Ot){return document.createElementNS(St,Ot)}}e.DOMSVGFactory=_t;class dt{constructor({viewBox:Ot,scale:It,rotation:Xt,offsetX:ae=0,offsetY:oe=0,dontFlip:Ae=!1}){this.viewBox=Ot,this.scale=It,this.rotation=Xt,this.offsetX=ae,this.offsetY=oe;const Pe=(Ot[2]+Ot[0])/2,ve=(Ot[3]+Ot[1])/2;let we,Te,Ee,Ce;switch(Xt%=360,Xt<0&&(Xt+=360),Xt){case 180:we=-1,Te=0,Ee=0,Ce=1;break;case 90:we=0,Te=1,Ee=1,Ce=0;break;case 270:we=0,Te=-1,Ee=-1,Ce=0;break;case 0:we=1,Te=0,Ee=0,Ce=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}Ae&&(Ee=-Ee,Ce=-Ce);let qt,Dt,kt,Zt;we===0?(qt=Math.abs(ve-Ot[1])*It+ae,Dt=Math.abs(Pe-Ot[0])*It+oe,kt=(Ot[3]-Ot[1])*It,Zt=(Ot[2]-Ot[0])*It):(qt=Math.abs(Pe-Ot[0])*It+ae,Dt=Math.abs(ve-Ot[1])*It+oe,kt=(Ot[2]-Ot[0])*It,Zt=(Ot[3]-Ot[1])*It),this.transform=[we*It,Te*It,Ee*It,Ce*It,qt-we*It*Pe-Ee*It*ve,Dt-Te*It*Pe-Ce*It*ve],this.width=kt,this.height=Zt}get rawDims(){const{viewBox:Ot}=this;return(0,b.shadow)(this,"rawDims",{pageWidth:Ot[2]-Ot[0],pageHeight:Ot[3]-Ot[1],pageX:Ot[0],pageY:Ot[1]})}clone({scale:Ot=this.scale,rotation:It=this.rotation,offsetX:Xt=this.offsetX,offsetY:ae=this.offsetY,dontFlip:oe=!1}={}){return new dt({viewBox:this.viewBox.slice(),scale:Ot,rotation:It,offsetX:Xt,offsetY:ae,dontFlip:oe})}convertToViewportPoint(Ot,It){return b.Util.applyTransform([Ot,It],this.transform)}convertToViewportRectangle(Ot){const It=b.Util.applyTransform([Ot[0],Ot[1]],this.transform),Xt=b.Util.applyTransform([Ot[2],Ot[3]],this.transform);return[It[0],It[1],Xt[0],Xt[1]]}convertToPdfPoint(Ot,It){return b.Util.applyInverseTransform([Ot,It],this.transform)}}e.PageViewport=dt;class st extends b.BaseException{constructor(Ot,It=0){super(Ot,"RenderingCancelledException"),this.extraDelay=It}}e.RenderingCancelledException=st;function nt(Kt){const Ot=Kt.length;let It=0;for(;It<Ot&&Kt[It].trim()==="";)It++;return Kt.substring(It,It+5).toLowerCase()==="data:"}function j(Kt){return typeof Kt=="string"&&/\.pdf$/i.test(Kt)}function tt(Kt,Ot=!1){return Ot||([Kt]=Kt.split(/[#?]/,1)),Kt.substring(Kt.lastIndexOf("/")+1)}function ct(Kt,Ot="document.pdf"){if(typeof Kt!="string")return Ot;if(nt(Kt))return(0,b.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),Ot;const It=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,Xt=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,ae=It.exec(Kt);let oe=Xt.exec(ae[1])||Xt.exec(ae[2])||Xt.exec(ae[3]);if(oe&&(oe=oe[0],oe.includes("%")))try{oe=Xt.exec(decodeURIComponent(oe))[0]}catch{}return oe||Ot}class lt{constructor(){Ie(this,"started",Object.create(null));Ie(this,"times",[])}time(Ot){Ot in this.started&&(0,b.warn)(`Timer is already running for ${Ot}`),this.started[Ot]=Date.now()}timeEnd(Ot){Ot in this.started||(0,b.warn)(`Timer has not been started for ${Ot}`),this.times.push({name:Ot,start:this.started[Ot],end:Date.now()}),delete this.started[Ot]}toString(){const Ot=[];let It=0;for(const{name:Xt}of this.times)It=Math.max(Xt.length,It);for(const{name:Xt,start:ae,end:oe}of this.times)Ot.push(`${Xt.padEnd(It)} ${oe-ae}ms
`);return Ot.join("")}}e.StatTimer=lt;function et(Kt,Ot){try{const{protocol:It}=Ot?new URL(Kt,Ot):new URL(Kt);return It==="http:"||It==="https:"}catch{return!1}}function f(Kt){Kt.preventDefault()}function _(Kt,Ot=!1){return new Promise((It,Xt)=>{const ae=document.createElement("script");ae.src=Kt,ae.onload=function(oe){Ot&&ae.remove(),It(oe)},ae.onerror=function(){Xt(new Error(`Cannot load script at: ${ae.src}`))},(document.head||document.documentElement).append(ae)})}function pt(Kt){console.log("Deprecated API usage: "+Kt)}let Y;class g{static toDateObject(Ot){if(!Ot||typeof Ot!="string")return null;Y||(Y=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const It=Y.exec(Ot);if(!It)return null;const Xt=parseInt(It[1],10);let ae=parseInt(It[2],10);ae=ae>=1&&ae<=12?ae-1:0;let oe=parseInt(It[3],10);oe=oe>=1&&oe<=31?oe:1;let Ae=parseInt(It[4],10);Ae=Ae>=0&&Ae<=23?Ae:0;let Pe=parseInt(It[5],10);Pe=Pe>=0&&Pe<=59?Pe:0;let ve=parseInt(It[6],10);ve=ve>=0&&ve<=59?ve:0;const we=It[7]||"Z";let Te=parseInt(It[8],10);Te=Te>=0&&Te<=23?Te:0;let Ee=parseInt(It[9],10)||0;return Ee=Ee>=0&&Ee<=59?Ee:0,we==="-"?(Ae+=Te,Pe+=Ee):we==="+"&&(Ae-=Te,Pe-=Ee),new Date(Date.UTC(Xt,ae,oe,Ae,Pe,ve))}}e.PDFDateString=g;function ft(Kt,{scale:Ot=1,rotation:It=0}){const{width:Xt,height:ae}=Kt.attributes.style,oe=[0,0,parseInt(Xt),parseInt(ae)];return new dt({viewBox:oe,scale:Ot,rotation:It})}function $(Kt){if(Kt.startsWith("#")){const Ot=parseInt(Kt.slice(1),16);return[(Ot&16711680)>>16,(Ot&65280)>>8,Ot&255]}return Kt.startsWith("rgb(")?Kt.slice(4,-1).split(",").map(Ot=>parseInt(Ot)):Kt.startsWith("rgba(")?Kt.slice(5,-1).split(",").map(Ot=>parseInt(Ot)).slice(0,3):((0,b.warn)(`Not a valid color format: "${Kt}"`),[0,0,0])}function Tt(Kt){const Ot=document.createElement("span");Ot.style.visibility="hidden",document.body.append(Ot);for(const It of Kt.keys()){Ot.style.color=It;const Xt=window.getComputedStyle(Ot).color;Kt.set(It,$(Xt))}Ot.remove()}function wt(Kt){const{a:Ot,b:It,c:Xt,d:ae,e:oe,f:Ae}=Kt.getTransform();return[Ot,It,Xt,ae,oe,Ae]}function at(Kt){const{a:Ot,b:It,c:Xt,d:ae,e:oe,f:Ae}=Kt.getTransform().invertSelf();return[Ot,It,Xt,ae,oe,Ae]}function Rt(Kt,Ot,It=!1,Xt=!0){if(Ot instanceof dt){const{pageWidth:ae,pageHeight:oe}=Ot.rawDims,{style:Ae}=Kt,Pe=b.FeatureTest.isCSSRoundSupported,ve=`var(--scale-factor) * ${ae}px`,we=`var(--scale-factor) * ${oe}px`,Te=Pe?`round(${ve}, 1px)`:`calc(${ve})`,Ee=Pe?`round(${we}, 1px)`:`calc(${we})`;!It||Ot.rotation%180===0?(Ae.width=Te,Ae.height=Ee):(Ae.width=Ee,Ae.height=Te)}Xt&&Kt.setAttribute("data-main-rotation",Ot.rotation)}},(d,e,ot)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BaseStandardFontDataFactory=e.BaseSVGFactory=e.BaseFilterFactory=e.BaseCanvasFactory=e.BaseCMapReaderFactory=void 0;var i=ot(1);class b{constructor(){this.constructor===b&&(0,i.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(X){return"none"}addHCMFilter(X,mt){return"none"}addHighlightHCMFilter(X,mt,_t,dt){return"none"}destroy(X=!1){}}e.BaseFilterFactory=b;class St{constructor(){this.constructor===St&&(0,i.unreachable)("Cannot initialize BaseCanvasFactory.")}create(X,mt){if(X<=0||mt<=0)throw new Error("Invalid canvas size");const _t=this._createCanvas(X,mt);return{canvas:_t,context:_t.getContext("2d")}}reset(X,mt,_t){if(!X.canvas)throw new Error("Canvas is not specified");if(mt<=0||_t<=0)throw new Error("Invalid canvas size");X.canvas.width=mt,X.canvas.height=_t}destroy(X){if(!X.canvas)throw new Error("Canvas is not specified");X.canvas.width=0,X.canvas.height=0,X.canvas=null,X.context=null}_createCanvas(X,mt){(0,i.unreachable)("Abstract method `_createCanvas` called.")}}e.BaseCanvasFactory=St;class bt{constructor({baseUrl:X=null,isCompressed:mt=!0}){this.constructor===bt&&(0,i.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=X,this.isCompressed=mt}async fetch({name:X}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!X)throw new Error("CMap name must be specified.");const mt=this.baseUrl+X+(this.isCompressed?".bcmap":""),_t=this.isCompressed?i.CMapCompressionType.BINARY:i.CMapCompressionType.NONE;return this._fetchData(mt,_t).catch(dt=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${mt}`)})}_fetchData(X,mt){(0,i.unreachable)("Abstract method `_fetchData` called.")}}e.BaseCMapReaderFactory=bt;class Wt{constructor({baseUrl:X=null}){this.constructor===Wt&&(0,i.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=X}async fetch({filename:X}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!X)throw new Error("Font filename must be specified.");const mt=`${this.baseUrl}${X}`;return this._fetchData(mt).catch(_t=>{throw new Error(`Unable to load font data at: ${mt}`)})}_fetchData(X){(0,i.unreachable)("Abstract method `_fetchData` called.")}}e.BaseStandardFontDataFactory=Wt;class ht{constructor(){this.constructor===ht&&(0,i.unreachable)("Cannot initialize BaseSVGFactory.")}create(X,mt,_t=!1){if(X<=0||mt<=0)throw new Error("Invalid SVG dimensions");const dt=this._createSVG("svg:svg");return dt.setAttribute("version","1.1"),_t||(dt.setAttribute("width",`${X}px`),dt.setAttribute("height",`${mt}px`)),dt.setAttribute("preserveAspectRatio","none"),dt.setAttribute("viewBox",`0 0 ${X} ${mt}`),dt}createElement(X){if(typeof X!="string")throw new Error("Invalid SVG element type");return this._createSVG(X)}_createSVG(X){(0,i.unreachable)("Abstract method `_createSVG` called.")}}e.BaseSVGFactory=ht},(d,e,ot)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.MurmurHash3_64=void 0;var i=ot(1);const b=3285377520,St=4294901760,bt=65535;class Wt{constructor(rt){this.h1=rt?rt&4294967295:b,this.h2=rt?rt&4294967295:b}update(rt){let X,mt;if(typeof rt=="string"){X=new Uint8Array(rt.length*2),mt=0;for(let pt=0,Y=rt.length;pt<Y;pt++){const g=rt.charCodeAt(pt);g<=255?X[mt++]=g:(X[mt++]=g>>>8,X[mt++]=g&255)}}else if((0,i.isArrayBuffer)(rt))X=rt.slice(),mt=X.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const _t=mt>>2,dt=mt-_t*4,st=new Uint32Array(X.buffer,0,_t);let nt=0,j=0,tt=this.h1,ct=this.h2;const lt=3432918353,et=461845907,f=lt&bt,_=et&bt;for(let pt=0;pt<_t;pt++)pt&1?(nt=st[pt],nt=nt*lt&St|nt*f&bt,nt=nt<<15|nt>>>17,nt=nt*et&St|nt*_&bt,tt^=nt,tt=tt<<13|tt>>>19,tt=tt*5+3864292196):(j=st[pt],j=j*lt&St|j*f&bt,j=j<<15|j>>>17,j=j*et&St|j*_&bt,ct^=j,ct=ct<<13|ct>>>19,ct=ct*5+3864292196);switch(nt=0,dt){case 3:nt^=X[_t*4+2]<<16;case 2:nt^=X[_t*4+1]<<8;case 1:nt^=X[_t*4],nt=nt*lt&St|nt*f&bt,nt=nt<<15|nt>>>17,nt=nt*et&St|nt*_&bt,_t&1?tt^=nt:ct^=nt}this.h1=tt,this.h2=ct}hexdigest(){let rt=this.h1,X=this.h2;return rt^=X>>>1,rt=rt*3981806797&St|rt*36045&bt,X=X*4283543511&St|((X<<16|rt>>>16)*2950163797&St)>>>16,rt^=X>>>1,rt=rt*444984403&St|rt*60499&bt,X=X*3301882366&St|((X<<16|rt>>>16)*3120437893&St)>>>16,rt^=X>>>1,(rt>>>0).toString(16).padStart(8,"0")+(X>>>0).toString(16).padStart(8,"0")}}e.MurmurHash3_64=Wt},(d,e,ot)=>{var bt;Object.defineProperty(e,"__esModule",{value:!0}),e.FontLoader=e.FontFaceObject=void 0;var i=ot(1);class b{constructor({ownerDocument:ht=globalThis.document,styleElement:rt=null}){Et(this,bt,new Set);this._document=ht,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(ht){this.nativeFontFaces.add(ht),this._document.fonts.add(ht)}removeNativeFontFace(ht){this.nativeFontFaces.delete(ht),this._document.fonts.delete(ht)}insertRule(ht){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const rt=this.styleElement.sheet;rt.insertRule(ht,rt.cssRules.length)}clear(){for(const ht of this.nativeFontFaces)this._document.fonts.delete(ht);this.nativeFontFaces.clear(),s(this,bt).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont(ht){if(!(!ht||s(this,bt).has(ht.loadedName))){if((0,i.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:rt,src:X,style:mt}=ht,_t=new FontFace(rt,X,mt);this.addNativeFontFace(_t);try{await _t.load(),s(this,bt).add(rt)}catch{(0,i.warn)(`Cannot load system font: ${ht.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(_t)}return}(0,i.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(ht){if(ht.attached||ht.missingFile&&!ht.systemFontInfo)return;if(ht.attached=!0,ht.systemFontInfo){await this.loadSystemFont(ht.systemFontInfo);return}if(this.isFontLoadingAPISupported){const X=ht.createNativeFontFace();if(X){this.addNativeFontFace(X);try{await X.loaded}catch(mt){throw(0,i.warn)(`Failed to load font '${X.family}': '${mt}'.`),ht.disableFontFace=!0,mt}}return}const rt=ht.createFontFaceRule();if(rt){if(this.insertRule(rt),this.isSyncFontLoadingSupported)return;await new Promise(X=>{const mt=this._queueLoadingCallback(X);this._prepareFontLoadEvent(ht,mt)})}}get isFontLoadingAPISupported(){var rt;const ht=!!((rt=this._document)!=null&&rt.fonts);return(0,i.shadow)(this,"isFontLoadingAPISupported",ht)}get isSyncFontLoadingSupported(){let ht=!1;return(i.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(ht=!0),(0,i.shadow)(this,"isSyncFontLoadingSupported",ht)}_queueLoadingCallback(ht){function rt(){for((0,i.assert)(!mt.done,"completeRequest() cannot be called twice."),mt.done=!0;X.length>0&&X[0].done;){const _t=X.shift();setTimeout(_t.callback,0)}}const{loadingRequests:X}=this,mt={done:!1,complete:rt,callback:ht};return X.push(mt),mt}get _loadTestFont(){const ht=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,i.shadow)(this,"_loadTestFont",ht)}_prepareFontLoadEvent(ht,rt){function X($,Tt){return $.charCodeAt(Tt)<<24|$.charCodeAt(Tt+1)<<16|$.charCodeAt(Tt+2)<<8|$.charCodeAt(Tt+3)&255}function mt($,Tt,wt,at){const Rt=$.substring(0,Tt),Bt=$.substring(Tt+wt);return Rt+at+Bt}let _t,dt;const st=this._document.createElement("canvas");st.width=1,st.height=1;const nt=st.getContext("2d");let j=0;function tt($,Tt){if(++j>30){(0,i.warn)("Load test font never loaded."),Tt();return}if(nt.font="30px "+$,nt.fillText(".",0,20),nt.getImageData(0,0,1,1).data[3]>0){Tt();return}setTimeout(tt.bind(null,$,Tt))}const ct=`lt${Date.now()}${this.loadTestFontId++}`;let lt=this._loadTestFont;lt=mt(lt,976,ct.length,ct);const f=16,_=1482184792;let pt=X(lt,f);for(_t=0,dt=ct.length-3;_t<dt;_t+=4)pt=pt-_+X(ct,_t)|0;_t<ct.length&&(pt=pt-_+X(ct+"XXX",_t)|0),lt=mt(lt,f,4,(0,i.string32)(pt));const Y=`url(data:font/opentype;base64,${btoa(lt)});`,g=`@font-face {font-family:"${ct}";src:${Y}}`;this.insertRule(g);const ft=this._document.createElement("div");ft.style.visibility="hidden",ft.style.width=ft.style.height="10px",ft.style.position="absolute",ft.style.top=ft.style.left="0px";for(const $ of[ht.loadedName,ct]){const Tt=this._document.createElement("span");Tt.textContent="Hi",Tt.style.fontFamily=$,ft.append(Tt)}this._document.body.append(ft),tt(ct,()=>{ft.remove(),rt.complete()})}}bt=new WeakMap,e.FontLoader=b;class St{constructor(ht,{isEvalSupported:rt=!0,disableFontFace:X=!1,ignoreErrors:mt=!1,inspectFont:_t=null}){this.compiledGlyphs=Object.create(null);for(const dt in ht)this[dt]=ht[dt];this.isEvalSupported=rt!==!1,this.disableFontFace=X===!0,this.ignoreErrors=mt===!0,this._inspectFont=_t}createNativeFontFace(){var rt;if(!this.data||this.disableFontFace)return null;let ht;if(!this.cssFontInfo)ht=new FontFace(this.loadedName,this.data,{});else{const X={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(X.style=`oblique ${this.cssFontInfo.italicAngle}deg`),ht=new FontFace(this.cssFontInfo.fontFamily,this.data,X)}return(rt=this._inspectFont)==null||rt.call(this,this),ht}createFontFaceRule(){var mt;if(!this.data||this.disableFontFace)return null;const ht=(0,i.bytesToString)(this.data),rt=`url(data:${this.mimetype};base64,${btoa(ht)});`;let X;if(!this.cssFontInfo)X=`@font-face {font-family:"${this.loadedName}";src:${rt}}`;else{let _t=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(_t+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),X=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${_t}src:${rt}}`}return(mt=this._inspectFont)==null||mt.call(this,this,rt),X}getPathGenerator(ht,rt){if(this.compiledGlyphs[rt]!==void 0)return this.compiledGlyphs[rt];let X;try{X=ht.get(this.loadedName+"_path_"+rt)}catch(mt){if(!this.ignoreErrors)throw mt;return(0,i.warn)(`getPathGenerator - ignoring character: "${mt}".`),this.compiledGlyphs[rt]=function(_t,dt){}}if(this.isEvalSupported&&i.FeatureTest.isEvalSupported){const mt=[];for(const _t of X){const dt=_t.args!==void 0?_t.args.join(","):"";mt.push("c.",_t.cmd,"(",dt,`);
`)}return this.compiledGlyphs[rt]=new Function("c","size",mt.join(""))}return this.compiledGlyphs[rt]=function(mt,_t){for(const dt of X)dt.cmd==="scale"&&(dt.args=[_t,-_t]),mt[dt.cmd].apply(mt,dt.args)}}}e.FontFaceObject=St},(d,e,ot)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.NodeStandardFontDataFactory=e.NodeFilterFactory=e.NodeCanvasFactory=e.NodeCMapReaderFactory=void 0;var i=ot(7);ot(1);const b=function(rt){return new Promise((X,mt)=>{require$$5.readFile(rt,(dt,st)=>{if(dt||!st){mt(new Error(dt));return}X(new Uint8Array(st))})})};class St extends i.BaseFilterFactory{}e.NodeFilterFactory=St;class bt extends i.BaseCanvasFactory{_createCanvas(X,mt){return require$$5.createCanvas(X,mt)}}e.NodeCanvasFactory=bt;class Wt extends i.BaseCMapReaderFactory{_fetchData(X,mt){return b(X).then(_t=>({cMapData:_t,compressionType:mt}))}}e.NodeCMapReaderFactory=Wt;class ht extends i.BaseStandardFontDataFactory{_fetchData(X){return b(X)}}e.NodeStandardFontDataFactory=ht},(d,e,ot)=>{var Pt,Ln,Jt,On;Object.defineProperty(e,"__esModule",{value:!0}),e.CanvasGraphics=void 0;var i=ot(1),b=ot(6),St=ot(12),bt=ot(13);const Wt=16,ht=100,rt=4096,X=15,mt=10,_t=1e3,dt=16;function st(ut,o){if(ut._removeMirroring)throw new Error("Context is already forwarding operations.");ut.__originalSave=ut.save,ut.__originalRestore=ut.restore,ut.__originalRotate=ut.rotate,ut.__originalScale=ut.scale,ut.__originalTranslate=ut.translate,ut.__originalTransform=ut.transform,ut.__originalSetTransform=ut.setTransform,ut.__originalResetTransform=ut.resetTransform,ut.__originalClip=ut.clip,ut.__originalMoveTo=ut.moveTo,ut.__originalLineTo=ut.lineTo,ut.__originalBezierCurveTo=ut.bezierCurveTo,ut.__originalRect=ut.rect,ut.__originalClosePath=ut.closePath,ut.__originalBeginPath=ut.beginPath,ut._removeMirroring=()=>{ut.save=ut.__originalSave,ut.restore=ut.__originalRestore,ut.rotate=ut.__originalRotate,ut.scale=ut.__originalScale,ut.translate=ut.__originalTranslate,ut.transform=ut.__originalTransform,ut.setTransform=ut.__originalSetTransform,ut.resetTransform=ut.__originalResetTransform,ut.clip=ut.__originalClip,ut.moveTo=ut.__originalMoveTo,ut.lineTo=ut.__originalLineTo,ut.bezierCurveTo=ut.__originalBezierCurveTo,ut.rect=ut.__originalRect,ut.closePath=ut.__originalClosePath,ut.beginPath=ut.__originalBeginPath,delete ut._removeMirroring},ut.save=function(){o.save(),this.__originalSave()},ut.restore=function(){o.restore(),this.__originalRestore()},ut.translate=function(c,m){o.translate(c,m),this.__originalTranslate(c,m)},ut.scale=function(c,m){o.scale(c,m),this.__originalScale(c,m)},ut.transform=function(c,m,k,it,gt,vt){o.transform(c,m,k,it,gt,vt),this.__originalTransform(c,m,k,it,gt,vt)},ut.setTransform=function(c,m,k,it,gt,vt){o.setTransform(c,m,k,it,gt,vt),this.__originalSetTransform(c,m,k,it,gt,vt)},ut.resetTransform=function(){o.resetTransform(),this.__originalResetTransform()},ut.rotate=function(c){o.rotate(c),this.__originalRotate(c)},ut.clip=function(c){o.clip(c),this.__originalClip(c)},ut.moveTo=function(h,c){o.moveTo(h,c),this.__originalMoveTo(h,c)},ut.lineTo=function(h,c){o.lineTo(h,c),this.__originalLineTo(h,c)},ut.bezierCurveTo=function(h,c,m,k,it,gt){o.bezierCurveTo(h,c,m,k,it,gt),this.__originalBezierCurveTo(h,c,m,k,it,gt)},ut.rect=function(h,c,m,k){o.rect(h,c,m,k),this.__originalRect(h,c,m,k)},ut.closePath=function(){o.closePath(),this.__originalClosePath()},ut.beginPath=function(){o.beginPath(),this.__originalBeginPath()}}class nt{constructor(o){this.canvasFactory=o,this.cache=Object.create(null)}getCanvas(o,h,c){let m;return this.cache[o]!==void 0?(m=this.cache[o],this.canvasFactory.reset(m,h,c)):(m=this.canvasFactory.create(h,c),this.cache[o]=m),m}delete(o){delete this.cache[o]}clear(){for(const o in this.cache){const h=this.cache[o];this.canvasFactory.destroy(h),delete this.cache[o]}}}function j(ut,o,h,c,m,k,it,gt,vt,Nt){const[Lt,jt,zt,Yt,Gt,le]=(0,b.getCurrentTransform)(ut);if(jt===0&&zt===0){const pe=it*Lt+Gt,Kt=Math.round(pe),Ot=gt*Yt+le,It=Math.round(Ot),Xt=(it+vt)*Lt+Gt,ae=Math.abs(Math.round(Xt)-Kt)||1,oe=(gt+Nt)*Yt+le,Ae=Math.abs(Math.round(oe)-It)||1;return ut.setTransform(Math.sign(Lt),0,0,Math.sign(Yt),Kt,It),ut.drawImage(o,h,c,m,k,0,0,ae,Ae),ut.setTransform(Lt,jt,zt,Yt,Gt,le),[ae,Ae]}if(Lt===0&&Yt===0){const pe=gt*zt+Gt,Kt=Math.round(pe),Ot=it*jt+le,It=Math.round(Ot),Xt=(gt+Nt)*zt+Gt,ae=Math.abs(Math.round(Xt)-Kt)||1,oe=(it+vt)*jt+le,Ae=Math.abs(Math.round(oe)-It)||1;return ut.setTransform(0,Math.sign(jt),Math.sign(zt),0,Kt,It),ut.drawImage(o,h,c,m,k,0,0,Ae,ae),ut.setTransform(Lt,jt,zt,Yt,Gt,le),[Ae,ae]}ut.drawImage(o,h,c,m,k,it,gt,vt,Nt);const ge=Math.hypot(Lt,jt),ne=Math.hypot(zt,Yt);return[ge*vt,ne*Nt]}function tt(ut){const{width:o,height:h}=ut;if(o>_t||h>_t)return null;const c=1e3,m=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),k=o+1;let it=new Uint8Array(k*(h+1)),gt,vt,Nt;const Lt=o+7&-8;let jt=new Uint8Array(Lt*h),zt=0;for(const ne of ut.data){let pe=128;for(;pe>0;)jt[zt++]=ne&pe?0:255,pe>>=1}let Yt=0;for(zt=0,jt[zt]!==0&&(it[0]=1,++Yt),vt=1;vt<o;vt++)jt[zt]!==jt[zt+1]&&(it[vt]=jt[zt]?2:1,++Yt),zt++;for(jt[zt]!==0&&(it[vt]=2,++Yt),gt=1;gt<h;gt++){zt=gt*Lt,Nt=gt*k,jt[zt-Lt]!==jt[zt]&&(it[Nt]=jt[zt]?1:8,++Yt);let ne=(jt[zt]?4:0)+(jt[zt-Lt]?8:0);for(vt=1;vt<o;vt++)ne=(ne>>2)+(jt[zt+1]?4:0)+(jt[zt-Lt+1]?8:0),m[ne]&&(it[Nt+vt]=m[ne],++Yt),zt++;if(jt[zt-Lt]!==jt[zt]&&(it[Nt+vt]=jt[zt]?2:4,++Yt),Yt>c)return null}for(zt=Lt*(h-1),Nt=gt*k,jt[zt]!==0&&(it[Nt]=8,++Yt),vt=1;vt<o;vt++)jt[zt]!==jt[zt+1]&&(it[Nt+vt]=jt[zt]?4:8,++Yt),zt++;if(jt[zt]!==0&&(it[Nt+vt]=4,++Yt),Yt>c)return null;const Gt=new Int32Array([0,k,-1,0,-k,0,0,0,1]),le=new Path2D;for(gt=0;Yt&&gt<=h;gt++){let ne=gt*k;const pe=ne+o;for(;ne<pe&&!it[ne];)ne++;if(ne===pe)continue;le.moveTo(ne%k,gt);const Kt=ne;let Ot=it[ne];do{const It=Gt[Ot];do ne+=It;while(!it[ne]);const Xt=it[ne];Xt!==5&&Xt!==10?(Ot=Xt,it[ne]=0):(Ot=Xt&51*Ot>>4,it[ne]&=Ot>>2|Ot<<2),le.lineTo(ne%k,ne/k|0),it[ne]||--Yt}while(Kt!==ne);--gt}return jt=null,it=null,function(ne){ne.save(),ne.scale(1/o,-1/h),ne.translate(0,-h),ne.fill(le),ne.beginPath(),ne.restore()}}class ct{constructor(o,h){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=i.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=i.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=i.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,o,h])}clone(){const o=Object.create(this);return o.clipBox=this.clipBox.slice(),o}setCurrentPoint(o,h){this.x=o,this.y=h}updatePathMinMax(o,h,c){[h,c]=i.Util.applyTransform([h,c],o),this.minX=Math.min(this.minX,h),this.minY=Math.min(this.minY,c),this.maxX=Math.max(this.maxX,h),this.maxY=Math.max(this.maxY,c)}updateRectMinMax(o,h){const c=i.Util.applyTransform(h,o),m=i.Util.applyTransform(h.slice(2),o);this.minX=Math.min(this.minX,c[0],m[0]),this.minY=Math.min(this.minY,c[1],m[1]),this.maxX=Math.max(this.maxX,c[0],m[0]),this.maxY=Math.max(this.maxY,c[1],m[1])}updateScalingPathMinMax(o,h){i.Util.scaleMinMax(o,h),this.minX=Math.min(this.minX,h[0]),this.maxX=Math.max(this.maxX,h[1]),this.minY=Math.min(this.minY,h[2]),this.maxY=Math.max(this.maxY,h[3])}updateCurvePathMinMax(o,h,c,m,k,it,gt,vt,Nt,Lt){const jt=i.Util.bezierBoundingBox(h,c,m,k,it,gt,vt,Nt);if(Lt){Lt[0]=Math.min(Lt[0],jt[0],jt[2]),Lt[1]=Math.max(Lt[1],jt[0],jt[2]),Lt[2]=Math.min(Lt[2],jt[1],jt[3]),Lt[3]=Math.max(Lt[3],jt[1],jt[3]);return}this.updateRectMinMax(o,jt)}getPathBoundingBox(o=St.PathType.FILL,h=null){const c=[this.minX,this.minY,this.maxX,this.maxY];if(o===St.PathType.STROKE){h||(0,i.unreachable)("Stroke bounding box must include transform.");const m=i.Util.singularValueDecompose2dScale(h),k=m[0]*this.lineWidth/2,it=m[1]*this.lineWidth/2;c[0]-=k,c[1]-=it,c[2]+=k,c[3]+=it}return c}updateClipFromPath(){const o=i.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(o||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(o){this.clipBox=o,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(o=St.PathType.FILL,h=null){return i.Util.intersect(this.clipBox,this.getPathBoundingBox(o,h))}}function lt(ut,o){if(typeof ImageData<"u"&&o instanceof ImageData){ut.putImageData(o,0,0);return}const h=o.height,c=o.width,m=h%dt,k=(h-m)/dt,it=m===0?k:k+1,gt=ut.createImageData(c,dt);let vt=0,Nt;const Lt=o.data,jt=gt.data;let zt,Yt,Gt,le;if(o.kind===i.ImageKind.GRAYSCALE_1BPP){const ge=Lt.byteLength,ne=new Uint32Array(jt.buffer,0,jt.byteLength>>2),pe=ne.length,Kt=c+7>>3,Ot=4294967295,It=i.FeatureTest.isLittleEndian?4278190080:255;for(zt=0;zt<it;zt++){for(Gt=zt<k?dt:m,Nt=0,Yt=0;Yt<Gt;Yt++){const Xt=ge-vt;let ae=0;const oe=Xt>Kt?c:Xt*8-7,Ae=oe&-8;let Pe=0,ve=0;for(;ae<Ae;ae+=8)ve=Lt[vt++],ne[Nt++]=ve&128?Ot:It,ne[Nt++]=ve&64?Ot:It,ne[Nt++]=ve&32?Ot:It,ne[Nt++]=ve&16?Ot:It,ne[Nt++]=ve&8?Ot:It,ne[Nt++]=ve&4?Ot:It,ne[Nt++]=ve&2?Ot:It,ne[Nt++]=ve&1?Ot:It;for(;ae<oe;ae++)Pe===0&&(ve=Lt[vt++],Pe=128),ne[Nt++]=ve&Pe?Ot:It,Pe>>=1}for(;Nt<pe;)ne[Nt++]=0;ut.putImageData(gt,0,zt*dt)}}else if(o.kind===i.ImageKind.RGBA_32BPP){for(Yt=0,le=c*dt*4,zt=0;zt<k;zt++)jt.set(Lt.subarray(vt,vt+le)),vt+=le,ut.putImageData(gt,0,Yt),Yt+=dt;zt<it&&(le=c*m*4,jt.set(Lt.subarray(vt,vt+le)),ut.putImageData(gt,0,Yt))}else if(o.kind===i.ImageKind.RGB_24BPP)for(Gt=dt,le=c*Gt,zt=0;zt<it;zt++){for(zt>=k&&(Gt=m,le=c*Gt),Nt=0,Yt=le;Yt--;)jt[Nt++]=Lt[vt++],jt[Nt++]=Lt[vt++],jt[Nt++]=Lt[vt++],jt[Nt++]=255;ut.putImageData(gt,0,zt*dt)}else throw new Error(`bad image kind: ${o.kind}`)}function et(ut,o){if(o.bitmap){ut.drawImage(o.bitmap,0,0);return}const h=o.height,c=o.width,m=h%dt,k=(h-m)/dt,it=m===0?k:k+1,gt=ut.createImageData(c,dt);let vt=0;const Nt=o.data,Lt=gt.data;for(let jt=0;jt<it;jt++){const zt=jt<k?dt:m;({srcPos:vt}=(0,bt.convertBlackAndWhiteToRGBA)({src:Nt,srcPos:vt,dest:Lt,width:c,height:zt,nonBlackColor:0})),ut.putImageData(gt,0,jt*dt)}}function f(ut,o){const h=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const c of h)ut[c]!==void 0&&(o[c]=ut[c]);ut.setLineDash!==void 0&&(o.setLineDash(ut.getLineDash()),o.lineDashOffset=ut.lineDashOffset)}function _(ut){if(ut.strokeStyle=ut.fillStyle="#000000",ut.fillRule="nonzero",ut.globalAlpha=1,ut.lineWidth=1,ut.lineCap="butt",ut.lineJoin="miter",ut.miterLimit=10,ut.globalCompositeOperation="source-over",ut.font="10px sans-serif",ut.setLineDash!==void 0&&(ut.setLineDash([]),ut.lineDashOffset=0),!i.isNodeJS){const{filter:o}=ut;o!=="none"&&o!==""&&(ut.filter="none")}}function pt(ut,o,h,c){const m=ut.length;for(let k=3;k<m;k+=4){const it=ut[k];if(it===0)ut[k-3]=o,ut[k-2]=h,ut[k-1]=c;else if(it<255){const gt=255-it;ut[k-3]=ut[k-3]*it+o*gt>>8,ut[k-2]=ut[k-2]*it+h*gt>>8,ut[k-1]=ut[k-1]*it+c*gt>>8}}}function Y(ut,o,h){const c=ut.length,m=1/255;for(let k=3;k<c;k+=4){const it=h?h[ut[k]]:ut[k];o[k]=o[k]*it*m|0}}function g(ut,o,h){const c=ut.length;for(let m=3;m<c;m+=4){const k=ut[m-3]*77+ut[m-2]*152+ut[m-1]*28;o[m]=h?o[m]*h[k>>8]>>8:o[m]*k>>16}}function ft(ut,o,h,c,m,k,it,gt,vt,Nt,Lt){const jt=!!k,zt=jt?k[0]:0,Yt=jt?k[1]:0,Gt=jt?k[2]:0,le=m==="Luminosity"?g:Y,ne=Math.min(c,Math.ceil(1048576/h));for(let pe=0;pe<c;pe+=ne){const Kt=Math.min(ne,c-pe),Ot=ut.getImageData(gt-Nt,pe+(vt-Lt),h,Kt),It=o.getImageData(gt,pe+vt,h,Kt);jt&&pt(Ot.data,zt,Yt,Gt),le(Ot.data,It.data,it),o.putImageData(It,gt,pe+vt)}}function $(ut,o,h,c){const m=c[0],k=c[1],it=c[2]-m,gt=c[3]-k;it===0||gt===0||(ft(o.context,h,it,gt,o.subtype,o.backdrop,o.transferMap,m,k,o.offsetX,o.offsetY),ut.save(),ut.globalAlpha=1,ut.globalCompositeOperation="source-over",ut.setTransform(1,0,0,1,0,0),ut.drawImage(h.canvas,0,0),ut.restore())}function Tt(ut,o){const h=i.Util.singularValueDecompose2dScale(ut);h[0]=Math.fround(h[0]),h[1]=Math.fround(h[1]);const c=Math.fround((globalThis.devicePixelRatio||1)*b.PixelsPerInch.PDF_TO_CSS_UNITS);return o!==void 0?o:h[0]<=c||h[1]<=c}const wt=["butt","round","square"],at=["miter","round","bevel"],Rt={},Bt={},re=class re{constructor(o,h,c,m,k,{optionalContentConfig:it,markedContentStack:gt=null},vt,Nt){Et(this,Pt);Et(this,Jt);this.ctx=o,this.current=new ct(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=h,this.objs=c,this.canvasFactory=m,this.filterFactory=k,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=gt||[],this.optionalContentConfig=it,this.cachedCanvases=new nt(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=vt,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=Nt,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(o,h=null){return typeof o=="string"?o.startsWith("g_")?this.commonObjs.get(o):this.objs.get(o):h}beginDrawing({transform:o,viewport:h,transparency:c=!1,background:m=null}){const k=this.ctx.canvas.width,it=this.ctx.canvas.height,gt=this.ctx.fillStyle;if(this.ctx.fillStyle=m||"#ffffff",this.ctx.fillRect(0,0,k,it),this.ctx.fillStyle=gt,c){const vt=this.cachedCanvases.getCanvas("transparent",k,it);this.compositeCtx=this.ctx,this.transparentCanvas=vt.canvas,this.ctx=vt.context,this.ctx.save(),this.ctx.transform(...(0,b.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),_(this.ctx),o&&(this.ctx.transform(...o),this.outputScaleX=o[0],this.outputScaleY=o[0]),this.ctx.transform(...h.transform),this.viewportScale=h.scale,this.baseTransform=(0,b.getCurrentTransform)(this.ctx)}executeOperatorList(o,h,c,m){const k=o.argsArray,it=o.fnArray;let gt=h||0;const vt=k.length;if(vt===gt)return gt;const Nt=vt-gt>mt&&typeof c=="function",Lt=Nt?Date.now()+X:0;let jt=0;const zt=this.commonObjs,Yt=this.objs;let Gt;for(;;){if(m!==void 0&&gt===m.nextBreakPoint)return m.breakIt(gt,c),gt;if(Gt=it[gt],Gt!==i.OPS.dependency)this[Gt].apply(this,k[gt]);else for(const le of k[gt]){const ge=le.startsWith("g_")?zt:Yt;if(!ge.has(le))return ge.get(le,c),gt}if(gt++,gt===vt)return gt;if(Nt&&++jt>mt){if(Date.now()>Lt)return c(),gt;jt=0}}}endDrawing(){xt(this,Pt,Ln).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const o of this._cachedBitmapsMap.values()){for(const h of o.values())typeof HTMLCanvasElement<"u"&&h instanceof HTMLCanvasElement&&(h.width=h.height=0);o.clear()}this._cachedBitmapsMap.clear(),xt(this,Jt,On).call(this)}_scaleImage(o,h){const c=o.width,m=o.height;let k=Math.max(Math.hypot(h[0],h[1]),1),it=Math.max(Math.hypot(h[2],h[3]),1),gt=c,vt=m,Nt="prescale1",Lt,jt;for(;k>2&&gt>1||it>2&&vt>1;){let zt=gt,Yt=vt;k>2&&gt>1&&(zt=gt>=16384?Math.floor(gt/2)-1||1:Math.ceil(gt/2),k/=gt/zt),it>2&&vt>1&&(Yt=vt>=16384?Math.floor(vt/2)-1||1:Math.ceil(vt)/2,it/=vt/Yt),Lt=this.cachedCanvases.getCanvas(Nt,zt,Yt),jt=Lt.context,jt.clearRect(0,0,zt,Yt),jt.drawImage(o,0,0,gt,vt,0,0,zt,Yt),o=Lt.canvas,gt=zt,vt=Yt,Nt=Nt==="prescale1"?"prescale2":"prescale1"}return{img:o,paintWidth:gt,paintHeight:vt}}_createMaskCanvas(o){const h=this.ctx,{width:c,height:m}=o,k=this.current.fillColor,it=this.current.patternFill,gt=(0,b.getCurrentTransform)(h);let vt,Nt,Lt,jt;if((o.bitmap||o.data)&&o.count>1){const ae=o.bitmap||o.data.buffer;Nt=JSON.stringify(it?gt:[gt.slice(0,4),k]),vt=this._cachedBitmapsMap.get(ae),vt||(vt=new Map,this._cachedBitmapsMap.set(ae,vt));const oe=vt.get(Nt);if(oe&&!it){const Ae=Math.round(Math.min(gt[0],gt[2])+gt[4]),Pe=Math.round(Math.min(gt[1],gt[3])+gt[5]);return{canvas:oe,offsetX:Ae,offsetY:Pe}}Lt=oe}Lt||(jt=this.cachedCanvases.getCanvas("maskCanvas",c,m),et(jt.context,o));let zt=i.Util.transform(gt,[1/c,0,0,-1/m,0,0]);zt=i.Util.transform(zt,[1,0,0,1,0,-m]);const Yt=i.Util.applyTransform([0,0],zt),Gt=i.Util.applyTransform([c,m],zt),le=i.Util.normalizeRect([Yt[0],Yt[1],Gt[0],Gt[1]]),ge=Math.round(le[2]-le[0])||1,ne=Math.round(le[3]-le[1])||1,pe=this.cachedCanvases.getCanvas("fillCanvas",ge,ne),Kt=pe.context,Ot=Math.min(Yt[0],Gt[0]),It=Math.min(Yt[1],Gt[1]);Kt.translate(-Ot,-It),Kt.transform(...zt),Lt||(Lt=this._scaleImage(jt.canvas,(0,b.getCurrentTransformInverse)(Kt)),Lt=Lt.img,vt&&it&&vt.set(Nt,Lt)),Kt.imageSmoothingEnabled=Tt((0,b.getCurrentTransform)(Kt),o.interpolate),j(Kt,Lt,0,0,Lt.width,Lt.height,0,0,c,m),Kt.globalCompositeOperation="source-in";const Xt=i.Util.transform((0,b.getCurrentTransformInverse)(Kt),[1,0,0,1,-Ot,-It]);return Kt.fillStyle=it?k.getPattern(h,this,Xt,St.PathType.FILL):k,Kt.fillRect(0,0,c,m),vt&&!it&&(this.cachedCanvases.delete("fillCanvas"),vt.set(Nt,pe.canvas)),{canvas:pe.canvas,offsetX:Math.round(Ot),offsetY:Math.round(It)}}setLineWidth(o){o!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=o,this.ctx.lineWidth=o}setLineCap(o){this.ctx.lineCap=wt[o]}setLineJoin(o){this.ctx.lineJoin=at[o]}setMiterLimit(o){this.ctx.miterLimit=o}setDash(o,h){const c=this.ctx;c.setLineDash!==void 0&&(c.setLineDash(o),c.lineDashOffset=h)}setRenderingIntent(o){}setFlatness(o){}setGState(o){for(const[h,c]of o)switch(h){case"LW":this.setLineWidth(c);break;case"LC":this.setLineCap(c);break;case"LJ":this.setLineJoin(c);break;case"ML":this.setMiterLimit(c);break;case"D":this.setDash(c[0],c[1]);break;case"RI":this.setRenderingIntent(c);break;case"FL":this.setFlatness(c);break;case"Font":this.setFont(c[0],c[1]);break;case"CA":this.current.strokeAlpha=c;break;case"ca":this.current.fillAlpha=c,this.ctx.globalAlpha=c;break;case"BM":this.ctx.globalCompositeOperation=c;break;case"SMask":this.current.activeSMask=c?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(c);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const o=this.inSMaskMode;this.current.activeSMask&&!o?this.beginSMaskMode():!this.current.activeSMask&&o&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const o=this.ctx.canvas.width,h=this.ctx.canvas.height,c="smaskGroupAt"+this.groupLevel,m=this.cachedCanvases.getCanvas(c,o,h);this.suspendedCtx=this.ctx,this.ctx=m.context;const k=this.ctx;k.setTransform(...(0,b.getCurrentTransform)(this.suspendedCtx)),f(this.suspendedCtx,k),st(k,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),f(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(o){if(!this.current.activeSMask)return;o?(o[0]=Math.floor(o[0]),o[1]=Math.floor(o[1]),o[2]=Math.ceil(o[2]),o[3]=Math.ceil(o[3])):o=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const h=this.current.activeSMask,c=this.suspendedCtx;$(c,h,this.ctx,o),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(f(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const o=this.current;this.stateStack.push(o),this.current=o.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),f(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(o,h,c,m,k,it){this.ctx.transform(o,h,c,m,k,it),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(o,h,c){const m=this.ctx,k=this.current;let it=k.x,gt=k.y,vt,Nt;const Lt=(0,b.getCurrentTransform)(m),jt=Lt[0]===0&&Lt[3]===0||Lt[1]===0&&Lt[2]===0,zt=jt?c.slice(0):null;for(let Yt=0,Gt=0,le=o.length;Yt<le;Yt++)switch(o[Yt]|0){case i.OPS.rectangle:it=h[Gt++],gt=h[Gt++];const ge=h[Gt++],ne=h[Gt++],pe=it+ge,Kt=gt+ne;m.moveTo(it,gt),ge===0||ne===0?m.lineTo(pe,Kt):(m.lineTo(pe,gt),m.lineTo(pe,Kt),m.lineTo(it,Kt)),jt||k.updateRectMinMax(Lt,[it,gt,pe,Kt]),m.closePath();break;case i.OPS.moveTo:it=h[Gt++],gt=h[Gt++],m.moveTo(it,gt),jt||k.updatePathMinMax(Lt,it,gt);break;case i.OPS.lineTo:it=h[Gt++],gt=h[Gt++],m.lineTo(it,gt),jt||k.updatePathMinMax(Lt,it,gt);break;case i.OPS.curveTo:vt=it,Nt=gt,it=h[Gt+4],gt=h[Gt+5],m.bezierCurveTo(h[Gt],h[Gt+1],h[Gt+2],h[Gt+3],it,gt),k.updateCurvePathMinMax(Lt,vt,Nt,h[Gt],h[Gt+1],h[Gt+2],h[Gt+3],it,gt,zt),Gt+=6;break;case i.OPS.curveTo2:vt=it,Nt=gt,m.bezierCurveTo(it,gt,h[Gt],h[Gt+1],h[Gt+2],h[Gt+3]),k.updateCurvePathMinMax(Lt,vt,Nt,it,gt,h[Gt],h[Gt+1],h[Gt+2],h[Gt+3],zt),it=h[Gt+2],gt=h[Gt+3],Gt+=4;break;case i.OPS.curveTo3:vt=it,Nt=gt,it=h[Gt+2],gt=h[Gt+3],m.bezierCurveTo(h[Gt],h[Gt+1],it,gt,it,gt),k.updateCurvePathMinMax(Lt,vt,Nt,h[Gt],h[Gt+1],it,gt,it,gt,zt),Gt+=4;break;case i.OPS.closePath:m.closePath();break}jt&&k.updateScalingPathMinMax(Lt,zt),k.setCurrentPoint(it,gt)}closePath(){this.ctx.closePath()}stroke(o=!0){const h=this.ctx,c=this.current.strokeColor;h.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof c=="object"&&(c!=null&&c.getPattern)?(h.save(),h.strokeStyle=c.getPattern(h,this,(0,b.getCurrentTransformInverse)(h),St.PathType.STROKE),this.rescaleAndStroke(!1),h.restore()):this.rescaleAndStroke(!0)),o&&this.consumePath(this.current.getClippedPathBoundingBox()),h.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(o=!0){const h=this.ctx,c=this.current.fillColor,m=this.current.patternFill;let k=!1;m&&(h.save(),h.fillStyle=c.getPattern(h,this,(0,b.getCurrentTransformInverse)(h),St.PathType.FILL),k=!0);const it=this.current.getClippedPathBoundingBox();this.contentVisible&&it!==null&&(this.pendingEOFill?(h.fill("evenodd"),this.pendingEOFill=!1):h.fill()),k&&h.restore(),o&&this.consumePath(it)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=Rt}eoClip(){this.pendingClip=Bt}beginText(){this.current.textMatrix=i.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const o=this.pendingTextPaths,h=this.ctx;if(o===void 0){h.beginPath();return}h.save(),h.beginPath();for(const c of o)h.setTransform(...c.transform),h.translate(c.x,c.y),c.addToPath(h,c.fontSize);h.restore(),h.clip(),h.beginPath(),delete this.pendingTextPaths}setCharSpacing(o){this.current.charSpacing=o}setWordSpacing(o){this.current.wordSpacing=o}setHScale(o){this.current.textHScale=o/100}setLeading(o){this.current.leading=-o}setFont(o,h){var Lt;const c=this.commonObjs.get(o),m=this.current;if(!c)throw new Error(`Can't find font for ${o}`);if(m.fontMatrix=c.fontMatrix||i.FONT_IDENTITY_MATRIX,(m.fontMatrix[0]===0||m.fontMatrix[3]===0)&&(0,i.warn)("Invalid font matrix for font "+o),h<0?(h=-h,m.fontDirection=-1):m.fontDirection=1,this.current.font=c,this.current.fontSize=h,c.isType3Font)return;const k=c.loadedName||"sans-serif",it=((Lt=c.systemFontInfo)==null?void 0:Lt.css)||`"${k}", ${c.fallbackName}`;let gt="normal";c.black?gt="900":c.bold&&(gt="bold");const vt=c.italic?"italic":"normal";let Nt=h;h<Wt?Nt=Wt:h>ht&&(Nt=ht),this.current.fontSizeScale=h/Nt,this.ctx.font=`${vt} ${gt} ${Nt}px ${it}`}setTextRenderingMode(o){this.current.textRenderingMode=o}setTextRise(o){this.current.textRise=o}moveText(o,h){this.current.x=this.current.lineX+=o,this.current.y=this.current.lineY+=h}setLeadingMoveText(o,h){this.setLeading(-h),this.moveText(o,h)}setTextMatrix(o,h,c,m,k,it){this.current.textMatrix=[o,h,c,m,k,it],this.current.textMatrixScale=Math.hypot(o,h),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(o,h,c,m){const k=this.ctx,it=this.current,gt=it.font,vt=it.textRenderingMode,Nt=it.fontSize/it.fontSizeScale,Lt=vt&i.TextRenderingMode.FILL_STROKE_MASK,jt=!!(vt&i.TextRenderingMode.ADD_TO_PATH_FLAG),zt=it.patternFill&&!gt.missingFile;let Yt;(gt.disableFontFace||jt||zt)&&(Yt=gt.getPathGenerator(this.commonObjs,o)),gt.disableFontFace||zt?(k.save(),k.translate(h,c),k.beginPath(),Yt(k,Nt),m&&k.setTransform(...m),(Lt===i.TextRenderingMode.FILL||Lt===i.TextRenderingMode.FILL_STROKE)&&k.fill(),(Lt===i.TextRenderingMode.STROKE||Lt===i.TextRenderingMode.FILL_STROKE)&&k.stroke(),k.restore()):((Lt===i.TextRenderingMode.FILL||Lt===i.TextRenderingMode.FILL_STROKE)&&k.fillText(o,h,c),(Lt===i.TextRenderingMode.STROKE||Lt===i.TextRenderingMode.FILL_STROKE)&&k.strokeText(o,h,c)),jt&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,b.getCurrentTransform)(k),x:h,y:c,fontSize:Nt,addToPath:Yt})}get isFontSubpixelAAEnabled(){const{context:o}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);o.scale(1.5,1),o.fillText("I",0,10);const h=o.getImageData(0,0,10,10).data;let c=!1;for(let m=3;m<h.length;m+=4)if(h[m]>0&&h[m]<255){c=!0;break}return(0,i.shadow)(this,"isFontSubpixelAAEnabled",c)}showText(o){const h=this.current,c=h.font;if(c.isType3Font)return this.showType3Text(o);const m=h.fontSize;if(m===0)return;const k=this.ctx,it=h.fontSizeScale,gt=h.charSpacing,vt=h.wordSpacing,Nt=h.fontDirection,Lt=h.textHScale*Nt,jt=o.length,zt=c.vertical,Yt=zt?1:-1,Gt=c.defaultVMetrics,le=m*h.fontMatrix[0],ge=h.textRenderingMode===i.TextRenderingMode.FILL&&!c.disableFontFace&&!h.patternFill;k.save(),k.transform(...h.textMatrix),k.translate(h.x,h.y+h.textRise),Nt>0?k.scale(Lt,-1):k.scale(Lt,1);let ne;if(h.patternFill){k.save();const Xt=h.fillColor.getPattern(k,this,(0,b.getCurrentTransformInverse)(k),St.PathType.FILL);ne=(0,b.getCurrentTransform)(k),k.restore(),k.fillStyle=Xt}let pe=h.lineWidth;const Kt=h.textMatrixScale;if(Kt===0||pe===0){const Xt=h.textRenderingMode&i.TextRenderingMode.FILL_STROKE_MASK;(Xt===i.TextRenderingMode.STROKE||Xt===i.TextRenderingMode.FILL_STROKE)&&(pe=this.getSinglePixelWidth())}else pe/=Kt;if(it!==1&&(k.scale(it,it),pe/=it),k.lineWidth=pe,c.isInvalidPDFjsFont){const Xt=[];let ae=0;for(const oe of o)Xt.push(oe.unicode),ae+=oe.width;k.fillText(Xt.join(""),0,0),h.x+=ae*le*Lt,k.restore(),this.compose();return}let Ot=0,It;for(It=0;It<jt;++It){const Xt=o[It];if(typeof Xt=="number"){Ot+=Yt*Xt*m/1e3;continue}let ae=!1;const oe=(Xt.isSpace?vt:0)+gt,Ae=Xt.fontChar,Pe=Xt.accent;let ve,we,Te=Xt.width;if(zt){const Ce=Xt.vmetric||Gt,qt=-(Xt.vmetric?Ce[1]:Te*.5)*le,Dt=Ce[2]*le;Te=Ce?-Ce[0]:Te,ve=qt/it,we=(Ot+Dt)/it}else ve=Ot/it,we=0;if(c.remeasure&&Te>0){const Ce=k.measureText(Ae).width*1e3/m*it;if(Te<Ce&&this.isFontSubpixelAAEnabled){const qt=Te/Ce;ae=!0,k.save(),k.scale(qt,1),ve/=qt}else Te!==Ce&&(ve+=(Te-Ce)/2e3*m/it)}if(this.contentVisible&&(Xt.isInFont||c.missingFile)){if(ge&&!Pe)k.fillText(Ae,ve,we);else if(this.paintChar(Ae,ve,we,ne),Pe){const Ce=ve+m*Pe.offset.x/it,qt=we-m*Pe.offset.y/it;this.paintChar(Pe.fontChar,Ce,qt,ne)}}const Ee=zt?Te*le-oe*Nt:Te*le+oe*Nt;Ot+=Ee,ae&&k.restore()}zt?h.y-=Ot:h.x+=Ot*Lt,k.restore(),this.compose()}showType3Text(o){const h=this.ctx,c=this.current,m=c.font,k=c.fontSize,it=c.fontDirection,gt=m.vertical?1:-1,vt=c.charSpacing,Nt=c.wordSpacing,Lt=c.textHScale*it,jt=c.fontMatrix||i.FONT_IDENTITY_MATRIX,zt=o.length,Yt=c.textRenderingMode===i.TextRenderingMode.INVISIBLE;let Gt,le,ge,ne;if(!(Yt||k===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,h.save(),h.transform(...c.textMatrix),h.translate(c.x,c.y),h.scale(Lt,it),Gt=0;Gt<zt;++Gt){if(le=o[Gt],typeof le=="number"){ne=gt*le*k/1e3,this.ctx.translate(ne,0),c.x+=ne*Lt;continue}const pe=(le.isSpace?Nt:0)+vt,Kt=m.charProcOperatorList[le.operatorListId];if(!Kt){(0,i.warn)(`Type3 character "${le.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=le,this.save(),h.scale(k,k),h.transform(...jt),this.executeOperatorList(Kt),this.restore()),ge=i.Util.applyTransform([le.width,0],jt)[0]*k+pe,h.translate(ge,0),c.x+=ge*Lt}h.restore(),this.processingType3=null}}setCharWidth(o,h){}setCharWidthAndBounds(o,h,c,m,k,it){this.ctx.rect(c,m,k-c,it-m),this.ctx.clip(),this.endPath()}getColorN_Pattern(o){let h;if(o[0]==="TilingPattern"){const c=o[1],m=this.baseTransform||(0,b.getCurrentTransform)(this.ctx),k={createCanvasGraphics:it=>new re(it,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};h=new St.TilingPattern(o,c,this.ctx,k,m)}else h=this._getPattern(o[1],o[2]);return h}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(o,h,c){const m=i.Util.makeHexColor(o,h,c);this.ctx.strokeStyle=m,this.current.strokeColor=m}setFillRGBColor(o,h,c){const m=i.Util.makeHexColor(o,h,c);this.ctx.fillStyle=m,this.current.fillColor=m,this.current.patternFill=!1}_getPattern(o,h=null){let c;return this.cachedPatterns.has(o)?c=this.cachedPatterns.get(o):(c=(0,St.getShadingPattern)(this.getObject(o)),this.cachedPatterns.set(o,c)),h&&(c.matrix=h),c}shadingFill(o){if(!this.contentVisible)return;const h=this.ctx;this.save();const c=this._getPattern(o);h.fillStyle=c.getPattern(h,this,(0,b.getCurrentTransformInverse)(h),St.PathType.SHADING);const m=(0,b.getCurrentTransformInverse)(h);if(m){const{width:k,height:it}=h.canvas,[gt,vt,Nt,Lt]=i.Util.getAxialAlignedBoundingBox([0,0,k,it],m);this.ctx.fillRect(gt,vt,Nt-gt,Lt-vt)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,i.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,i.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(o,h){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(o)&&o.length===6&&this.transform(...o),this.baseTransform=(0,b.getCurrentTransform)(this.ctx),h)){const c=h[2]-h[0],m=h[3]-h[1];this.ctx.rect(h[0],h[1],c,m),this.current.updateRectMinMax((0,b.getCurrentTransform)(this.ctx),h),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(o){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const h=this.ctx;o.isolated||(0,i.info)("TODO: Support non-isolated groups."),o.knockout&&(0,i.warn)("Knockout groups not supported.");const c=(0,b.getCurrentTransform)(h);if(o.matrix&&h.transform(...o.matrix),!o.bbox)throw new Error("Bounding box is required.");let m=i.Util.getAxialAlignedBoundingBox(o.bbox,(0,b.getCurrentTransform)(h));const k=[0,0,h.canvas.width,h.canvas.height];m=i.Util.intersect(m,k)||[0,0,0,0];const it=Math.floor(m[0]),gt=Math.floor(m[1]);let vt=Math.max(Math.ceil(m[2])-it,1),Nt=Math.max(Math.ceil(m[3])-gt,1),Lt=1,jt=1;vt>rt&&(Lt=vt/rt,vt=rt),Nt>rt&&(jt=Nt/rt,Nt=rt),this.current.startNewPathAndClipBox([0,0,vt,Nt]);let zt="groupAt"+this.groupLevel;o.smask&&(zt+="_smask_"+this.smaskCounter++%2);const Yt=this.cachedCanvases.getCanvas(zt,vt,Nt),Gt=Yt.context;Gt.scale(1/Lt,1/jt),Gt.translate(-it,-gt),Gt.transform(...c),o.smask?this.smaskStack.push({canvas:Yt.canvas,context:Gt,offsetX:it,offsetY:gt,scaleX:Lt,scaleY:jt,subtype:o.smask.subtype,backdrop:o.smask.backdrop,transferMap:o.smask.transferMap||null,startTransformInverse:null}):(h.setTransform(1,0,0,1,0,0),h.translate(it,gt),h.scale(Lt,jt),h.save()),f(h,Gt),this.ctx=Gt,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(h),this.groupLevel++}endGroup(o){if(!this.contentVisible)return;this.groupLevel--;const h=this.ctx,c=this.groupStack.pop();if(this.ctx=c,this.ctx.imageSmoothingEnabled=!1,o.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const m=(0,b.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...m);const k=i.Util.getAxialAlignedBoundingBox([0,0,h.canvas.width,h.canvas.height],m);this.ctx.drawImage(h.canvas,0,0),this.ctx.restore(),this.compose(k)}}beginAnnotation(o,h,c,m,k){if(xt(this,Pt,Ln).call(this),_(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(h)&&h.length===4){const it=h[2]-h[0],gt=h[3]-h[1];if(k&&this.annotationCanvasMap){c=c.slice(),c[4]-=h[0],c[5]-=h[1],h=h.slice(),h[0]=h[1]=0,h[2]=it,h[3]=gt;const[vt,Nt]=i.Util.singularValueDecompose2dScale((0,b.getCurrentTransform)(this.ctx)),{viewportScale:Lt}=this,jt=Math.ceil(it*this.outputScaleX*Lt),zt=Math.ceil(gt*this.outputScaleY*Lt);this.annotationCanvas=this.canvasFactory.create(jt,zt);const{canvas:Yt,context:Gt}=this.annotationCanvas;this.annotationCanvasMap.set(o,Yt),this.annotationCanvas.savedCtx=this.ctx,this.ctx=Gt,this.ctx.save(),this.ctx.setTransform(vt,0,0,-Nt,0,gt*Nt),_(this.ctx)}else _(this.ctx),this.ctx.rect(h[0],h[1],it,gt),this.ctx.clip(),this.endPath()}this.current=new ct(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...c),this.transform(...m)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),xt(this,Jt,On).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(o){if(!this.contentVisible)return;const h=o.count;o=this.getObject(o.data,o),o.count=h;const c=this.ctx,m=this.processingType3;if(m&&(m.compiled===void 0&&(m.compiled=tt(o)),m.compiled)){m.compiled(c);return}const k=this._createMaskCanvas(o),it=k.canvas;c.save(),c.setTransform(1,0,0,1,0,0),c.drawImage(it,k.offsetX,k.offsetY),c.restore(),this.compose()}paintImageMaskXObjectRepeat(o,h,c=0,m=0,k,it){if(!this.contentVisible)return;o=this.getObject(o.data,o);const gt=this.ctx;gt.save();const vt=(0,b.getCurrentTransform)(gt);gt.transform(h,c,m,k,0,0);const Nt=this._createMaskCanvas(o);gt.setTransform(1,0,0,1,Nt.offsetX-vt[4],Nt.offsetY-vt[5]);for(let Lt=0,jt=it.length;Lt<jt;Lt+=2){const zt=i.Util.transform(vt,[h,c,m,k,it[Lt],it[Lt+1]]),[Yt,Gt]=i.Util.applyTransform([0,0],zt);gt.drawImage(Nt.canvas,Yt,Gt)}gt.restore(),this.compose()}paintImageMaskXObjectGroup(o){if(!this.contentVisible)return;const h=this.ctx,c=this.current.fillColor,m=this.current.patternFill;for(const k of o){const{data:it,width:gt,height:vt,transform:Nt}=k,Lt=this.cachedCanvases.getCanvas("maskCanvas",gt,vt),jt=Lt.context;jt.save();const zt=this.getObject(it,k);et(jt,zt),jt.globalCompositeOperation="source-in",jt.fillStyle=m?c.getPattern(jt,this,(0,b.getCurrentTransformInverse)(h),St.PathType.FILL):c,jt.fillRect(0,0,gt,vt),jt.restore(),h.save(),h.transform(...Nt),h.scale(1,-1),j(h,Lt.canvas,0,0,gt,vt,0,-1,1,1),h.restore()}this.compose()}paintImageXObject(o){if(!this.contentVisible)return;const h=this.getObject(o);if(!h){(0,i.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(h)}paintImageXObjectRepeat(o,h,c,m){if(!this.contentVisible)return;const k=this.getObject(o);if(!k){(0,i.warn)("Dependent image isn't ready yet");return}const it=k.width,gt=k.height,vt=[];for(let Nt=0,Lt=m.length;Nt<Lt;Nt+=2)vt.push({transform:[h,0,0,c,m[Nt],m[Nt+1]],x:0,y:0,w:it,h:gt});this.paintInlineImageXObjectGroup(k,vt)}applyTransferMapsToCanvas(o){return this.current.transferMaps!=="none"&&(o.filter=this.current.transferMaps,o.drawImage(o.canvas,0,0),o.filter="none"),o.canvas}applyTransferMapsToBitmap(o){if(this.current.transferMaps==="none")return o.bitmap;const{bitmap:h,width:c,height:m}=o,k=this.cachedCanvases.getCanvas("inlineImage",c,m),it=k.context;return it.filter=this.current.transferMaps,it.drawImage(h,0,0),it.filter="none",k.canvas}paintInlineImageXObject(o){if(!this.contentVisible)return;const h=o.width,c=o.height,m=this.ctx;if(this.save(),!i.isNodeJS){const{filter:gt}=m;gt!=="none"&&gt!==""&&(m.filter="none")}m.scale(1/h,-1/c);let k;if(o.bitmap)k=this.applyTransferMapsToBitmap(o);else if(typeof HTMLElement=="function"&&o instanceof HTMLElement||!o.data)k=o;else{const vt=this.cachedCanvases.getCanvas("inlineImage",h,c).context;lt(vt,o),k=this.applyTransferMapsToCanvas(vt)}const it=this._scaleImage(k,(0,b.getCurrentTransformInverse)(m));m.imageSmoothingEnabled=Tt((0,b.getCurrentTransform)(m),o.interpolate),j(m,it.img,0,0,it.paintWidth,it.paintHeight,0,-c,h,c),this.compose(),this.restore()}paintInlineImageXObjectGroup(o,h){if(!this.contentVisible)return;const c=this.ctx;let m;if(o.bitmap)m=o.bitmap;else{const k=o.width,it=o.height,vt=this.cachedCanvases.getCanvas("inlineImage",k,it).context;lt(vt,o),m=this.applyTransferMapsToCanvas(vt)}for(const k of h)c.save(),c.transform(...k.transform),c.scale(1,-1),j(c,m,k.x,k.y,k.w,k.h,0,-1,1,1),c.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(o){}markPointProps(o,h){}beginMarkedContent(o){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(o,h){o==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(h)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(o){const h=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(o);const c=this.ctx;this.pendingClip&&(h||(this.pendingClip===Bt?c.clip("evenodd"):c.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),c.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const o=(0,b.getCurrentTransform)(this.ctx);if(o[1]===0&&o[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(o[0]),Math.abs(o[3]));else{const h=Math.abs(o[0]*o[3]-o[2]*o[1]),c=Math.hypot(o[0],o[2]),m=Math.hypot(o[1],o[3]);this._cachedGetSinglePixelWidth=Math.max(c,m)/h}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:o}=this.current,{a:h,b:c,c:m,d:k}=this.ctx.getTransform();let it,gt;if(c===0&&m===0){const vt=Math.abs(h),Nt=Math.abs(k);if(vt===Nt)if(o===0)it=gt=1/vt;else{const Lt=vt*o;it=gt=Lt<1?1/Lt:1}else if(o===0)it=1/vt,gt=1/Nt;else{const Lt=vt*o,jt=Nt*o;it=Lt<1?1/Lt:1,gt=jt<1?1/jt:1}}else{const vt=Math.abs(h*k-c*m),Nt=Math.hypot(h,c),Lt=Math.hypot(m,k);if(o===0)it=Lt/vt,gt=Nt/vt;else{const jt=o*vt;it=Lt>jt?Lt/jt:1,gt=Nt>jt?Nt/jt:1}}this._cachedScaleForStroking[0]=it,this._cachedScaleForStroking[1]=gt}return this._cachedScaleForStroking}rescaleAndStroke(o){const{ctx:h}=this,{lineWidth:c}=this.current,[m,k]=this.getScaleForStroking();if(h.lineWidth=c||1,m===1&&k===1){h.stroke();return}const it=h.getLineDash();if(o&&h.save(),h.scale(m,k),it.length>0){const gt=Math.max(m,k);h.setLineDash(it.map(vt=>vt/gt)),h.lineDashOffset/=gt}h.stroke(),o&&h.restore()}isContentVisible(){for(let o=this.markedContentStack.length-1;o>=0;o--)if(!this.markedContentStack[o].visible)return!1;return!0}};Pt=new WeakSet,Ln=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},Jt=new WeakSet,On=function(){if(this.pageColors){const o=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(o!=="none"){const h=this.ctx.filter;this.ctx.filter=o,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=h}}};let $t=re;e.CanvasGraphics=$t;for(const ut in i.OPS)$t.prototype[ut]!==void 0&&($t.prototype[i.OPS[ut]]=$t.prototype[ut])},(d,e,ot)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TilingPattern=e.PathType=void 0,e.getShadingPattern=dt;var i=ot(1),b=ot(6);const St={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};e.PathType=St;function bt(tt,ct){if(!ct)return;const lt=ct[2]-ct[0],et=ct[3]-ct[1],f=new Path2D;f.rect(ct[0],ct[1],lt,et),tt.clip(f)}class Wt{constructor(){this.constructor===Wt&&(0,i.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,i.unreachable)("Abstract method `getPattern` called.")}}class ht extends Wt{constructor(ct){super(),this._type=ct[1],this._bbox=ct[2],this._colorStops=ct[3],this._p0=ct[4],this._p1=ct[5],this._r0=ct[6],this._r1=ct[7],this.matrix=null}_createGradient(ct){let lt;this._type==="axial"?lt=ct.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(lt=ct.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const et of this._colorStops)lt.addColorStop(et[0],et[1]);return lt}getPattern(ct,lt,et,f){let _;if(f===St.STROKE||f===St.FILL){const pt=lt.current.getClippedPathBoundingBox(f,(0,b.getCurrentTransform)(ct))||[0,0,0,0],Y=Math.ceil(pt[2]-pt[0])||1,g=Math.ceil(pt[3]-pt[1])||1,ft=lt.cachedCanvases.getCanvas("pattern",Y,g,!0),$=ft.context;$.clearRect(0,0,$.canvas.width,$.canvas.height),$.beginPath(),$.rect(0,0,$.canvas.width,$.canvas.height),$.translate(-pt[0],-pt[1]),et=i.Util.transform(et,[1,0,0,1,pt[0],pt[1]]),$.transform(...lt.baseTransform),this.matrix&&$.transform(...this.matrix),bt($,this._bbox),$.fillStyle=this._createGradient($),$.fill(),_=ct.createPattern(ft.canvas,"no-repeat");const Tt=new DOMMatrix(et);_.setTransform(Tt)}else bt(ct,this._bbox),_=this._createGradient(ct);return _}}function rt(tt,ct,lt,et,f,_,pt,Y){const g=ct.coords,ft=ct.colors,$=tt.data,Tt=tt.width*4;let wt;g[lt+1]>g[et+1]&&(wt=lt,lt=et,et=wt,wt=_,_=pt,pt=wt),g[et+1]>g[f+1]&&(wt=et,et=f,f=wt,wt=pt,pt=Y,Y=wt),g[lt+1]>g[et+1]&&(wt=lt,lt=et,et=wt,wt=_,_=pt,pt=wt);const at=(g[lt]+ct.offsetX)*ct.scaleX,Rt=(g[lt+1]+ct.offsetY)*ct.scaleY,Bt=(g[et]+ct.offsetX)*ct.scaleX,$t=(g[et+1]+ct.offsetY)*ct.scaleY,Pt=(g[f]+ct.offsetX)*ct.scaleX,Vt=(g[f+1]+ct.offsetY)*ct.scaleY;if(Rt>=Vt)return;const Jt=ft[_],se=ft[_+1],re=ft[_+2],ut=ft[pt],o=ft[pt+1],h=ft[pt+2],c=ft[Y],m=ft[Y+1],k=ft[Y+2],it=Math.round(Rt),gt=Math.round(Vt);let vt,Nt,Lt,jt,zt,Yt,Gt,le;for(let ge=it;ge<=gt;ge++){if(ge<$t){const It=ge<Rt?0:(Rt-ge)/(Rt-$t);vt=at-(at-Bt)*It,Nt=Jt-(Jt-ut)*It,Lt=se-(se-o)*It,jt=re-(re-h)*It}else{let It;ge>Vt?It=1:$t===Vt?It=0:It=($t-ge)/($t-Vt),vt=Bt-(Bt-Pt)*It,Nt=ut-(ut-c)*It,Lt=o-(o-m)*It,jt=h-(h-k)*It}let ne;ge<Rt?ne=0:ge>Vt?ne=1:ne=(Rt-ge)/(Rt-Vt),zt=at-(at-Pt)*ne,Yt=Jt-(Jt-c)*ne,Gt=se-(se-m)*ne,le=re-(re-k)*ne;const pe=Math.round(Math.min(vt,zt)),Kt=Math.round(Math.max(vt,zt));let Ot=Tt*ge+pe*4;for(let It=pe;It<=Kt;It++)ne=(vt-It)/(vt-zt),ne<0?ne=0:ne>1&&(ne=1),$[Ot++]=Nt-(Nt-Yt)*ne|0,$[Ot++]=Lt-(Lt-Gt)*ne|0,$[Ot++]=jt-(jt-le)*ne|0,$[Ot++]=255}}function X(tt,ct,lt){const et=ct.coords,f=ct.colors;let _,pt;switch(ct.type){case"lattice":const Y=ct.verticesPerRow,g=Math.floor(et.length/Y)-1,ft=Y-1;for(_=0;_<g;_++){let $=_*Y;for(let Tt=0;Tt<ft;Tt++,$++)rt(tt,lt,et[$],et[$+1],et[$+Y],f[$],f[$+1],f[$+Y]),rt(tt,lt,et[$+Y+1],et[$+1],et[$+Y],f[$+Y+1],f[$+1],f[$+Y])}break;case"triangles":for(_=0,pt=et.length;_<pt;_+=3)rt(tt,lt,et[_],et[_+1],et[_+2],f[_],f[_+1],f[_+2]);break;default:throw new Error("illegal figure")}}class mt extends Wt{constructor(ct){super(),this._coords=ct[2],this._colors=ct[3],this._figures=ct[4],this._bounds=ct[5],this._bbox=ct[7],this._background=ct[8],this.matrix=null}_createMeshCanvas(ct,lt,et){const Y=Math.floor(this._bounds[0]),g=Math.floor(this._bounds[1]),ft=Math.ceil(this._bounds[2])-Y,$=Math.ceil(this._bounds[3])-g,Tt=Math.min(Math.ceil(Math.abs(ft*ct[0]*1.1)),3e3),wt=Math.min(Math.ceil(Math.abs($*ct[1]*1.1)),3e3),at=ft/Tt,Rt=$/wt,Bt={coords:this._coords,colors:this._colors,offsetX:-Y,offsetY:-g,scaleX:1/at,scaleY:1/Rt},$t=Tt+2*2,Pt=wt+2*2,Vt=et.getCanvas("mesh",$t,Pt,!1),Jt=Vt.context,se=Jt.createImageData(Tt,wt);if(lt){const ut=se.data;for(let o=0,h=ut.length;o<h;o+=4)ut[o]=lt[0],ut[o+1]=lt[1],ut[o+2]=lt[2],ut[o+3]=255}for(const ut of this._figures)X(se,ut,Bt);return Jt.putImageData(se,2,2),{canvas:Vt.canvas,offsetX:Y-2*at,offsetY:g-2*Rt,scaleX:at,scaleY:Rt}}getPattern(ct,lt,et,f){bt(ct,this._bbox);let _;if(f===St.SHADING)_=i.Util.singularValueDecompose2dScale((0,b.getCurrentTransform)(ct));else if(_=i.Util.singularValueDecompose2dScale(lt.baseTransform),this.matrix){const Y=i.Util.singularValueDecompose2dScale(this.matrix);_=[_[0]*Y[0],_[1]*Y[1]]}const pt=this._createMeshCanvas(_,f===St.SHADING?null:this._background,lt.cachedCanvases);return f!==St.SHADING&&(ct.setTransform(...lt.baseTransform),this.matrix&&ct.transform(...this.matrix)),ct.translate(pt.offsetX,pt.offsetY),ct.scale(pt.scaleX,pt.scaleY),ct.createPattern(pt.canvas,"no-repeat")}}class _t extends Wt{getPattern(){return"hotpink"}}function dt(tt){switch(tt[0]){case"RadialAxial":return new ht(tt);case"Mesh":return new mt(tt);case"Dummy":return new _t}throw new Error(`Unknown IR type: ${tt[0]}`)}const st={COLORED:1,UNCOLORED:2},j=class j{constructor(ct,lt,et,f,_){this.operatorList=ct[2],this.matrix=ct[3]||[1,0,0,1,0,0],this.bbox=ct[4],this.xstep=ct[5],this.ystep=ct[6],this.paintType=ct[7],this.tilingType=ct[8],this.color=lt,this.ctx=et,this.canvasGraphicsFactory=f,this.baseTransform=_}createPatternCanvas(ct){const lt=this.operatorList,et=this.bbox,f=this.xstep,_=this.ystep,pt=this.paintType,Y=this.tilingType,g=this.color,ft=this.canvasGraphicsFactory;(0,i.info)("TilingType: "+Y);const $=et[0],Tt=et[1],wt=et[2],at=et[3],Rt=i.Util.singularValueDecompose2dScale(this.matrix),Bt=i.Util.singularValueDecompose2dScale(this.baseTransform),$t=[Rt[0]*Bt[0],Rt[1]*Bt[1]],Pt=this.getSizeAndScale(f,this.ctx.canvas.width,$t[0]),Vt=this.getSizeAndScale(_,this.ctx.canvas.height,$t[1]),Jt=ct.cachedCanvases.getCanvas("pattern",Pt.size,Vt.size,!0),se=Jt.context,re=ft.createCanvasGraphics(se);re.groupLevel=ct.groupLevel,this.setFillAndStrokeStyleToContext(re,pt,g);let ut=$,o=Tt,h=wt,c=at;return $<0&&(ut=0,h+=Math.abs($)),Tt<0&&(o=0,c+=Math.abs(Tt)),se.translate(-(Pt.scale*ut),-(Vt.scale*o)),re.transform(Pt.scale,0,0,Vt.scale,0,0),se.save(),this.clipBbox(re,ut,o,h,c),re.baseTransform=(0,b.getCurrentTransform)(re.ctx),re.executeOperatorList(lt),re.endDrawing(),{canvas:Jt.canvas,scaleX:Pt.scale,scaleY:Vt.scale,offsetX:ut,offsetY:o}}getSizeAndScale(ct,lt,et){ct=Math.abs(ct);const f=Math.max(j.MAX_PATTERN_SIZE,lt);let _=Math.ceil(ct*et);return _>=f?_=f:et=_/ct,{scale:et,size:_}}clipBbox(ct,lt,et,f,_){const pt=f-lt,Y=_-et;ct.ctx.rect(lt,et,pt,Y),ct.current.updateRectMinMax((0,b.getCurrentTransform)(ct.ctx),[lt,et,f,_]),ct.clip(),ct.endPath()}setFillAndStrokeStyleToContext(ct,lt,et){const f=ct.ctx,_=ct.current;switch(lt){case st.COLORED:const pt=this.ctx;f.fillStyle=pt.fillStyle,f.strokeStyle=pt.strokeStyle,_.fillColor=pt.fillStyle,_.strokeColor=pt.strokeStyle;break;case st.UNCOLORED:const Y=i.Util.makeHexColor(et[0],et[1],et[2]);f.fillStyle=Y,f.strokeStyle=Y,_.fillColor=Y,_.strokeColor=Y;break;default:throw new i.FormatError(`Unsupported paint type: ${lt}`)}}getPattern(ct,lt,et,f){let _=et;f!==St.SHADING&&(_=i.Util.transform(_,lt.baseTransform),this.matrix&&(_=i.Util.transform(_,this.matrix)));const pt=this.createPatternCanvas(lt);let Y=new DOMMatrix(_);Y=Y.translate(pt.offsetX,pt.offsetY),Y=Y.scale(1/pt.scaleX,1/pt.scaleY);const g=ct.createPattern(pt.canvas,"repeat");return g.setTransform(Y),g}};Ie(j,"MAX_PATTERN_SIZE",3e3);let nt=j;e.TilingPattern=nt},(d,e,ot)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.convertBlackAndWhiteToRGBA=St,e.convertToRGBA=b,e.grayToRGBA=Wt;var i=ot(1);function b(ht){switch(ht.kind){case i.ImageKind.GRAYSCALE_1BPP:return St(ht);case i.ImageKind.RGB_24BPP:return bt(ht)}return null}function St({src:ht,srcPos:rt=0,dest:X,width:mt,height:_t,nonBlackColor:dt=4294967295,inverseDecode:st=!1}){const nt=i.FeatureTest.isLittleEndian?4278190080:255,[j,tt]=st?[dt,nt]:[nt,dt],ct=mt>>3,lt=mt&7,et=ht.length;X=new Uint32Array(X.buffer);let f=0;for(let _=0;_<_t;_++){for(const Y=rt+ct;rt<Y;rt++){const g=rt<et?ht[rt]:255;X[f++]=g&128?tt:j,X[f++]=g&64?tt:j,X[f++]=g&32?tt:j,X[f++]=g&16?tt:j,X[f++]=g&8?tt:j,X[f++]=g&4?tt:j,X[f++]=g&2?tt:j,X[f++]=g&1?tt:j}if(lt===0)continue;const pt=rt<et?ht[rt++]:255;for(let Y=0;Y<lt;Y++)X[f++]=pt&1<<7-Y?tt:j}return{srcPos:rt,destPos:f}}function bt({src:ht,srcPos:rt=0,dest:X,destPos:mt=0,width:_t,height:dt}){let st=0;const nt=ht.length>>2,j=new Uint32Array(ht.buffer,rt,nt);if(i.FeatureTest.isLittleEndian){for(;st<nt-2;st+=3,mt+=4){const tt=j[st],ct=j[st+1],lt=j[st+2];X[mt]=tt|4278190080,X[mt+1]=tt>>>24|ct<<8|4278190080,X[mt+2]=ct>>>16|lt<<16|4278190080,X[mt+3]=lt>>>8|4278190080}for(let tt=st*4,ct=ht.length;tt<ct;tt+=3)X[mt++]=ht[tt]|ht[tt+1]<<8|ht[tt+2]<<16|4278190080}else{for(;st<nt-2;st+=3,mt+=4){const tt=j[st],ct=j[st+1],lt=j[st+2];X[mt]=tt|255,X[mt+1]=tt<<24|ct>>>8|255,X[mt+2]=ct<<16|lt>>>16|255,X[mt+3]=lt<<8|255}for(let tt=st*4,ct=ht.length;tt<ct;tt+=3)X[mt++]=ht[tt]<<24|ht[tt+1]<<16|ht[tt+2]<<8|255}return{srcPos:rt,destPos:mt}}function Wt(ht,rt){if(i.FeatureTest.isLittleEndian)for(let X=0,mt=ht.length;X<mt;X++)rt[X]=ht[X]*65793|4278190080;else for(let X=0,mt=ht.length;X<mt;X++)rt[X]=ht[X]*16843008|255}},(d,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.GlobalWorkerOptions=void 0;const ot=Object.create(null);e.GlobalWorkerOptions=ot,ot.workerPort=null,ot.workerSrc=""},(d,e,ot)=>{var ht,hs,X,us,_t,hn;Object.defineProperty(e,"__esModule",{value:!0}),e.MessageHandler=void 0;var i=ot(1);const b={UNKNOWN:0,DATA:1,ERROR:2},St={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function bt(st){switch(st instanceof Error||typeof st=="object"&&st!==null||(0,i.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),st.name){case"AbortException":return new i.AbortException(st.message);case"MissingPDFException":return new i.MissingPDFException(st.message);case"PasswordException":return new i.PasswordException(st.message,st.code);case"UnexpectedResponseException":return new i.UnexpectedResponseException(st.message,st.status);case"UnknownErrorException":return new i.UnknownErrorException(st.message,st.details);default:return new i.UnknownErrorException(st.message,st.toString())}}class Wt{constructor(nt,j,tt){Et(this,ht);Et(this,X);Et(this,_t);this.sourceName=nt,this.targetName=j,this.comObj=tt,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=ct=>{const lt=ct.data;if(lt.targetName!==this.sourceName)return;if(lt.stream){xt(this,X,us).call(this,lt);return}if(lt.callback){const f=lt.callbackId,_=this.callbackCapabilities[f];if(!_)throw new Error(`Cannot resolve callback ${f}`);if(delete this.callbackCapabilities[f],lt.callback===b.DATA)_.resolve(lt.data);else if(lt.callback===b.ERROR)_.reject(bt(lt.reason));else throw new Error("Unexpected callback case");return}const et=this.actionHandler[lt.action];if(!et)throw new Error(`Unknown action from worker: ${lt.action}`);if(lt.callbackId){const f=this.sourceName,_=lt.sourceName;new Promise(function(pt){pt(et(lt.data))}).then(function(pt){tt.postMessage({sourceName:f,targetName:_,callback:b.DATA,callbackId:lt.callbackId,data:pt})},function(pt){tt.postMessage({sourceName:f,targetName:_,callback:b.ERROR,callbackId:lt.callbackId,reason:bt(pt)})});return}if(lt.streamId){xt(this,ht,hs).call(this,lt);return}et(lt.data)},tt.addEventListener("message",this._onComObjOnMessage)}on(nt,j){const tt=this.actionHandler;if(tt[nt])throw new Error(`There is already an actionName called "${nt}"`);tt[nt]=j}send(nt,j,tt){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:nt,data:j},tt)}sendWithPromise(nt,j,tt){const ct=this.callbackId++,lt=new i.PromiseCapability;this.callbackCapabilities[ct]=lt;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:nt,callbackId:ct,data:j},tt)}catch(et){lt.reject(et)}return lt.promise}sendWithStream(nt,j,tt,ct){const lt=this.streamId++,et=this.sourceName,f=this.targetName,_=this.comObj;return new ReadableStream({start:pt=>{const Y=new i.PromiseCapability;return this.streamControllers[lt]={controller:pt,startCall:Y,pullCall:null,cancelCall:null,isClosed:!1},_.postMessage({sourceName:et,targetName:f,action:nt,streamId:lt,data:j,desiredSize:pt.desiredSize},ct),Y.promise},pull:pt=>{const Y=new i.PromiseCapability;return this.streamControllers[lt].pullCall=Y,_.postMessage({sourceName:et,targetName:f,stream:St.PULL,streamId:lt,desiredSize:pt.desiredSize}),Y.promise},cancel:pt=>{(0,i.assert)(pt instanceof Error,"cancel must have a valid reason");const Y=new i.PromiseCapability;return this.streamControllers[lt].cancelCall=Y,this.streamControllers[lt].isClosed=!0,_.postMessage({sourceName:et,targetName:f,stream:St.CANCEL,streamId:lt,reason:bt(pt)}),Y.promise}},tt)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}ht=new WeakSet,hs=function(nt){const j=nt.streamId,tt=this.sourceName,ct=nt.sourceName,lt=this.comObj,et=this,f=this.actionHandler[nt.action],_={enqueue(pt,Y=1,g){if(this.isCancelled)return;const ft=this.desiredSize;this.desiredSize-=Y,ft>0&&this.desiredSize<=0&&(this.sinkCapability=new i.PromiseCapability,this.ready=this.sinkCapability.promise),lt.postMessage({sourceName:tt,targetName:ct,stream:St.ENQUEUE,streamId:j,chunk:pt},g)},close(){this.isCancelled||(this.isCancelled=!0,lt.postMessage({sourceName:tt,targetName:ct,stream:St.CLOSE,streamId:j}),delete et.streamSinks[j])},error(pt){(0,i.assert)(pt instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,lt.postMessage({sourceName:tt,targetName:ct,stream:St.ERROR,streamId:j,reason:bt(pt)}))},sinkCapability:new i.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:nt.desiredSize,ready:null};_.sinkCapability.resolve(),_.ready=_.sinkCapability.promise,this.streamSinks[j]=_,new Promise(function(pt){pt(f(nt.data,_))}).then(function(){lt.postMessage({sourceName:tt,targetName:ct,stream:St.START_COMPLETE,streamId:j,success:!0})},function(pt){lt.postMessage({sourceName:tt,targetName:ct,stream:St.START_COMPLETE,streamId:j,reason:bt(pt)})})},X=new WeakSet,us=function(nt){const j=nt.streamId,tt=this.sourceName,ct=nt.sourceName,lt=this.comObj,et=this.streamControllers[j],f=this.streamSinks[j];switch(nt.stream){case St.START_COMPLETE:nt.success?et.startCall.resolve():et.startCall.reject(bt(nt.reason));break;case St.PULL_COMPLETE:nt.success?et.pullCall.resolve():et.pullCall.reject(bt(nt.reason));break;case St.PULL:if(!f){lt.postMessage({sourceName:tt,targetName:ct,stream:St.PULL_COMPLETE,streamId:j,success:!0});break}f.desiredSize<=0&&nt.desiredSize>0&&f.sinkCapability.resolve(),f.desiredSize=nt.desiredSize,new Promise(function(_){var pt;_((pt=f.onPull)==null?void 0:pt.call(f))}).then(function(){lt.postMessage({sourceName:tt,targetName:ct,stream:St.PULL_COMPLETE,streamId:j,success:!0})},function(_){lt.postMessage({sourceName:tt,targetName:ct,stream:St.PULL_COMPLETE,streamId:j,reason:bt(_)})});break;case St.ENQUEUE:if((0,i.assert)(et,"enqueue should have stream controller"),et.isClosed)break;et.controller.enqueue(nt.chunk);break;case St.CLOSE:if((0,i.assert)(et,"close should have stream controller"),et.isClosed)break;et.isClosed=!0,et.controller.close(),xt(this,_t,hn).call(this,et,j);break;case St.ERROR:(0,i.assert)(et,"error should have stream controller"),et.controller.error(bt(nt.reason)),xt(this,_t,hn).call(this,et,j);break;case St.CANCEL_COMPLETE:nt.success?et.cancelCall.resolve():et.cancelCall.reject(bt(nt.reason)),xt(this,_t,hn).call(this,et,j);break;case St.CANCEL:if(!f)break;new Promise(function(_){var pt;_((pt=f.onCancel)==null?void 0:pt.call(f,bt(nt.reason)))}).then(function(){lt.postMessage({sourceName:tt,targetName:ct,stream:St.CANCEL_COMPLETE,streamId:j,success:!0})},function(_){lt.postMessage({sourceName:tt,targetName:ct,stream:St.CANCEL_COMPLETE,streamId:j,reason:bt(_)})}),f.sinkCapability.reject(bt(nt.reason)),f.isCancelled=!0,delete this.streamSinks[j];break;default:throw new Error("Unexpected stream case")}},_t=new WeakSet,hn=async function(nt,j){var tt,ct,lt;await Promise.allSettled([(tt=nt.startCall)==null?void 0:tt.promise,(ct=nt.pullCall)==null?void 0:ct.promise,(lt=nt.cancelCall)==null?void 0:lt.promise]),delete this.streamControllers[j]},e.MessageHandler=Wt},(d,e,ot)=>{var St,bt;Object.defineProperty(e,"__esModule",{value:!0}),e.Metadata=void 0;var i=ot(1);class b{constructor({parsedData:ht,rawData:rt}){Et(this,St,void 0);Et(this,bt,void 0);Ut(this,St,ht),Ut(this,bt,rt)}getRaw(){return s(this,bt)}get(ht){return s(this,St).get(ht)??null}getAll(){return(0,i.objectFromMap)(s(this,St))}has(ht){return s(this,St).has(ht)}}St=new WeakMap,bt=new WeakMap,e.Metadata=b},(d,e,ot)=>{var ht,rt,X,mt,_t,dt,In;Object.defineProperty(e,"__esModule",{value:!0}),e.OptionalContentConfig=void 0;var i=ot(1),b=ot(8);const St=Symbol("INTERNAL");class bt{constructor(j,tt){Et(this,ht,!0);this.name=j,this.intent=tt}get visible(){return s(this,ht)}_setVisible(j,tt){j!==St&&(0,i.unreachable)("Internal method `_setVisible` called."),Ut(this,ht,tt)}}ht=new WeakMap;class Wt{constructor(j){Et(this,dt);Et(this,rt,null);Et(this,X,new Map);Et(this,mt,null);Et(this,_t,null);if(this.name=null,this.creator=null,j!==null){this.name=j.name,this.creator=j.creator,Ut(this,_t,j.order);for(const tt of j.groups)s(this,X).set(tt.id,new bt(tt.name,tt.intent));if(j.baseState==="OFF")for(const tt of s(this,X).values())tt._setVisible(St,!1);for(const tt of j.on)s(this,X).get(tt)._setVisible(St,!0);for(const tt of j.off)s(this,X).get(tt)._setVisible(St,!1);Ut(this,mt,this.getHash())}}isVisible(j){if(s(this,X).size===0)return!0;if(!j)return(0,i.warn)("Optional content group not defined."),!0;if(j.type==="OCG")return s(this,X).has(j.id)?s(this,X).get(j.id).visible:((0,i.warn)(`Optional content group not found: ${j.id}`),!0);if(j.type==="OCMD"){if(j.expression)return xt(this,dt,In).call(this,j.expression);if(!j.policy||j.policy==="AnyOn"){for(const tt of j.ids){if(!s(this,X).has(tt))return(0,i.warn)(`Optional content group not found: ${tt}`),!0;if(s(this,X).get(tt).visible)return!0}return!1}else if(j.policy==="AllOn"){for(const tt of j.ids){if(!s(this,X).has(tt))return(0,i.warn)(`Optional content group not found: ${tt}`),!0;if(!s(this,X).get(tt).visible)return!1}return!0}else if(j.policy==="AnyOff"){for(const tt of j.ids){if(!s(this,X).has(tt))return(0,i.warn)(`Optional content group not found: ${tt}`),!0;if(!s(this,X).get(tt).visible)return!0}return!1}else if(j.policy==="AllOff"){for(const tt of j.ids){if(!s(this,X).has(tt))return(0,i.warn)(`Optional content group not found: ${tt}`),!0;if(s(this,X).get(tt).visible)return!1}return!0}return(0,i.warn)(`Unknown optional content policy ${j.policy}.`),!0}return(0,i.warn)(`Unknown group type ${j.type}.`),!0}setVisibility(j,tt=!0){if(!s(this,X).has(j)){(0,i.warn)(`Optional content group not found: ${j}`);return}s(this,X).get(j)._setVisible(St,!!tt),Ut(this,rt,null)}get hasInitialVisibility(){return s(this,mt)===null||this.getHash()===s(this,mt)}getOrder(){return s(this,X).size?s(this,_t)?s(this,_t).slice():[...s(this,X).keys()]:null}getGroups(){return s(this,X).size>0?(0,i.objectFromMap)(s(this,X)):null}getGroup(j){return s(this,X).get(j)||null}getHash(){if(s(this,rt)!==null)return s(this,rt);const j=new b.MurmurHash3_64;for(const[tt,ct]of s(this,X))j.update(`${tt}:${ct.visible}`);return Ut(this,rt,j.hexdigest())}}rt=new WeakMap,X=new WeakMap,mt=new WeakMap,_t=new WeakMap,dt=new WeakSet,In=function(j){const tt=j.length;if(tt<2)return!0;const ct=j[0];for(let lt=1;lt<tt;lt++){const et=j[lt];let f;if(Array.isArray(et))f=xt(this,dt,In).call(this,et);else if(s(this,X).has(et))f=s(this,X).get(et).visible;else return(0,i.warn)(`Optional content group not found: ${et}`),!0;switch(ct){case"And":if(!f)return!1;break;case"Or":if(f)return!0;break;case"Not":return!f;default:return!0}}return ct==="And"},e.OptionalContentConfig=Wt},(d,e,ot)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFDataTransportStream=void 0;var i=ot(1),b=ot(6);class St{constructor({length:rt,initialData:X,progressiveDone:mt=!1,contentDispositionFilename:_t=null,disableRange:dt=!1,disableStream:st=!1},nt){if((0,i.assert)(nt,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=mt,this._contentDispositionFilename=_t,(X==null?void 0:X.length)>0){const j=X instanceof Uint8Array&&X.byteLength===X.buffer.byteLength?X.buffer:new Uint8Array(X).buffer;this._queuedChunks.push(j)}this._pdfDataRangeTransport=nt,this._isStreamingSupported=!st,this._isRangeSupported=!dt,this._contentLength=rt,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((j,tt)=>{this._onReceiveData({begin:j,chunk:tt})}),this._pdfDataRangeTransport.addProgressListener((j,tt)=>{this._onProgress({loaded:j,total:tt})}),this._pdfDataRangeTransport.addProgressiveReadListener(j=>{this._onReceiveData({chunk:j})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:rt,chunk:X}){const mt=X instanceof Uint8Array&&X.byteLength===X.buffer.byteLength?X.buffer:new Uint8Array(X).buffer;if(rt===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(mt):this._queuedChunks.push(mt);else{const _t=this._rangeReaders.some(function(dt){return dt._begin!==rt?!1:(dt._enqueue(mt),!0)});(0,i.assert)(_t,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var rt;return((rt=this._fullRequestReader)==null?void 0:rt._loaded)??0}_onProgress(rt){var X,mt,_t,dt;rt.total===void 0?(mt=(X=this._rangeReaders[0])==null?void 0:X.onProgress)==null||mt.call(X,{loaded:rt.loaded}):(dt=(_t=this._fullRequestReader)==null?void 0:_t.onProgress)==null||dt.call(_t,{loaded:rt.loaded,total:rt.total})}_onProgressiveDone(){var rt;(rt=this._fullRequestReader)==null||rt.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(rt){const X=this._rangeReaders.indexOf(rt);X>=0&&this._rangeReaders.splice(X,1)}getFullReader(){(0,i.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const rt=this._queuedChunks;return this._queuedChunks=null,new bt(this,rt,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(rt,X){if(X<=this._progressiveDataLength)return null;const mt=new Wt(this,rt,X);return this._pdfDataRangeTransport.requestDataRange(rt,X),this._rangeReaders.push(mt),mt}cancelAllRequests(rt){var X;(X=this._fullRequestReader)==null||X.cancel(rt);for(const mt of this._rangeReaders.slice(0))mt.cancel(rt);this._pdfDataRangeTransport.abort()}}e.PDFDataTransportStream=St;class bt{constructor(rt,X,mt=!1,_t=null){this._stream=rt,this._done=mt||!1,this._filename=(0,b.isPdfFile)(_t)?_t:null,this._queuedChunks=X||[],this._loaded=0;for(const dt of this._queuedChunks)this._loaded+=dt.byteLength;this._requests=[],this._headersReady=Promise.resolve(),rt._fullRequestReader=this,this.onProgress=null}_enqueue(rt){this._done||(this._requests.length>0?this._requests.shift().resolve({value:rt,done:!1}):this._queuedChunks.push(rt),this._loaded+=rt.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const rt=new i.PromiseCapability;return this._requests.push(rt),rt.promise}cancel(rt){this._done=!0;for(const X of this._requests)X.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class Wt{constructor(rt,X,mt){this._stream=rt,this._begin=X,this._end=mt,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(rt){if(!this._done){if(this._requests.length===0)this._queuedChunk=rt;else{this._requests.shift().resolve({value:rt,done:!1});for(const mt of this._requests)mt.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const X=this._queuedChunk;return this._queuedChunk=null,{value:X,done:!1}}if(this._done)return{value:void 0,done:!0};const rt=new i.PromiseCapability;return this._requests.push(rt),rt.promise}cancel(rt){this._done=!0;for(const X of this._requests)X.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(d,e,ot)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFFetchStream=void 0;var i=ot(1),b=ot(20);function St(mt,_t,dt){return{method:"GET",headers:mt,signal:dt.signal,mode:"cors",credentials:_t?"include":"same-origin",redirect:"follow"}}function bt(mt){const _t=new Headers;for(const dt in mt){const st=mt[dt];st!==void 0&&_t.append(dt,st)}return _t}function Wt(mt){return mt instanceof Uint8Array?mt.buffer:mt instanceof ArrayBuffer?mt:((0,i.warn)(`getArrayBuffer - unexpected data format: ${mt}`),new Uint8Array(mt).buffer)}class ht{constructor(_t){this.source=_t,this.isHttp=/^https?:/i.test(_t.url),this.httpHeaders=this.isHttp&&_t.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var _t;return((_t=this._fullRequestReader)==null?void 0:_t._loaded)??0}getFullReader(){return(0,i.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new rt(this),this._fullRequestReader}getRangeReader(_t,dt){if(dt<=this._progressiveDataLength)return null;const st=new X(this,_t,dt);return this._rangeRequestReaders.push(st),st}cancelAllRequests(_t){var dt;(dt=this._fullRequestReader)==null||dt.cancel(_t);for(const st of this._rangeRequestReaders.slice(0))st.cancel(_t)}}e.PDFFetchStream=ht;class rt{constructor(_t){this._stream=_t,this._reader=null,this._loaded=0,this._filename=null;const dt=_t.source;this._withCredentials=dt.withCredentials||!1,this._contentLength=dt.length,this._headersCapability=new i.PromiseCapability,this._disableRange=dt.disableRange||!1,this._rangeChunkSize=dt.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!dt.disableStream,this._isRangeSupported=!dt.disableRange,this._headers=bt(this._stream.httpHeaders);const st=dt.url;fetch(st,St(this._headers,this._withCredentials,this._abortController)).then(nt=>{if(!(0,b.validateResponseStatus)(nt.status))throw(0,b.createResponseStatusError)(nt.status,st);this._reader=nt.body.getReader(),this._headersCapability.resolve();const j=lt=>nt.headers.get(lt),{allowRangeRequests:tt,suggestedLength:ct}=(0,b.validateRangeRequestCapabilities)({getResponseHeader:j,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=tt,this._contentLength=ct||this._contentLength,this._filename=(0,b.extractFilenameFromHeader)(j),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new i.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var st;await this._headersCapability.promise;const{value:_t,done:dt}=await this._reader.read();return dt?{value:_t,done:dt}:(this._loaded+=_t.byteLength,(st=this.onProgress)==null||st.call(this,{loaded:this._loaded,total:this._contentLength}),{value:Wt(_t),done:!1})}cancel(_t){var dt;(dt=this._reader)==null||dt.cancel(_t),this._abortController.abort()}}class X{constructor(_t,dt,st){this._stream=_t,this._reader=null,this._loaded=0;const nt=_t.source;this._withCredentials=nt.withCredentials||!1,this._readCapability=new i.PromiseCapability,this._isStreamingSupported=!nt.disableStream,this._abortController=new AbortController,this._headers=bt(this._stream.httpHeaders),this._headers.append("Range",`bytes=${dt}-${st-1}`);const j=nt.url;fetch(j,St(this._headers,this._withCredentials,this._abortController)).then(tt=>{if(!(0,b.validateResponseStatus)(tt.status))throw(0,b.createResponseStatusError)(tt.status,j);this._readCapability.resolve(),this._reader=tt.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var st;await this._readCapability.promise;const{value:_t,done:dt}=await this._reader.read();return dt?{value:_t,done:dt}:(this._loaded+=_t.byteLength,(st=this.onProgress)==null||st.call(this,{loaded:this._loaded}),{value:Wt(_t),done:!1})}cancel(_t){var dt;(dt=this._reader)==null||dt.cancel(_t),this._abortController.abort()}}},(d,e,ot)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.createResponseStatusError=ht,e.extractFilenameFromHeader=Wt,e.validateRangeRequestCapabilities=bt,e.validateResponseStatus=rt;var i=ot(1),b=ot(21),St=ot(6);function bt({getResponseHeader:X,isHttp:mt,rangeChunkSize:_t,disableRange:dt}){const st={allowRangeRequests:!1,suggestedLength:void 0},nt=parseInt(X("Content-Length"),10);return!Number.isInteger(nt)||(st.suggestedLength=nt,nt<=2*_t)||dt||!mt||X("Accept-Ranges")!=="bytes"||(X("Content-Encoding")||"identity")!=="identity"||(st.allowRangeRequests=!0),st}function Wt(X){const mt=X("Content-Disposition");if(mt){let _t=(0,b.getFilenameFromContentDispositionHeader)(mt);if(_t.includes("%"))try{_t=decodeURIComponent(_t)}catch{}if((0,St.isPdfFile)(_t))return _t}return null}function ht(X,mt){return X===404||X===0&&mt.startsWith("file:")?new i.MissingPDFException('Missing PDF "'+mt+'".'):new i.UnexpectedResponseException(`Unexpected server response (${X}) while retrieving PDF "${mt}".`,X)}function rt(X){return X===200||X===206}},(d,e,ot)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getFilenameFromContentDispositionHeader=b;var i=ot(1);function b(St){let bt=!0,Wt=ht("filename\\*","i").exec(St);if(Wt){Wt=Wt[1];let nt=_t(Wt);return nt=unescape(nt),nt=dt(nt),nt=st(nt),X(nt)}if(Wt=mt(St),Wt){const nt=st(Wt);return X(nt)}if(Wt=ht("filename","i").exec(St),Wt){Wt=Wt[1];let nt=_t(Wt);return nt=st(nt),X(nt)}function ht(nt,j){return new RegExp("(?:^|;)\\s*"+nt+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',j)}function rt(nt,j){if(nt){if(!/^[\x00-\xFF]+$/.test(j))return j;try{const tt=new TextDecoder(nt,{fatal:!0}),ct=(0,i.stringToBytes)(j);j=tt.decode(ct),bt=!1}catch{}}return j}function X(nt){return bt&&/[\x80-\xff]/.test(nt)&&(nt=rt("utf-8",nt),bt&&(nt=rt("iso-8859-1",nt))),nt}function mt(nt){const j=[];let tt;const ct=ht("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(tt=ct.exec(nt))!==null;){let[,et,f,_]=tt;if(et=parseInt(et,10),et in j){if(et===0)break;continue}j[et]=[f,_]}const lt=[];for(let et=0;et<j.length&&et in j;++et){let[f,_]=j[et];_=_t(_),f&&(_=unescape(_),et===0&&(_=dt(_))),lt.push(_)}return lt.join("")}function _t(nt){if(nt.startsWith('"')){const j=nt.slice(1).split('\\"');for(let tt=0;tt<j.length;++tt){const ct=j[tt].indexOf('"');ct!==-1&&(j[tt]=j[tt].slice(0,ct),j.length=tt+1),j[tt]=j[tt].replaceAll(/\\(.)/g,"$1")}nt=j.join('"')}return nt}function dt(nt){const j=nt.indexOf("'");if(j===-1)return nt;const tt=nt.slice(0,j),lt=nt.slice(j+1).replace(/^[^']*'/,"");return rt(tt,lt)}function st(nt){return!nt.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(nt)?nt:nt.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(j,tt,ct,lt){if(ct==="q"||ct==="Q")return lt=lt.replaceAll("_"," "),lt=lt.replaceAll(/=([0-9a-fA-F]{2})/g,function(et,f){return String.fromCharCode(parseInt(f,16))}),rt(tt,lt);try{lt=atob(lt)}catch{}return rt(tt,lt)})}return""}},(d,e,ot)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFNetworkStream=void 0;var i=ot(1),b=ot(20);const St=200,bt=206;function Wt(_t){const dt=_t.response;return typeof dt!="string"?dt:(0,i.stringToBytes)(dt).buffer}class ht{constructor(dt,st={}){this.url=dt,this.isHttp=/^https?:/i.test(dt),this.httpHeaders=this.isHttp&&st.httpHeaders||Object.create(null),this.withCredentials=st.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(dt,st,nt){const j={begin:dt,end:st};for(const tt in nt)j[tt]=nt[tt];return this.request(j)}requestFull(dt){return this.request(dt)}request(dt){const st=new XMLHttpRequest,nt=this.currXhrId++,j=this.pendingRequests[nt]={xhr:st};st.open("GET",this.url),st.withCredentials=this.withCredentials;for(const tt in this.httpHeaders){const ct=this.httpHeaders[tt];ct!==void 0&&st.setRequestHeader(tt,ct)}return this.isHttp&&"begin"in dt&&"end"in dt?(st.setRequestHeader("Range",`bytes=${dt.begin}-${dt.end-1}`),j.expectedStatus=bt):j.expectedStatus=St,st.responseType="arraybuffer",dt.onError&&(st.onerror=function(tt){dt.onError(st.status)}),st.onreadystatechange=this.onStateChange.bind(this,nt),st.onprogress=this.onProgress.bind(this,nt),j.onHeadersReceived=dt.onHeadersReceived,j.onDone=dt.onDone,j.onError=dt.onError,j.onProgress=dt.onProgress,st.send(null),nt}onProgress(dt,st){var j;const nt=this.pendingRequests[dt];nt&&((j=nt.onProgress)==null||j.call(nt,st))}onStateChange(dt,st){var et,f,_;const nt=this.pendingRequests[dt];if(!nt)return;const j=nt.xhr;if(j.readyState>=2&&nt.onHeadersReceived&&(nt.onHeadersReceived(),delete nt.onHeadersReceived),j.readyState!==4||!(dt in this.pendingRequests))return;if(delete this.pendingRequests[dt],j.status===0&&this.isHttp){(et=nt.onError)==null||et.call(nt,j.status);return}const tt=j.status||St;if(!(tt===St&&nt.expectedStatus===bt)&&tt!==nt.expectedStatus){(f=nt.onError)==null||f.call(nt,j.status);return}const lt=Wt(j);if(tt===bt){const pt=j.getResponseHeader("Content-Range"),Y=/bytes (\d+)-(\d+)\/(\d+)/.exec(pt);nt.onDone({begin:parseInt(Y[1],10),chunk:lt})}else lt?nt.onDone({begin:0,chunk:lt}):(_=nt.onError)==null||_.call(nt,j.status)}getRequestXhr(dt){return this.pendingRequests[dt].xhr}isPendingRequest(dt){return dt in this.pendingRequests}abortRequest(dt){const st=this.pendingRequests[dt].xhr;delete this.pendingRequests[dt],st.abort()}}class rt{constructor(dt){this._source=dt,this._manager=new ht(dt.url,{httpHeaders:dt.httpHeaders,withCredentials:dt.withCredentials}),this._rangeChunkSize=dt.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(dt){const st=this._rangeRequestReaders.indexOf(dt);st>=0&&this._rangeRequestReaders.splice(st,1)}getFullReader(){return(0,i.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new X(this._manager,this._source),this._fullRequestReader}getRangeReader(dt,st){const nt=new mt(this._manager,dt,st);return nt.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(nt),nt}cancelAllRequests(dt){var st;(st=this._fullRequestReader)==null||st.cancel(dt);for(const nt of this._rangeRequestReaders.slice(0))nt.cancel(dt)}}e.PDFNetworkStream=rt;class X{constructor(dt,st){this._manager=dt;const nt={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=st.url,this._fullRequestId=dt.requestFull(nt),this._headersReceivedCapability=new i.PromiseCapability,this._disableRange=st.disableRange||!1,this._contentLength=st.length,this._rangeChunkSize=st.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const dt=this._fullRequestId,st=this._manager.getRequestXhr(dt),nt=ct=>st.getResponseHeader(ct),{allowRangeRequests:j,suggestedLength:tt}=(0,b.validateRangeRequestCapabilities)({getResponseHeader:nt,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});j&&(this._isRangeSupported=!0),this._contentLength=tt||this._contentLength,this._filename=(0,b.extractFilenameFromHeader)(nt),this._isRangeSupported&&this._manager.abortRequest(dt),this._headersReceivedCapability.resolve()}_onDone(dt){if(dt&&(this._requests.length>0?this._requests.shift().resolve({value:dt.chunk,done:!1}):this._cachedChunks.push(dt.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const st of this._requests)st.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(dt){this._storedError=(0,b.createResponseStatusError)(dt,this._url),this._headersReceivedCapability.reject(this._storedError);for(const st of this._requests)st.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(dt){var st;(st=this.onProgress)==null||st.call(this,{loaded:dt.loaded,total:dt.lengthComputable?dt.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const dt=new i.PromiseCapability;return this._requests.push(dt),dt.promise}cancel(dt){this._done=!0,this._headersReceivedCapability.reject(dt);for(const st of this._requests)st.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class mt{constructor(dt,st,nt){this._manager=dt;const j={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=dt.url,this._requestId=dt.requestRange(st,nt,j),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var dt;(dt=this.onClosed)==null||dt.call(this,this)}_onDone(dt){const st=dt.chunk;this._requests.length>0?this._requests.shift().resolve({value:st,done:!1}):this._queuedChunk=st,this._done=!0;for(const nt of this._requests)nt.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(dt){this._storedError=(0,b.createResponseStatusError)(dt,this._url);for(const st of this._requests)st.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(dt){var st;this.isStreamingSupported||(st=this.onProgress)==null||st.call(this,{loaded:dt.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const st=this._queuedChunk;return this._queuedChunk=null,{value:st,done:!1}}if(this._done)return{value:void 0,done:!0};const dt=new i.PromiseCapability;return this._requests.push(dt),dt.promise}cancel(dt){this._done=!0;for(const st of this._requests)st.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(d,e,ot)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFNodeStream=void 0;var i=ot(1),b=ot(20);const St=/^file:\/\/\/[a-zA-Z]:\//;function bt(nt){const j=require$$5,tt=j.parse(nt);return tt.protocol==="file:"||tt.host?tt:/^[a-z]:[/\\]/i.test(nt)?j.parse(`file:///${nt}`):(tt.host||(tt.protocol="file:"),tt)}class Wt{constructor(j){this.source=j,this.url=bt(j.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&j.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var j;return((j=this._fullRequestReader)==null?void 0:j._loaded)??0}getFullReader(){return(0,i.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new dt(this):new mt(this),this._fullRequestReader}getRangeReader(j,tt){if(tt<=this._progressiveDataLength)return null;const ct=this.isFsUrl?new st(this,j,tt):new _t(this,j,tt);return this._rangeRequestReaders.push(ct),ct}cancelAllRequests(j){var tt;(tt=this._fullRequestReader)==null||tt.cancel(j);for(const ct of this._rangeRequestReaders.slice(0))ct.cancel(j)}}e.PDFNodeStream=Wt;class ht{constructor(j){this._url=j.url,this._done=!1,this._storedError=null,this.onProgress=null;const tt=j.source;this._contentLength=tt.length,this._loaded=0,this._filename=null,this._disableRange=tt.disableRange||!1,this._rangeChunkSize=tt.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!tt.disableStream,this._isRangeSupported=!tt.disableRange,this._readableStream=null,this._readCapability=new i.PromiseCapability,this._headersCapability=new i.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var ct;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const j=this._readableStream.read();return j===null?(this._readCapability=new i.PromiseCapability,this.read()):(this._loaded+=j.length,(ct=this.onProgress)==null||ct.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(j).buffer,done:!1})}cancel(j){if(!this._readableStream){this._error(j);return}this._readableStream.destroy(j)}_error(j){this._storedError=j,this._readCapability.resolve()}_setReadableStream(j){this._readableStream=j,j.on("readable",()=>{this._readCapability.resolve()}),j.on("end",()=>{j.destroy(),this._done=!0,this._readCapability.resolve()}),j.on("error",tt=>{this._error(tt)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new i.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class rt{constructor(j){this._url=j.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new i.PromiseCapability;const tt=j.source;this._isStreamingSupported=!tt.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var ct;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const j=this._readableStream.read();return j===null?(this._readCapability=new i.PromiseCapability,this.read()):(this._loaded+=j.length,(ct=this.onProgress)==null||ct.call(this,{loaded:this._loaded}),{value:new Uint8Array(j).buffer,done:!1})}cancel(j){if(!this._readableStream){this._error(j);return}this._readableStream.destroy(j)}_error(j){this._storedError=j,this._readCapability.resolve()}_setReadableStream(j){this._readableStream=j,j.on("readable",()=>{this._readCapability.resolve()}),j.on("end",()=>{j.destroy(),this._done=!0,this._readCapability.resolve()}),j.on("error",tt=>{this._error(tt)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function X(nt,j){return{protocol:nt.protocol,auth:nt.auth,host:nt.hostname,port:nt.port,path:nt.path,method:"GET",headers:j}}class mt extends ht{constructor(j){super(j);const tt=ct=>{if(ct.statusCode===404){const _=new i.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=_,this._headersCapability.reject(_);return}this._headersCapability.resolve(),this._setReadableStream(ct);const lt=_=>this._readableStream.headers[_.toLowerCase()],{allowRangeRequests:et,suggestedLength:f}=(0,b.validateRangeRequestCapabilities)({getResponseHeader:lt,isHttp:j.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=et,this._contentLength=f||this._contentLength,this._filename=(0,b.extractFilenameFromHeader)(lt)};if(this._request=null,this._url.protocol==="http:"){const ct=require$$5;this._request=ct.request(X(this._url,j.httpHeaders),tt)}else{const ct=require$$5;this._request=ct.request(X(this._url,j.httpHeaders),tt)}this._request.on("error",ct=>{this._storedError=ct,this._headersCapability.reject(ct)}),this._request.end()}}class _t extends rt{constructor(j,tt,ct){super(j),this._httpHeaders={};for(const et in j.httpHeaders){const f=j.httpHeaders[et];f!==void 0&&(this._httpHeaders[et]=f)}this._httpHeaders.Range=`bytes=${tt}-${ct-1}`;const lt=et=>{if(et.statusCode===404){const f=new i.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=f;return}this._setReadableStream(et)};if(this._request=null,this._url.protocol==="http:"){const et=require$$5;this._request=et.request(X(this._url,this._httpHeaders),lt)}else{const et=require$$5;this._request=et.request(X(this._url,this._httpHeaders),lt)}this._request.on("error",et=>{this._storedError=et}),this._request.end()}}class dt extends ht{constructor(j){super(j);let tt=decodeURIComponent(this._url.path);St.test(this._url.href)&&(tt=tt.replace(/^\//,""));const ct=require$$5;ct.lstat(tt,(lt,et)=>{if(lt){lt.code==="ENOENT"&&(lt=new i.MissingPDFException(`Missing PDF "${tt}".`)),this._storedError=lt,this._headersCapability.reject(lt);return}this._contentLength=et.size,this._setReadableStream(ct.createReadStream(tt)),this._headersCapability.resolve()})}}class st extends rt{constructor(j,tt,ct){super(j);let lt=decodeURIComponent(this._url.path);St.test(this._url.href)&&(lt=lt.replace(/^\//,""));const et=require$$5;this._setReadableStream(et.createReadStream(lt,{start:tt,end:ct-1}))}}},(d,e,ot)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.SVGGraphics=void 0;var i=ot(6),b=ot(1);const St={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},bt="http://www.w3.org/XML/1998/namespace",Wt="http://www.w3.org/1999/xlink",ht=["butt","round","square"],rt=["miter","round","bevel"],X=function(et,f="",_=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!_)return URL.createObjectURL(new Blob([et],{type:f}));const pt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let Y=`data:${f};base64,`;for(let g=0,ft=et.length;g<ft;g+=3){const $=et[g]&255,Tt=et[g+1]&255,wt=et[g+2]&255,at=$>>2,Rt=($&3)<<4|Tt>>4,Bt=g+1<ft?(Tt&15)<<2|wt>>6:64,$t=g+2<ft?wt&63:64;Y+=pt[at]+pt[Rt]+pt[Bt]+pt[$t]}return Y},mt=function(){const et=new Uint8Array([137,80,78,71,13,10,26,10]),f=12,_=new Int32Array(256);for(let wt=0;wt<256;wt++){let at=wt;for(let Rt=0;Rt<8;Rt++)at=at&1?3988292384^at>>1&2147483647:at>>1&2147483647;_[wt]=at}function pt(wt,at,Rt){let Bt=-1;for(let $t=at;$t<Rt;$t++){const Pt=(Bt^wt[$t])&255,Vt=_[Pt];Bt=Bt>>>8^Vt}return Bt^-1}function Y(wt,at,Rt,Bt){let $t=Bt;const Pt=at.length;Rt[$t]=Pt>>24&255,Rt[$t+1]=Pt>>16&255,Rt[$t+2]=Pt>>8&255,Rt[$t+3]=Pt&255,$t+=4,Rt[$t]=wt.charCodeAt(0)&255,Rt[$t+1]=wt.charCodeAt(1)&255,Rt[$t+2]=wt.charCodeAt(2)&255,Rt[$t+3]=wt.charCodeAt(3)&255,$t+=4,Rt.set(at,$t),$t+=at.length;const Vt=pt(Rt,Bt+4,$t);Rt[$t]=Vt>>24&255,Rt[$t+1]=Vt>>16&255,Rt[$t+2]=Vt>>8&255,Rt[$t+3]=Vt&255}function g(wt,at,Rt){let Bt=1,$t=0;for(let Pt=at;Pt<Rt;++Pt)Bt=(Bt+(wt[Pt]&255))%65521,$t=($t+Bt)%65521;return $t<<16|Bt}function ft(wt){if(!b.isNodeJS)return $(wt);try{const at=parseInt(process.versions.node)>=8?wt:Buffer.from(wt),Rt=require$$5.deflateSync(at,{level:9});return Rt instanceof Uint8Array?Rt:new Uint8Array(Rt)}catch(at){(0,b.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+at)}return $(wt)}function $(wt){let at=wt.length;const Rt=65535,Bt=Math.ceil(at/Rt),$t=new Uint8Array(2+at+Bt*5+4);let Pt=0;$t[Pt++]=120,$t[Pt++]=156;let Vt=0;for(;at>Rt;)$t[Pt++]=0,$t[Pt++]=255,$t[Pt++]=255,$t[Pt++]=0,$t[Pt++]=0,$t.set(wt.subarray(Vt,Vt+Rt),Pt),Pt+=Rt,Vt+=Rt,at-=Rt;$t[Pt++]=1,$t[Pt++]=at&255,$t[Pt++]=at>>8&255,$t[Pt++]=~at&65535&255,$t[Pt++]=(~at&65535)>>8&255,$t.set(wt.subarray(Vt),Pt),Pt+=wt.length-Vt;const Jt=g(wt,0,wt.length);return $t[Pt++]=Jt>>24&255,$t[Pt++]=Jt>>16&255,$t[Pt++]=Jt>>8&255,$t[Pt++]=Jt&255,$t}function Tt(wt,at,Rt,Bt){const $t=wt.width,Pt=wt.height;let Vt,Jt,se;const re=wt.data;switch(at){case b.ImageKind.GRAYSCALE_1BPP:Jt=0,Vt=1,se=$t+7>>3;break;case b.ImageKind.RGB_24BPP:Jt=2,Vt=8,se=$t*3;break;case b.ImageKind.RGBA_32BPP:Jt=6,Vt=8,se=$t*4;break;default:throw new Error("invalid format")}const ut=new Uint8Array((1+se)*Pt);let o=0,h=0;for(let vt=0;vt<Pt;++vt)ut[o++]=0,ut.set(re.subarray(h,h+se),o),h+=se,o+=se;if(at===b.ImageKind.GRAYSCALE_1BPP&&Bt){o=0;for(let vt=0;vt<Pt;vt++){o++;for(let Nt=0;Nt<se;Nt++)ut[o++]^=255}}const c=new Uint8Array([$t>>24&255,$t>>16&255,$t>>8&255,$t&255,Pt>>24&255,Pt>>16&255,Pt>>8&255,Pt&255,Vt,Jt,0,0,0]),m=ft(ut),k=et.length+f*3+c.length+m.length,it=new Uint8Array(k);let gt=0;return it.set(et,gt),gt+=et.length,Y("IHDR",c,it,gt),gt+=f+c.length,Y("IDATA",m,it,gt),gt+=f+m.length,Y("IEND",new Uint8Array(0),it,gt),X(it,"image/png",Rt)}return function(at,Rt,Bt){const $t=at.kind===void 0?b.ImageKind.GRAYSCALE_1BPP:at.kind;return Tt(at,$t,Rt,Bt)}}();class _t{constructor(){this.fontSizeScale=1,this.fontWeight=St.fontWeight,this.fontSize=0,this.textMatrix=b.IDENTITY_MATRIX,this.fontMatrix=b.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=b.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=St.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(f,_){this.x=f,this.y=_}}function dt(et){let f=[];const _=[];for(const pt of et){if(pt.fn==="save"){f.push({fnId:92,fn:"group",items:[]}),_.push(f),f=f.at(-1).items;continue}pt.fn==="restore"?f=_.pop():f.push(pt)}return f}function st(et){if(Number.isInteger(et))return et.toString();const f=et.toFixed(10);let _=f.length-1;if(f[_]!=="0")return f;do _--;while(f[_]==="0");return f.substring(0,f[_]==="."?_:_+1)}function nt(et){if(et[4]===0&&et[5]===0){if(et[1]===0&&et[2]===0)return et[0]===1&&et[3]===1?"":`scale(${st(et[0])} ${st(et[3])})`;if(et[0]===et[3]&&et[1]===-et[2]){const f=Math.acos(et[0])*180/Math.PI;return`rotate(${st(f)})`}}else if(et[0]===1&&et[1]===0&&et[2]===0&&et[3]===1)return`translate(${st(et[4])} ${st(et[5])})`;return`matrix(${st(et[0])} ${st(et[1])} ${st(et[2])} ${st(et[3])} ${st(et[4])} ${st(et[5])})`}let j=0,tt=0,ct=0;class lt{constructor(f,_,pt=!1){(0,i.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new i.DOMSVGFactory,this.current=new _t,this.transformMatrix=b.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=f,this.objs=_,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!pt,this._operatorIdMapping=[];for(const Y in b.OPS)this._operatorIdMapping[b.OPS[Y]]=Y}getObject(f,_=null){return typeof f=="string"?f.startsWith("g_")?this.commonObjs.get(f):this.objs.get(f):_}save(){this.transformStack.push(this.transformMatrix);const f=this.current;this.extraStack.push(f),this.current=f.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(f){this.save(),this.executeOpTree(f),this.restore()}loadDependencies(f){const _=f.fnArray,pt=f.argsArray;for(let Y=0,g=_.length;Y<g;Y++)if(_[Y]===b.OPS.dependency)for(const ft of pt[Y]){const $=ft.startsWith("g_")?this.commonObjs:this.objs,Tt=new Promise(wt=>{$.get(ft,wt)});this.current.dependencies.push(Tt)}return Promise.all(this.current.dependencies)}transform(f,_,pt,Y,g,ft){const $=[f,_,pt,Y,g,ft];this.transformMatrix=b.Util.transform(this.transformMatrix,$),this.tgrp=null}getSVG(f,_){this.viewport=_;const pt=this._initialize(_);return this.loadDependencies(f).then(()=>(this.transformMatrix=b.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(f)),pt))}convertOpList(f){const _=this._operatorIdMapping,pt=f.argsArray,Y=f.fnArray,g=[];for(let ft=0,$=Y.length;ft<$;ft++){const Tt=Y[ft];g.push({fnId:Tt,fn:_[Tt],args:pt[ft]})}return dt(g)}executeOpTree(f){for(const _ of f){const pt=_.fn,Y=_.fnId,g=_.args;switch(Y|0){case b.OPS.beginText:this.beginText();break;case b.OPS.dependency:break;case b.OPS.setLeading:this.setLeading(g);break;case b.OPS.setLeadingMoveText:this.setLeadingMoveText(g[0],g[1]);break;case b.OPS.setFont:this.setFont(g);break;case b.OPS.showText:this.showText(g[0]);break;case b.OPS.showSpacedText:this.showText(g[0]);break;case b.OPS.endText:this.endText();break;case b.OPS.moveText:this.moveText(g[0],g[1]);break;case b.OPS.setCharSpacing:this.setCharSpacing(g[0]);break;case b.OPS.setWordSpacing:this.setWordSpacing(g[0]);break;case b.OPS.setHScale:this.setHScale(g[0]);break;case b.OPS.setTextMatrix:this.setTextMatrix(g[0],g[1],g[2],g[3],g[4],g[5]);break;case b.OPS.setTextRise:this.setTextRise(g[0]);break;case b.OPS.setTextRenderingMode:this.setTextRenderingMode(g[0]);break;case b.OPS.setLineWidth:this.setLineWidth(g[0]);break;case b.OPS.setLineJoin:this.setLineJoin(g[0]);break;case b.OPS.setLineCap:this.setLineCap(g[0]);break;case b.OPS.setMiterLimit:this.setMiterLimit(g[0]);break;case b.OPS.setFillRGBColor:this.setFillRGBColor(g[0],g[1],g[2]);break;case b.OPS.setStrokeRGBColor:this.setStrokeRGBColor(g[0],g[1],g[2]);break;case b.OPS.setStrokeColorN:this.setStrokeColorN(g);break;case b.OPS.setFillColorN:this.setFillColorN(g);break;case b.OPS.shadingFill:this.shadingFill(g[0]);break;case b.OPS.setDash:this.setDash(g[0],g[1]);break;case b.OPS.setRenderingIntent:this.setRenderingIntent(g[0]);break;case b.OPS.setFlatness:this.setFlatness(g[0]);break;case b.OPS.setGState:this.setGState(g[0]);break;case b.OPS.fill:this.fill();break;case b.OPS.eoFill:this.eoFill();break;case b.OPS.stroke:this.stroke();break;case b.OPS.fillStroke:this.fillStroke();break;case b.OPS.eoFillStroke:this.eoFillStroke();break;case b.OPS.clip:this.clip("nonzero");break;case b.OPS.eoClip:this.clip("evenodd");break;case b.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case b.OPS.paintImageXObject:this.paintImageXObject(g[0]);break;case b.OPS.paintInlineImageXObject:this.paintInlineImageXObject(g[0]);break;case b.OPS.paintImageMaskXObject:this.paintImageMaskXObject(g[0]);break;case b.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(g[0],g[1]);break;case b.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case b.OPS.closePath:this.closePath();break;case b.OPS.closeStroke:this.closeStroke();break;case b.OPS.closeFillStroke:this.closeFillStroke();break;case b.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case b.OPS.nextLine:this.nextLine();break;case b.OPS.transform:this.transform(g[0],g[1],g[2],g[3],g[4],g[5]);break;case b.OPS.constructPath:this.constructPath(g[0],g[1]);break;case b.OPS.endPath:this.endPath();break;case 92:this.group(_.items);break;default:(0,b.warn)(`Unimplemented operator ${pt}`);break}}}setWordSpacing(f){this.current.wordSpacing=f}setCharSpacing(f){this.current.charSpacing=f}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(f,_,pt,Y,g,ft){const $=this.current;$.textMatrix=$.lineMatrix=[f,_,pt,Y,g,ft],$.textMatrixScale=Math.hypot(f,_),$.x=$.lineX=0,$.y=$.lineY=0,$.xcoords=[],$.ycoords=[],$.tspan=this.svgFactory.createElement("svg:tspan"),$.tspan.setAttributeNS(null,"font-family",$.fontFamily),$.tspan.setAttributeNS(null,"font-size",`${st($.fontSize)}px`),$.tspan.setAttributeNS(null,"y",st(-$.y)),$.txtElement=this.svgFactory.createElement("svg:text"),$.txtElement.append($.tspan)}beginText(){const f=this.current;f.x=f.lineX=0,f.y=f.lineY=0,f.textMatrix=b.IDENTITY_MATRIX,f.lineMatrix=b.IDENTITY_MATRIX,f.textMatrixScale=1,f.tspan=this.svgFactory.createElement("svg:tspan"),f.txtElement=this.svgFactory.createElement("svg:text"),f.txtgrp=this.svgFactory.createElement("svg:g"),f.xcoords=[],f.ycoords=[]}moveText(f,_){const pt=this.current;pt.x=pt.lineX+=f,pt.y=pt.lineY+=_,pt.xcoords=[],pt.ycoords=[],pt.tspan=this.svgFactory.createElement("svg:tspan"),pt.tspan.setAttributeNS(null,"font-family",pt.fontFamily),pt.tspan.setAttributeNS(null,"font-size",`${st(pt.fontSize)}px`),pt.tspan.setAttributeNS(null,"y",st(-pt.y))}showText(f){const _=this.current,pt=_.font,Y=_.fontSize;if(Y===0)return;const g=_.fontSizeScale,ft=_.charSpacing,$=_.wordSpacing,Tt=_.fontDirection,wt=_.textHScale*Tt,at=pt.vertical,Rt=at?1:-1,Bt=pt.defaultVMetrics,$t=Y*_.fontMatrix[0];let Pt=0;for(const se of f){if(se===null){Pt+=Tt*$;continue}else if(typeof se=="number"){Pt+=Rt*se*Y/1e3;continue}const re=(se.isSpace?$:0)+ft,ut=se.fontChar;let o,h,c=se.width;if(at){let k;const it=se.vmetric||Bt;k=se.vmetric?it[1]:c*.5,k=-k*$t;const gt=it[2]*$t;c=it?-it[0]:c,o=k/g,h=(Pt+gt)/g}else o=Pt/g,h=0;(se.isInFont||pt.missingFile)&&(_.xcoords.push(_.x+o),at&&_.ycoords.push(-_.y+h),_.tspan.textContent+=ut);const m=at?c*$t-re*Tt:c*$t+re*Tt;Pt+=m}_.tspan.setAttributeNS(null,"x",_.xcoords.map(st).join(" ")),at?_.tspan.setAttributeNS(null,"y",_.ycoords.map(st).join(" ")):_.tspan.setAttributeNS(null,"y",st(-_.y)),at?_.y-=Pt:_.x+=Pt*wt,_.tspan.setAttributeNS(null,"font-family",_.fontFamily),_.tspan.setAttributeNS(null,"font-size",`${st(_.fontSize)}px`),_.fontStyle!==St.fontStyle&&_.tspan.setAttributeNS(null,"font-style",_.fontStyle),_.fontWeight!==St.fontWeight&&_.tspan.setAttributeNS(null,"font-weight",_.fontWeight);const Vt=_.textRenderingMode&b.TextRenderingMode.FILL_STROKE_MASK;if(Vt===b.TextRenderingMode.FILL||Vt===b.TextRenderingMode.FILL_STROKE?(_.fillColor!==St.fillColor&&_.tspan.setAttributeNS(null,"fill",_.fillColor),_.fillAlpha<1&&_.tspan.setAttributeNS(null,"fill-opacity",_.fillAlpha)):_.textRenderingMode===b.TextRenderingMode.ADD_TO_PATH?_.tspan.setAttributeNS(null,"fill","transparent"):_.tspan.setAttributeNS(null,"fill","none"),Vt===b.TextRenderingMode.STROKE||Vt===b.TextRenderingMode.FILL_STROKE){const se=1/(_.textMatrixScale||1);this._setStrokeAttributes(_.tspan,se)}let Jt=_.textMatrix;_.textRise!==0&&(Jt=Jt.slice(),Jt[5]+=_.textRise),_.txtElement.setAttributeNS(null,"transform",`${nt(Jt)} scale(${st(wt)}, -1)`),_.txtElement.setAttributeNS(bt,"xml:space","preserve"),_.txtElement.append(_.tspan),_.txtgrp.append(_.txtElement),this._ensureTransformGroup().append(_.txtElement)}setLeadingMoveText(f,_){this.setLeading(-_),this.moveText(f,_)}addFontStyle(f){if(!f.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const _=X(f.data,f.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${f.loadedName}"; src: url(${_}); }
`}setFont(f){const _=this.current,pt=this.commonObjs.get(f[0]);let Y=f[1];_.font=pt,this.embedFonts&&!pt.missingFile&&!this.embeddedFonts[pt.loadedName]&&(this.addFontStyle(pt),this.embeddedFonts[pt.loadedName]=pt),_.fontMatrix=pt.fontMatrix||b.FONT_IDENTITY_MATRIX;let g="normal";pt.black?g="900":pt.bold&&(g="bold");const ft=pt.italic?"italic":"normal";Y<0?(Y=-Y,_.fontDirection=-1):_.fontDirection=1,_.fontSize=Y,_.fontFamily=pt.loadedName,_.fontWeight=g,_.fontStyle=ft,_.tspan=this.svgFactory.createElement("svg:tspan"),_.tspan.setAttributeNS(null,"y",st(-_.y)),_.xcoords=[],_.ycoords=[]}endText(){var _;const f=this.current;f.textRenderingMode&b.TextRenderingMode.ADD_TO_PATH_FLAG&&((_=f.txtElement)!=null&&_.hasChildNodes())&&(f.element=f.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(f){f>0&&(this.current.lineWidth=f)}setLineCap(f){this.current.lineCap=ht[f]}setLineJoin(f){this.current.lineJoin=rt[f]}setMiterLimit(f){this.current.miterLimit=f}setStrokeAlpha(f){this.current.strokeAlpha=f}setStrokeRGBColor(f,_,pt){this.current.strokeColor=b.Util.makeHexColor(f,_,pt)}setFillAlpha(f){this.current.fillAlpha=f}setFillRGBColor(f,_,pt){this.current.fillColor=b.Util.makeHexColor(f,_,pt),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(f){this.current.strokeColor=this._makeColorN_Pattern(f)}setFillColorN(f){this.current.fillColor=this._makeColorN_Pattern(f)}shadingFill(f){const{width:_,height:pt}=this.viewport,Y=b.Util.inverseTransform(this.transformMatrix),[g,ft,$,Tt]=b.Util.getAxialAlignedBoundingBox([0,0,_,pt],Y),wt=this.svgFactory.createElement("svg:rect");wt.setAttributeNS(null,"x",g),wt.setAttributeNS(null,"y",ft),wt.setAttributeNS(null,"width",$-g),wt.setAttributeNS(null,"height",Tt-ft),wt.setAttributeNS(null,"fill",this._makeShadingPattern(f)),this.current.fillAlpha<1&&wt.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(wt)}_makeColorN_Pattern(f){return f[0]==="TilingPattern"?this._makeTilingPattern(f):this._makeShadingPattern(f)}_makeTilingPattern(f){const _=f[1],pt=f[2],Y=f[3]||b.IDENTITY_MATRIX,[g,ft,$,Tt]=f[4],wt=f[5],at=f[6],Rt=f[7],Bt=`shading${ct++}`,[$t,Pt,Vt,Jt]=b.Util.normalizeRect([...b.Util.applyTransform([g,ft],Y),...b.Util.applyTransform([$,Tt],Y)]),[se,re]=b.Util.singularValueDecompose2dScale(Y),ut=wt*se,o=at*re,h=this.svgFactory.createElement("svg:pattern");h.setAttributeNS(null,"id",Bt),h.setAttributeNS(null,"patternUnits","userSpaceOnUse"),h.setAttributeNS(null,"width",ut),h.setAttributeNS(null,"height",o),h.setAttributeNS(null,"x",`${$t}`),h.setAttributeNS(null,"y",`${Pt}`);const c=this.svg,m=this.transformMatrix,k=this.current.fillColor,it=this.current.strokeColor,gt=this.svgFactory.create(Vt-$t,Jt-Pt);if(this.svg=gt,this.transformMatrix=Y,Rt===2){const vt=b.Util.makeHexColor(..._);this.current.fillColor=vt,this.current.strokeColor=vt}return this.executeOpTree(this.convertOpList(pt)),this.svg=c,this.transformMatrix=m,this.current.fillColor=k,this.current.strokeColor=it,h.append(gt.childNodes[0]),this.defs.append(h),`url(#${Bt})`}_makeShadingPattern(f){switch(typeof f=="string"&&(f=this.objs.get(f)),f[0]){case"RadialAxial":const _=`shading${ct++}`,pt=f[3];let Y;switch(f[1]){case"axial":const g=f[4],ft=f[5];Y=this.svgFactory.createElement("svg:linearGradient"),Y.setAttributeNS(null,"id",_),Y.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),Y.setAttributeNS(null,"x1",g[0]),Y.setAttributeNS(null,"y1",g[1]),Y.setAttributeNS(null,"x2",ft[0]),Y.setAttributeNS(null,"y2",ft[1]);break;case"radial":const $=f[4],Tt=f[5],wt=f[6],at=f[7];Y=this.svgFactory.createElement("svg:radialGradient"),Y.setAttributeNS(null,"id",_),Y.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),Y.setAttributeNS(null,"cx",Tt[0]),Y.setAttributeNS(null,"cy",Tt[1]),Y.setAttributeNS(null,"r",at),Y.setAttributeNS(null,"fx",$[0]),Y.setAttributeNS(null,"fy",$[1]),Y.setAttributeNS(null,"fr",wt);break;default:throw new Error(`Unknown RadialAxial type: ${f[1]}`)}for(const g of pt){const ft=this.svgFactory.createElement("svg:stop");ft.setAttributeNS(null,"offset",g[0]),ft.setAttributeNS(null,"stop-color",g[1]),Y.append(ft)}return this.defs.append(Y),`url(#${_})`;case"Mesh":return(0,b.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${f[0]}`)}}setDash(f,_){this.current.dashArray=f,this.current.dashPhase=_}constructPath(f,_){const pt=this.current;let Y=pt.x,g=pt.y,ft=[],$=0;for(const Tt of f)switch(Tt|0){case b.OPS.rectangle:Y=_[$++],g=_[$++];const wt=_[$++],at=_[$++],Rt=Y+wt,Bt=g+at;ft.push("M",st(Y),st(g),"L",st(Rt),st(g),"L",st(Rt),st(Bt),"L",st(Y),st(Bt),"Z");break;case b.OPS.moveTo:Y=_[$++],g=_[$++],ft.push("M",st(Y),st(g));break;case b.OPS.lineTo:Y=_[$++],g=_[$++],ft.push("L",st(Y),st(g));break;case b.OPS.curveTo:Y=_[$+4],g=_[$+5],ft.push("C",st(_[$]),st(_[$+1]),st(_[$+2]),st(_[$+3]),st(Y),st(g)),$+=6;break;case b.OPS.curveTo2:ft.push("C",st(Y),st(g),st(_[$]),st(_[$+1]),st(_[$+2]),st(_[$+3])),Y=_[$+2],g=_[$+3],$+=4;break;case b.OPS.curveTo3:Y=_[$+2],g=_[$+3],ft.push("C",st(_[$]),st(_[$+1]),st(Y),st(g),st(Y),st(g)),$+=4;break;case b.OPS.closePath:ft.push("Z");break}ft=ft.join(" "),pt.path&&f.length>0&&f[0]!==b.OPS.rectangle&&f[0]!==b.OPS.moveTo?ft=pt.path.getAttributeNS(null,"d")+ft:(pt.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(pt.path)),pt.path.setAttributeNS(null,"d",ft),pt.path.setAttributeNS(null,"fill","none"),pt.element=pt.path,pt.setCurrentPoint(Y,g)}endPath(){const f=this.current;if(f.path=null,!this.pendingClip)return;if(!f.element){this.pendingClip=null;return}const _=`clippath${j++}`,pt=this.svgFactory.createElement("svg:clipPath");pt.setAttributeNS(null,"id",_),pt.setAttributeNS(null,"transform",nt(this.transformMatrix));const Y=f.element.cloneNode(!0);if(this.pendingClip==="evenodd"?Y.setAttributeNS(null,"clip-rule","evenodd"):Y.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,pt.append(Y),this.defs.append(pt),f.activeClipUrl){f.clipGroup=null;for(const g of this.extraStack)g.clipGroup=null;pt.setAttributeNS(null,"clip-path",f.activeClipUrl)}f.activeClipUrl=`url(#${_})`,this.tgrp=null}clip(f){this.pendingClip=f}closePath(){const f=this.current;if(f.path){const _=`${f.path.getAttributeNS(null,"d")}Z`;f.path.setAttributeNS(null,"d",_)}}setLeading(f){this.current.leading=-f}setTextRise(f){this.current.textRise=f}setTextRenderingMode(f){this.current.textRenderingMode=f}setHScale(f){this.current.textHScale=f/100}setRenderingIntent(f){}setFlatness(f){}setGState(f){for(const[_,pt]of f)switch(_){case"LW":this.setLineWidth(pt);break;case"LC":this.setLineCap(pt);break;case"LJ":this.setLineJoin(pt);break;case"ML":this.setMiterLimit(pt);break;case"D":this.setDash(pt[0],pt[1]);break;case"RI":this.setRenderingIntent(pt);break;case"FL":this.setFlatness(pt);break;case"Font":this.setFont(pt);break;case"CA":this.setStrokeAlpha(pt);break;case"ca":this.setFillAlpha(pt);break;default:(0,b.warn)(`Unimplemented graphic state operator ${_}`);break}}fill(){const f=this.current;f.element&&(f.element.setAttributeNS(null,"fill",f.fillColor),f.element.setAttributeNS(null,"fill-opacity",f.fillAlpha),this.endPath())}stroke(){const f=this.current;f.element&&(this._setStrokeAttributes(f.element),f.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(f,_=1){const pt=this.current;let Y=pt.dashArray;_!==1&&Y.length>0&&(Y=Y.map(function(g){return _*g})),f.setAttributeNS(null,"stroke",pt.strokeColor),f.setAttributeNS(null,"stroke-opacity",pt.strokeAlpha),f.setAttributeNS(null,"stroke-miterlimit",st(pt.miterLimit)),f.setAttributeNS(null,"stroke-linecap",pt.lineCap),f.setAttributeNS(null,"stroke-linejoin",pt.lineJoin),f.setAttributeNS(null,"stroke-width",st(_*pt.lineWidth)+"px"),f.setAttributeNS(null,"stroke-dasharray",Y.map(st).join(" ")),f.setAttributeNS(null,"stroke-dashoffset",st(_*pt.dashPhase)+"px")}eoFill(){var f;(f=this.current.element)==null||f.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){var f;(f=this.current.element)==null||f.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const f=this.svgFactory.createElement("svg:rect");f.setAttributeNS(null,"x","0"),f.setAttributeNS(null,"y","0"),f.setAttributeNS(null,"width","1px"),f.setAttributeNS(null,"height","1px"),f.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(f)}paintImageXObject(f){const _=this.getObject(f);if(!_){(0,b.warn)(`Dependent image with object ID ${f} is not ready yet`);return}this.paintInlineImageXObject(_)}paintInlineImageXObject(f,_){const pt=f.width,Y=f.height,g=mt(f,this.forceDataSchema,!!_),ft=this.svgFactory.createElement("svg:rect");ft.setAttributeNS(null,"x","0"),ft.setAttributeNS(null,"y","0"),ft.setAttributeNS(null,"width",st(pt)),ft.setAttributeNS(null,"height",st(Y)),this.current.element=ft,this.clip("nonzero");const $=this.svgFactory.createElement("svg:image");$.setAttributeNS(Wt,"xlink:href",g),$.setAttributeNS(null,"x","0"),$.setAttributeNS(null,"y",st(-Y)),$.setAttributeNS(null,"width",st(pt)+"px"),$.setAttributeNS(null,"height",st(Y)+"px"),$.setAttributeNS(null,"transform",`scale(${st(1/pt)} ${st(-1/Y)})`),_?_.append($):this._ensureTransformGroup().append($)}paintImageMaskXObject(f){const _=this.getObject(f.data,f);if(_.bitmap){(0,b.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const pt=this.current,Y=_.width,g=_.height,ft=pt.fillColor;pt.maskId=`mask${tt++}`;const $=this.svgFactory.createElement("svg:mask");$.setAttributeNS(null,"id",pt.maskId);const Tt=this.svgFactory.createElement("svg:rect");Tt.setAttributeNS(null,"x","0"),Tt.setAttributeNS(null,"y","0"),Tt.setAttributeNS(null,"width",st(Y)),Tt.setAttributeNS(null,"height",st(g)),Tt.setAttributeNS(null,"fill",ft),Tt.setAttributeNS(null,"mask",`url(#${pt.maskId})`),this.defs.append($),this._ensureTransformGroup().append(Tt),this.paintInlineImageXObject(_,$)}paintFormXObjectBegin(f,_){if(Array.isArray(f)&&f.length===6&&this.transform(f[0],f[1],f[2],f[3],f[4],f[5]),_){const pt=_[2]-_[0],Y=_[3]-_[1],g=this.svgFactory.createElement("svg:rect");g.setAttributeNS(null,"x",_[0]),g.setAttributeNS(null,"y",_[1]),g.setAttributeNS(null,"width",st(pt)),g.setAttributeNS(null,"height",st(Y)),this.current.element=g,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(f){const _=this.svgFactory.create(f.width,f.height),pt=this.svgFactory.createElement("svg:defs");_.append(pt),this.defs=pt;const Y=this.svgFactory.createElement("svg:g");return Y.setAttributeNS(null,"transform",nt(f.transform)),_.append(Y),this.svg=Y,_}_ensureClipGroup(){if(!this.current.clipGroup){const f=this.svgFactory.createElement("svg:g");f.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(f),this.current.clipGroup=f}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",nt(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}e.SVGGraphics=lt},(d,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.XfaText=void 0;class ot{static textContent(b){const St=[],bt={items:St,styles:Object.create(null)};function Wt(ht){var mt;if(!ht)return;let rt=null;const X=ht.name;if(X==="#text")rt=ht.value;else if(ot.shouldBuildText(X))(mt=ht==null?void 0:ht.attributes)!=null&&mt.textContent?rt=ht.attributes.textContent:ht.value&&(rt=ht.value);else return;if(rt!==null&&St.push({str:rt}),!!ht.children)for(const _t of ht.children)Wt(_t)}return Wt(b),bt}static shouldBuildText(b){return!(b==="textarea"||b==="input"||b==="option"||b==="select")}}e.XfaText=ot},(d,e,ot)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TextLayerRenderTask=void 0,e.renderTextLayer=nt,e.updateTextLayer=j;var i=ot(1),b=ot(6);const St=1e5,bt=30,Wt=.8,ht=new Map;function rt(tt,ct){let lt;if(ct&&i.FeatureTest.isOffscreenCanvasSupported)lt=new OffscreenCanvas(tt,tt).getContext("2d",{alpha:!1});else{const et=document.createElement("canvas");et.width=et.height=tt,lt=et.getContext("2d",{alpha:!1})}return lt}function X(tt,ct){const lt=ht.get(tt);if(lt)return lt;const et=rt(bt,ct);et.font=`${bt}px ${tt}`;const f=et.measureText("");let _=f.fontBoundingBoxAscent,pt=Math.abs(f.fontBoundingBoxDescent);if(_){const g=_/(_+pt);return ht.set(tt,g),et.canvas.width=et.canvas.height=0,g}et.strokeStyle="red",et.clearRect(0,0,bt,bt),et.strokeText("g",0,0);let Y=et.getImageData(0,0,bt,bt).data;pt=0;for(let g=Y.length-1-3;g>=0;g-=4)if(Y[g]>0){pt=Math.ceil(g/4/bt);break}et.clearRect(0,0,bt,bt),et.strokeText("A",0,bt),Y=et.getImageData(0,0,bt,bt).data,_=0;for(let g=0,ft=Y.length;g<ft;g+=4)if(Y[g]>0){_=bt-Math.floor(g/4/bt);break}if(et.canvas.width=et.canvas.height=0,_){const g=_/(_+pt);return ht.set(tt,g),g}return ht.set(tt,Wt),Wt}function mt(tt,ct,lt){const et=document.createElement("span"),f={angle:0,canvasWidth:0,hasText:ct.str!=="",hasEOL:ct.hasEOL,fontSize:0};tt._textDivs.push(et);const _=i.Util.transform(tt._transform,ct.transform);let pt=Math.atan2(_[1],_[0]);const Y=lt[ct.fontName];Y.vertical&&(pt+=Math.PI/2);const g=Math.hypot(_[2],_[3]),ft=g*X(Y.fontFamily,tt._isOffscreenCanvasSupported);let $,Tt;pt===0?($=_[4],Tt=_[5]-ft):($=_[4]+ft*Math.sin(pt),Tt=_[5]-ft*Math.cos(pt));const wt="calc(var(--scale-factor)*",at=et.style;tt._container===tt._rootContainer?(at.left=`${(100*$/tt._pageWidth).toFixed(2)}%`,at.top=`${(100*Tt/tt._pageHeight).toFixed(2)}%`):(at.left=`${wt}${$.toFixed(2)}px)`,at.top=`${wt}${Tt.toFixed(2)}px)`),at.fontSize=`${wt}${g.toFixed(2)}px)`,at.fontFamily=Y.fontFamily,f.fontSize=g,et.setAttribute("role","presentation"),et.textContent=ct.str,et.dir=ct.dir,tt._fontInspectorEnabled&&(et.dataset.fontName=ct.fontName),pt!==0&&(f.angle=pt*(180/Math.PI));let Rt=!1;if(ct.str.length>1)Rt=!0;else if(ct.str!==" "&&ct.transform[0]!==ct.transform[3]){const Bt=Math.abs(ct.transform[0]),$t=Math.abs(ct.transform[3]);Bt!==$t&&Math.max(Bt,$t)/Math.min(Bt,$t)>1.5&&(Rt=!0)}Rt&&(f.canvasWidth=Y.vertical?ct.height:ct.width),tt._textDivProperties.set(et,f),tt._isReadableStream&&tt._layoutText(et)}function _t(tt){const{div:ct,scale:lt,properties:et,ctx:f,prevFontSize:_,prevFontFamily:pt}=tt,{style:Y}=ct;let g="";if(et.canvasWidth!==0&&et.hasText){const{fontFamily:ft}=Y,{canvasWidth:$,fontSize:Tt}=et;(_!==Tt||pt!==ft)&&(f.font=`${Tt*lt}px ${ft}`,tt.prevFontSize=Tt,tt.prevFontFamily=ft);const{width:wt}=f.measureText(ct.textContent);wt>0&&(g=`scaleX(${$*lt/wt})`)}et.angle!==0&&(g=`rotate(${et.angle}deg) ${g}`),g.length>0&&(Y.transform=g)}function dt(tt){if(tt._canceled)return;const ct=tt._textDivs,lt=tt._capability;if(ct.length>St){lt.resolve();return}if(!tt._isReadableStream)for(const f of ct)tt._layoutText(f);lt.resolve()}class st{constructor({textContentSource:ct,container:lt,viewport:et,textDivs:f,textDivProperties:_,textContentItemsStr:pt,isOffscreenCanvasSupported:Y}){var wt;this._textContentSource=ct,this._isReadableStream=ct instanceof ReadableStream,this._container=this._rootContainer=lt,this._textDivs=f||[],this._textContentItemsStr=pt||[],this._isOffscreenCanvasSupported=Y,this._fontInspectorEnabled=!!((wt=globalThis.FontInspector)!=null&&wt.enabled),this._reader=null,this._textDivProperties=_||new WeakMap,this._canceled=!1,this._capability=new i.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:et.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:rt(0,Y)};const{pageWidth:g,pageHeight:ft,pageX:$,pageY:Tt}=et.rawDims;this._transform=[1,0,0,-1,-$,Tt+ft],this._pageWidth=g,this._pageHeight=ft,(0,b.setLayerDimensions)(lt,et),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new i.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new i.AbortException("TextLayer task cancelled."))}_processItems(ct,lt){for(const et of ct){if(et.str===void 0){if(et.type==="beginMarkedContentProps"||et.type==="beginMarkedContent"){const f=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),et.id!==null&&this._container.setAttribute("id",`${et.id}`),f.append(this._container)}else et.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(et.str),mt(this,et,lt)}}_layoutText(ct){const lt=this._layoutTextParams.properties=this._textDivProperties.get(ct);if(this._layoutTextParams.div=ct,_t(this._layoutTextParams),lt.hasText&&this._container.append(ct),lt.hasEOL){const et=document.createElement("br");et.setAttribute("role","presentation"),this._container.append(et)}}_render(){const ct=new i.PromiseCapability;let lt=Object.create(null);if(this._isReadableStream){const et=()=>{this._reader.read().then(({value:f,done:_})=>{if(_){ct.resolve();return}Object.assign(lt,f.styles),this._processItems(f.items,lt),et()},ct.reject)};this._reader=this._textContentSource.getReader(),et()}else if(this._textContentSource){const{items:et,styles:f}=this._textContentSource;this._processItems(et,f),ct.resolve()}else throw new Error('No "textContentSource" parameter specified.');ct.promise.then(()=>{lt=null,dt(this)},this._capability.reject)}}e.TextLayerRenderTask=st;function nt(tt){!tt.textContentSource&&(tt.textContent||tt.textContentStream)&&((0,b.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),tt.textContentSource=tt.textContent||tt.textContentStream);const{container:ct,viewport:lt}=tt,et=getComputedStyle(ct),f=et.getPropertyValue("visibility"),_=parseFloat(et.getPropertyValue("--scale-factor"));f==="visible"&&(!_||Math.abs(_-lt.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const pt=new st(tt);return pt._render(),pt}function j({container:tt,viewport:ct,textDivs:lt,textDivProperties:et,isOffscreenCanvasSupported:f,mustRotate:_=!0,mustRescale:pt=!0}){if(_&&(0,b.setLayerDimensions)(tt,{rotation:ct.rotation}),pt){const Y=rt(0,f),ft={prevFontSize:null,prevFontFamily:null,div:null,scale:ct.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:Y};for(const $ of lt)ft.properties=et.get($),ft.div=$,_t(ft)}}},(d,e,ot)=>{var X,mt,_t,dt,st,nt,j,tt,ct,lt,et,Nn,_,un,Y,Bn,ft,Un;Object.defineProperty(e,"__esModule",{value:!0}),e.AnnotationEditorLayer=void 0;var i=ot(1),b=ot(4),St=ot(28),bt=ot(33),Wt=ot(6),ht=ot(34);const Tt=class Tt{constructor({uiManager:at,pageIndex:Rt,div:Bt,accessibilityManager:$t,annotationLayer:Pt,viewport:Vt,l10n:Jt}){Et(this,et);Et(this,_);Et(this,Y);Et(this,ft);Et(this,X,void 0);Et(this,mt,!1);Et(this,_t,null);Et(this,dt,this.pointerup.bind(this));Et(this,st,this.pointerdown.bind(this));Et(this,nt,new Map);Et(this,j,!1);Et(this,tt,!1);Et(this,ct,!1);Et(this,lt,void 0);const se=[St.FreeTextEditor,bt.InkEditor,ht.StampEditor];if(!Tt._initialized){Tt._initialized=!0;for(const re of se)re.initialize(Jt)}at.registerEditorTypes(se),Ut(this,lt,at),this.pageIndex=Rt,this.div=Bt,Ut(this,X,$t),Ut(this,_t,Pt),this.viewport=Vt,s(this,lt).addLayer(this)}get isEmpty(){return s(this,nt).size===0}updateToolbar(at){s(this,lt).updateToolbar(at)}updateMode(at=s(this,lt).getMode()){xt(this,ft,Un).call(this),at===i.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),at!==i.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",at===i.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",at===i.AnnotationEditorType.INK),this.div.classList.toggle("stampEditing",at===i.AnnotationEditorType.STAMP),this.div.hidden=!1)}addInkEditorIfNeeded(at){if(!at&&s(this,lt).getMode()!==i.AnnotationEditorType.INK)return;if(!at){for(const Bt of s(this,nt).values())if(Bt.isEmpty()){Bt.setInBackground();return}}xt(this,_,un).call(this,{offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(at){s(this,lt).setEditingState(at)}addCommands(at){s(this,lt).addCommands(at)}enable(){this.div.style.pointerEvents="auto";const at=new Set;for(const Bt of s(this,nt).values())Bt.enableEditing(),Bt.annotationElementId&&at.add(Bt.annotationElementId);if(!s(this,_t))return;const Rt=s(this,_t).getEditableAnnotations();for(const Bt of Rt){if(Bt.hide(),s(this,lt).isDeletedAnnotationElement(Bt.data.id)||at.has(Bt.data.id))continue;const $t=this.deserialize(Bt);$t&&(this.addOrRebuild($t),$t.enableEditing())}}disable(){var Rt;Ut(this,ct,!0),this.div.style.pointerEvents="none";const at=new Set;for(const Bt of s(this,nt).values()){if(Bt.disableEditing(),!Bt.annotationElementId||Bt.serialize()!==null){at.add(Bt.annotationElementId);continue}(Rt=this.getEditableAnnotation(Bt.annotationElementId))==null||Rt.show(),Bt.remove()}if(s(this,_t)){const Bt=s(this,_t).getEditableAnnotations();for(const $t of Bt){const{id:Pt}=$t.data;at.has(Pt)||s(this,lt).isDeletedAnnotationElement(Pt)||$t.show()}}xt(this,ft,Un).call(this),this.isEmpty&&(this.div.hidden=!0),Ut(this,ct,!1)}getEditableAnnotation(at){var Rt;return((Rt=s(this,_t))==null?void 0:Rt.getEditableAnnotation(at))||null}setActiveEditor(at){s(this,lt).getActive()!==at&&s(this,lt).setActiveEditor(at)}enableClick(){this.div.addEventListener("pointerdown",s(this,st)),this.div.addEventListener("pointerup",s(this,dt))}disableClick(){this.div.removeEventListener("pointerdown",s(this,st)),this.div.removeEventListener("pointerup",s(this,dt))}attach(at){s(this,nt).set(at.id,at);const{annotationElementId:Rt}=at;Rt&&s(this,lt).isDeletedAnnotationElement(Rt)&&s(this,lt).removeDeletedAnnotationElement(at)}detach(at){var Rt;s(this,nt).delete(at.id),(Rt=s(this,X))==null||Rt.removePointerInTextLayer(at.contentDiv),!s(this,ct)&&at.annotationElementId&&s(this,lt).addDeletedAnnotationElement(at)}remove(at){this.detach(at),s(this,lt).removeEditor(at),at.div.contains(document.activeElement)&&setTimeout(()=>{s(this,lt).focusMainContainer()},0),at.div.remove(),at.isAttachedToDOM=!1,s(this,tt)||this.addInkEditorIfNeeded(!1)}changeParent(at){var Rt;at.parent!==this&&(at.annotationElementId&&(s(this,lt).addDeletedAnnotationElement(at.annotationElementId),b.AnnotationEditor.deleteAnnotationElement(at),at.annotationElementId=null),this.attach(at),(Rt=at.parent)==null||Rt.detach(at),at.setParent(this),at.div&&at.isAttachedToDOM&&(at.div.remove(),this.div.append(at.div)))}add(at){if(this.changeParent(at),s(this,lt).addEditor(at),this.attach(at),!at.isAttachedToDOM){const Rt=at.render();this.div.append(Rt),at.isAttachedToDOM=!0}at.fixAndSetPosition(),at.onceAdded(),s(this,lt).addToAnnotationStorage(at)}moveEditorInDOM(at){var Bt;if(!at.isAttachedToDOM)return;const{activeElement:Rt}=document;at.div.contains(Rt)&&(at._focusEventsAllowed=!1,setTimeout(()=>{at.div.contains(document.activeElement)?at._focusEventsAllowed=!0:(at.div.addEventListener("focusin",()=>{at._focusEventsAllowed=!0},{once:!0}),Rt.focus())},0)),at._structTreeParentId=(Bt=s(this,X))==null?void 0:Bt.moveElementInDOM(this.div,at.div,at.contentDiv,!0)}addOrRebuild(at){at.needsToBeRebuilt()?at.rebuild():this.add(at)}addUndoableEditor(at){const Rt=()=>at._uiManager.rebuild(at),Bt=()=>{at.remove()};this.addCommands({cmd:Rt,undo:Bt,mustExec:!1})}getNextId(){return s(this,lt).getId()}pasteEditor(at,Rt){s(this,lt).updateToolbar(at),s(this,lt).updateMode(at);const{offsetX:Bt,offsetY:$t}=xt(this,Y,Bn).call(this),Pt=this.getNextId(),Vt=xt(this,et,Nn).call(this,{parent:this,id:Pt,x:Bt,y:$t,uiManager:s(this,lt),isCentered:!0,...Rt});Vt&&this.add(Vt)}deserialize(at){switch(at.annotationType??at.annotationEditorType){case i.AnnotationEditorType.FREETEXT:return St.FreeTextEditor.deserialize(at,this,s(this,lt));case i.AnnotationEditorType.INK:return bt.InkEditor.deserialize(at,this,s(this,lt));case i.AnnotationEditorType.STAMP:return ht.StampEditor.deserialize(at,this,s(this,lt))}return null}addNewEditor(){xt(this,_,un).call(this,xt(this,Y,Bn).call(this),!0)}setSelected(at){s(this,lt).setSelected(at)}toggleSelected(at){s(this,lt).toggleSelected(at)}isSelected(at){return s(this,lt).isSelected(at)}unselect(at){s(this,lt).unselect(at)}pointerup(at){const{isMac:Rt}=i.FeatureTest.platform;if(!(at.button!==0||at.ctrlKey&&Rt)&&at.target===this.div&&s(this,j)){if(Ut(this,j,!1),!s(this,mt)){Ut(this,mt,!0);return}if(s(this,lt).getMode()===i.AnnotationEditorType.STAMP){s(this,lt).unselectAll();return}xt(this,_,un).call(this,at,!1)}}pointerdown(at){if(s(this,j)){Ut(this,j,!1);return}const{isMac:Rt}=i.FeatureTest.platform;if(at.button!==0||at.ctrlKey&&Rt||at.target!==this.div)return;Ut(this,j,!0);const Bt=s(this,lt).getActive();Ut(this,mt,!Bt||Bt.isEmpty())}findNewParent(at,Rt,Bt){const $t=s(this,lt).findParent(Rt,Bt);return $t===null||$t===this?!1:($t.changeParent(at),!0)}destroy(){var at,Rt;((at=s(this,lt).getActive())==null?void 0:at.parent)===this&&(s(this,lt).commitOrRemove(),s(this,lt).setActiveEditor(null));for(const Bt of s(this,nt).values())(Rt=s(this,X))==null||Rt.removePointerInTextLayer(Bt.contentDiv),Bt.setParent(null),Bt.isAttachedToDOM=!1,Bt.div.remove();this.div=null,s(this,nt).clear(),s(this,lt).removeLayer(this)}render({viewport:at}){this.viewport=at,(0,Wt.setLayerDimensions)(this.div,at);for(const Rt of s(this,lt).getEditors(this.pageIndex))this.add(Rt);this.updateMode()}update({viewport:at}){s(this,lt).commitOrRemove(),this.viewport=at,(0,Wt.setLayerDimensions)(this.div,{rotation:at.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:at,pageHeight:Rt}=this.viewport.rawDims;return[at,Rt]}};X=new WeakMap,mt=new WeakMap,_t=new WeakMap,dt=new WeakMap,st=new WeakMap,nt=new WeakMap,j=new WeakMap,tt=new WeakMap,ct=new WeakMap,lt=new WeakMap,et=new WeakSet,Nn=function(at){switch(s(this,lt).getMode()){case i.AnnotationEditorType.FREETEXT:return new St.FreeTextEditor(at);case i.AnnotationEditorType.INK:return new bt.InkEditor(at);case i.AnnotationEditorType.STAMP:return new ht.StampEditor(at)}return null},_=new WeakSet,un=function(at,Rt){const Bt=this.getNextId(),$t=xt(this,et,Nn).call(this,{parent:this,id:Bt,x:at.offsetX,y:at.offsetY,uiManager:s(this,lt),isCentered:Rt});return $t&&this.add($t),$t},Y=new WeakSet,Bn=function(){const{x:at,y:Rt,width:Bt,height:$t}=this.div.getBoundingClientRect(),Pt=Math.max(0,at),Vt=Math.max(0,Rt),Jt=Math.min(window.innerWidth,at+Bt),se=Math.min(window.innerHeight,Rt+$t),re=(Pt+Jt)/2-at,ut=(Vt+se)/2-Rt,[o,h]=this.viewport.rotation%180===0?[re,ut]:[ut,re];return{offsetX:o,offsetY:h}},ft=new WeakSet,Un=function(){Ut(this,tt,!0);for(const at of s(this,nt).values())at.isEmpty()&&at.remove();Ut(this,tt,!1)},Ie(Tt,"_initialized",!1);let rt=Tt;e.AnnotationEditorLayer=rt},(d,e,ot)=>{var ht,rt,X,mt,_t,dt,st,nt,j,tt,ds,lt,fs,f,ps,pt,en,g,jn,$,gs,wt,Wn;Object.defineProperty(e,"__esModule",{value:!0}),e.FreeTextEditor=void 0;var i=ot(1),b=ot(5),St=ot(4),bt=ot(29);const Rt=class Rt extends St.AnnotationEditor{constructor(Pt){super({...Pt,name:"freeTextEditor"});Et(this,tt);Et(this,lt);Et(this,f);Et(this,pt);Et(this,g);Et(this,$);Et(this,wt);Et(this,ht,this.editorDivBlur.bind(this));Et(this,rt,this.editorDivFocus.bind(this));Et(this,X,this.editorDivInput.bind(this));Et(this,mt,this.editorDivKeydown.bind(this));Et(this,_t,void 0);Et(this,dt,"");Et(this,st,`${this.id}-editor`);Et(this,nt,void 0);Et(this,j,null);Ut(this,_t,Pt.color||Rt._defaultColor||St.AnnotationEditor._defaultLineColor),Ut(this,nt,Pt.fontSize||Rt._defaultFontSize)}static get _keyboardManager(){const Pt=Rt.prototype,Vt=re=>re.isEmpty(),Jt=b.AnnotationEditorUIManager.TRANSLATE_SMALL,se=b.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,i.shadow)(this,"_keyboardManager",new b.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],Pt.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],Pt.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],Pt._translateEmpty,{args:[-Jt,0],checker:Vt}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],Pt._translateEmpty,{args:[-se,0],checker:Vt}],[["ArrowRight","mac+ArrowRight"],Pt._translateEmpty,{args:[Jt,0],checker:Vt}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],Pt._translateEmpty,{args:[se,0],checker:Vt}],[["ArrowUp","mac+ArrowUp"],Pt._translateEmpty,{args:[0,-Jt],checker:Vt}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],Pt._translateEmpty,{args:[0,-se],checker:Vt}],[["ArrowDown","mac+ArrowDown"],Pt._translateEmpty,{args:[0,Jt],checker:Vt}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],Pt._translateEmpty,{args:[0,se],checker:Vt}]]))}static initialize(Pt){St.AnnotationEditor.initialize(Pt,{strings:["free_text2_default_content","editor_free_text2_aria_label"]});const Vt=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(Vt.getPropertyValue("--freetext-padding"))}static updateDefaultParams(Pt,Vt){switch(Pt){case i.AnnotationEditorParamsType.FREETEXT_SIZE:Rt._defaultFontSize=Vt;break;case i.AnnotationEditorParamsType.FREETEXT_COLOR:Rt._defaultColor=Vt;break}}updateParams(Pt,Vt){switch(Pt){case i.AnnotationEditorParamsType.FREETEXT_SIZE:xt(this,tt,ds).call(this,Vt);break;case i.AnnotationEditorParamsType.FREETEXT_COLOR:xt(this,lt,fs).call(this,Vt);break}}static get defaultPropertiesToUpdate(){return[[i.AnnotationEditorParamsType.FREETEXT_SIZE,Rt._defaultFontSize],[i.AnnotationEditorParamsType.FREETEXT_COLOR,Rt._defaultColor||St.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[i.AnnotationEditorParamsType.FREETEXT_SIZE,s(this,nt)],[i.AnnotationEditorParamsType.FREETEXT_COLOR,s(this,_t)]]}_translateEmpty(Pt,Vt){this._uiManager.translateSelectedEditors(Pt,Vt,!0)}getInitialTranslation(){const Pt=this.parentScale;return[-Rt._internalPadding*Pt,-(Rt._internalPadding+s(this,nt))*Pt]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(i.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",s(this,mt)),this.editorDiv.addEventListener("focus",s(this,rt)),this.editorDiv.addEventListener("blur",s(this,ht)),this.editorDiv.addEventListener("input",s(this,X)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",s(this,st)),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",s(this,mt)),this.editorDiv.removeEventListener("focus",s(this,rt)),this.editorDiv.removeEventListener("blur",s(this,ht)),this.editorDiv.removeEventListener("input",s(this,X)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(Pt){this._focusEventsAllowed&&(super.focusin(Pt),Pt.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){var Pt;if(this.width){xt(this,wt,Wn).call(this);return}this.enableEditMode(),this.editorDiv.focus(),(Pt=this._initialOptions)!=null&&Pt.isCentered&&this.center(),this._initialOptions=null}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const Pt=s(this,dt),Vt=Ut(this,dt,xt(this,f,ps).call(this).trimEnd());if(Pt===Vt)return;const Jt=se=>{if(Ut(this,dt,se),!se){this.remove();return}xt(this,g,jn).call(this),this._uiManager.rebuild(this),xt(this,pt,en).call(this)};this.addCommands({cmd:()=>{Jt(Vt)},undo:()=>{Jt(Pt)},mustExec:!1}),xt(this,pt,en).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(Pt){this.enterInEditMode()}keydown(Pt){Pt.target===this.div&&Pt.key==="Enter"&&(this.enterInEditMode(),Pt.preventDefault())}editorDivKeydown(Pt){Rt._keyboardManager.exec(this,Pt)}editorDivFocus(Pt){this.isEditing=!0}editorDivBlur(Pt){this.isEditing=!1}editorDivInput(Pt){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let Pt,Vt;this.width&&(Pt=this.x,Vt=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",s(this,st)),this.enableEditing(),St.AnnotationEditor._l10nPromise.get("editor_free_text2_aria_label").then(se=>{var re;return(re=this.editorDiv)==null?void 0:re.setAttribute("aria-label",se)}),St.AnnotationEditor._l10nPromise.get("free_text2_default_content").then(se=>{var re;return(re=this.editorDiv)==null?void 0:re.setAttribute("default-content",se)}),this.editorDiv.contentEditable=!0;const{style:Jt}=this.editorDiv;if(Jt.fontSize=`calc(${s(this,nt)}px * var(--scale-factor))`,Jt.color=s(this,_t),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,b.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[se,re]=this.parentDimensions;if(this.annotationElementId){const{position:ut}=s(this,j);let[o,h]=this.getInitialTranslation();[o,h]=this.pageTranslationToScreen(o,h);const[c,m]=this.pageDimensions,[k,it]=this.pageTranslation;let gt,vt;switch(this.rotation){case 0:gt=Pt+(ut[0]-k)/c,vt=Vt+this.height-(ut[1]-it)/m;break;case 90:gt=Pt+(ut[0]-k)/c,vt=Vt-(ut[1]-it)/m,[o,h]=[h,-o];break;case 180:gt=Pt-this.width+(ut[0]-k)/c,vt=Vt-(ut[1]-it)/m,[o,h]=[-o,-h];break;case 270:gt=Pt+(ut[0]-k-this.height*m)/c,vt=Vt+(ut[1]-it-this.width*c)/m,[o,h]=[-h,o];break}this.setAt(gt*se,vt*re,o,h)}else this.setAt(Pt*se,Vt*re,this.width*se,this.height*re);xt(this,g,jn).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(Pt,Vt,Jt){let se=null;if(Pt instanceof bt.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:ut,fontColor:o},rect:h,rotation:c,id:m},textContent:k,textPosition:it,parent:{page:{pageNumber:gt}}}=Pt;if(!k||k.length===0)return null;se=Pt={annotationType:i.AnnotationEditorType.FREETEXT,color:Array.from(o),fontSize:ut,value:k.join(`
`),position:it,pageIndex:gt-1,rect:h,rotation:c,id:m,deleted:!1}}const re=super.deserialize(Pt,Vt,Jt);return Ut(re,nt,Pt.fontSize),Ut(re,_t,i.Util.makeHexColor(...Pt.color)),Ut(re,dt,Pt.value),re.annotationElementId=Pt.id||null,Ut(re,j,se),re}serialize(Pt=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const Vt=Rt._internalPadding*this.parentScale,Jt=this.getRect(Vt,Vt),se=St.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:s(this,_t)),re={annotationType:i.AnnotationEditorType.FREETEXT,color:se,fontSize:s(this,nt),value:s(this,dt),pageIndex:this.pageIndex,rect:Jt,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return Pt?re:this.annotationElementId&&!xt(this,$,gs).call(this,re)?null:(re.id=this.annotationElementId,re)}};ht=new WeakMap,rt=new WeakMap,X=new WeakMap,mt=new WeakMap,_t=new WeakMap,dt=new WeakMap,st=new WeakMap,nt=new WeakMap,j=new WeakMap,tt=new WeakSet,ds=function(Pt){const Vt=se=>{this.editorDiv.style.fontSize=`calc(${se}px * var(--scale-factor))`,this.translate(0,-(se-s(this,nt))*this.parentScale),Ut(this,nt,se),xt(this,pt,en).call(this)},Jt=s(this,nt);this.addCommands({cmd:()=>{Vt(Pt)},undo:()=>{Vt(Jt)},mustExec:!0,type:i.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},lt=new WeakSet,fs=function(Pt){const Vt=s(this,_t);this.addCommands({cmd:()=>{Ut(this,_t,this.editorDiv.style.color=Pt)},undo:()=>{Ut(this,_t,this.editorDiv.style.color=Vt)},mustExec:!0,type:i.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},f=new WeakSet,ps=function(){const Pt=this.editorDiv.getElementsByTagName("div");if(Pt.length===0)return this.editorDiv.innerText;const Vt=[];for(const Jt of Pt)Vt.push(Jt.innerText.replace(/\r\n?|\n/,""));return Vt.join(`
`)},pt=new WeakSet,en=function(){const[Pt,Vt]=this.parentDimensions;let Jt;if(this.isAttachedToDOM)Jt=this.div.getBoundingClientRect();else{const{currentLayer:se,div:re}=this,ut=re.style.display;re.style.display="hidden",se.div.append(this.div),Jt=re.getBoundingClientRect(),re.remove(),re.style.display=ut}this.rotation%180===this.parentRotation%180?(this.width=Jt.width/Pt,this.height=Jt.height/Vt):(this.width=Jt.height/Pt,this.height=Jt.width/Vt),this.fixAndSetPosition()},g=new WeakSet,jn=function(){if(this.editorDiv.replaceChildren(),!!s(this,dt))for(const Pt of s(this,dt).split(`
`)){const Vt=document.createElement("div");Vt.append(Pt?document.createTextNode(Pt):document.createElement("br")),this.editorDiv.append(Vt)}},$=new WeakSet,gs=function(Pt){const{value:Vt,fontSize:Jt,color:se,rect:re,pageIndex:ut}=s(this,j);return Pt.value!==Vt||Pt.fontSize!==Jt||Pt.rect.some((o,h)=>Math.abs(o-re[h])>=1)||Pt.color.some((o,h)=>o!==se[h])||Pt.pageIndex!==ut},wt=new WeakSet,Wn=function(Pt=!1){if(!this.annotationElementId)return;if(xt(this,pt,en).call(this),!Pt&&(this.width===0||this.height===0)){setTimeout(()=>xt(this,wt,Wn).call(this,!0),0);return}const Vt=Rt._internalPadding*this.parentScale;s(this,j).rect=this.getRect(Vt,Vt)},Ie(Rt,"_freeTextDefaultContent",""),Ie(Rt,"_internalPadding",0),Ie(Rt,"_defaultColor",null),Ie(Rt,"_defaultFontSize",10),Ie(Rt,"_type","freetext");let Wt=Rt;e.FreeTextEditor=Wt},(d,e,ot)=>{var h,m,Ge,it,ms,vt,Nt,Lt,jt,zt,Yt,Gt,le,ge,ne,pe,Kt,Ot,It,Xt,ae,oe,Ae,bs,ve,dn,Te,Hn,Ce,$n,Dt,kt,Zt,ee,Oe,Le,Mt,Gn,be,ce,_e,ye,_s,te,Vn;Object.defineProperty(e,"__esModule",{value:!0}),e.StampAnnotationElement=e.InkAnnotationElement=e.FreeTextAnnotationElement=e.AnnotationLayer=void 0;var i=ot(1),b=ot(6),St=ot(3),bt=ot(30),Wt=ot(31),ht=ot(32);const rt=1e3,X=9,mt=new WeakSet;function _t(me){return{width:me[2]-me[0],height:me[3]-me[1]}}class dt{static create(yt){switch(yt.data.annotationType){case i.AnnotationType.LINK:return new nt(yt);case i.AnnotationType.TEXT:return new j(yt);case i.AnnotationType.WIDGET:switch(yt.data.fieldType){case"Tx":return new ct(yt);case"Btn":return yt.data.radioButton?new f(yt):yt.data.checkBox?new et(yt):new _(yt);case"Ch":return new pt(yt);case"Sig":return new lt(yt)}return new tt(yt);case i.AnnotationType.POPUP:return new Y(yt);case i.AnnotationType.FREETEXT:return new ft(yt);case i.AnnotationType.LINE:return new $(yt);case i.AnnotationType.SQUARE:return new Tt(yt);case i.AnnotationType.CIRCLE:return new wt(yt);case i.AnnotationType.POLYLINE:return new at(yt);case i.AnnotationType.CARET:return new Bt(yt);case i.AnnotationType.INK:return new $t(yt);case i.AnnotationType.POLYGON:return new Rt(yt);case i.AnnotationType.HIGHLIGHT:return new Pt(yt);case i.AnnotationType.UNDERLINE:return new Vt(yt);case i.AnnotationType.SQUIGGLY:return new Jt(yt);case i.AnnotationType.STRIKEOUT:return new se(yt);case i.AnnotationType.STAMP:return new re(yt);case i.AnnotationType.FILEATTACHMENT:return new ut(yt);default:return new st(yt)}}}const c=class c{constructor(yt,{isRenderable:a=!1,ignoreBorder:Z=!1,createQuadrilaterals:At=!1}={}){Et(this,h,!1);this.isRenderable=a,this.data=yt.data,this.layer=yt.layer,this.linkService=yt.linkService,this.downloadManager=yt.downloadManager,this.imageResourcesPath=yt.imageResourcesPath,this.renderForms=yt.renderForms,this.svgFactory=yt.svgFactory,this.annotationStorage=yt.annotationStorage,this.enableScripting=yt.enableScripting,this.hasJSActions=yt.hasJSActions,this._fieldObjects=yt.fieldObjects,this.parent=yt.parent,a&&(this.container=this._createContainer(Z)),At&&this._createQuadrilaterals()}static _hasPopupData({titleObj:yt,contentsObj:a,richText:Z}){return!!(yt!=null&&yt.str||a!=null&&a.str||Z!=null&&Z.str)}get hasPopupData(){return c._hasPopupData(this.data)}_createContainer(yt){const{data:a,parent:{page:Z,viewport:At}}=this,Ct=document.createElement("section");Ct.setAttribute("data-annotation-id",a.id),this instanceof tt||(Ct.tabIndex=rt),Ct.style.zIndex=this.parent.zIndex++,this.data.popupRef&&Ct.setAttribute("aria-haspopup","dialog"),a.noRotate&&Ct.classList.add("norotate");const{pageWidth:Ft,pageHeight:Ht,pageX:Qt,pageY:ue}=At.rawDims;if(!a.rect||this instanceof Y){const{rotation:Se}=a;return!a.hasOwnCanvas&&Se!==0&&this.setRotation(Se,Ct),Ct}const{width:he,height:xe}=_t(a.rect),de=i.Util.normalizeRect([a.rect[0],Z.view[3]-a.rect[1]+Z.view[1],a.rect[2],Z.view[3]-a.rect[3]+Z.view[1]]);if(!yt&&a.borderStyle.width>0){Ct.style.borderWidth=`${a.borderStyle.width}px`;const Se=a.borderStyle.horizontalCornerRadius,Re=a.borderStyle.verticalCornerRadius;if(Se>0||Re>0){const De=`calc(${Se}px * var(--scale-factor)) / calc(${Re}px * var(--scale-factor))`;Ct.style.borderRadius=De}else if(this instanceof f){const De=`calc(${he}px * var(--scale-factor)) / calc(${xe}px * var(--scale-factor))`;Ct.style.borderRadius=De}switch(a.borderStyle.style){case i.AnnotationBorderStyleType.SOLID:Ct.style.borderStyle="solid";break;case i.AnnotationBorderStyleType.DASHED:Ct.style.borderStyle="dashed";break;case i.AnnotationBorderStyleType.BEVELED:(0,i.warn)("Unimplemented border style: beveled");break;case i.AnnotationBorderStyleType.INSET:(0,i.warn)("Unimplemented border style: inset");break;case i.AnnotationBorderStyleType.UNDERLINE:Ct.style.borderBottomStyle="solid";break}const Fe=a.borderColor||null;Fe?(Ut(this,h,!0),Ct.style.borderColor=i.Util.makeHexColor(Fe[0]|0,Fe[1]|0,Fe[2]|0)):Ct.style.borderWidth=0}Ct.style.left=`${100*(de[0]-Qt)/Ft}%`,Ct.style.top=`${100*(de[1]-ue)/Ht}%`;const{rotation:fe}=a;return a.hasOwnCanvas||fe===0?(Ct.style.width=`${100*he/Ft}%`,Ct.style.height=`${100*xe/Ht}%`):this.setRotation(fe,Ct),Ct}setRotation(yt,a=this.container){if(!this.data.rect)return;const{pageWidth:Z,pageHeight:At}=this.parent.viewport.rawDims,{width:Ct,height:Ft}=_t(this.data.rect);let Ht,Qt;yt%180===0?(Ht=100*Ct/Z,Qt=100*Ft/At):(Ht=100*Ft/Z,Qt=100*Ct/At),a.style.width=`${Ht}%`,a.style.height=`${Qt}%`,a.setAttribute("data-main-rotation",(360-yt)%360)}get _commonActions(){const yt=(a,Z,At)=>{const Ct=At.detail[a],Ft=Ct[0],Ht=Ct.slice(1);At.target.style[Z]=bt.ColorConverters[`${Ft}_HTML`](Ht),this.annotationStorage.setValue(this.data.id,{[Z]:bt.ColorConverters[`${Ft}_rgb`](Ht)})};return(0,i.shadow)(this,"_commonActions",{display:a=>{const{display:Z}=a.detail,At=Z%2===1;this.container.style.visibility=At?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:At,noPrint:Z===1||Z===2})},print:a=>{this.annotationStorage.setValue(this.data.id,{noPrint:!a.detail.print})},hidden:a=>{const{hidden:Z}=a.detail;this.container.style.visibility=Z?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:Z,noView:Z})},focus:a=>{setTimeout(()=>a.target.focus({preventScroll:!1}),0)},userName:a=>{a.target.title=a.detail.userName},readonly:a=>{a.target.disabled=a.detail.readonly},required:a=>{this._setRequired(a.target,a.detail.required)},bgColor:a=>{yt("bgColor","backgroundColor",a)},fillColor:a=>{yt("fillColor","backgroundColor",a)},fgColor:a=>{yt("fgColor","color",a)},textColor:a=>{yt("textColor","color",a)},borderColor:a=>{yt("borderColor","borderColor",a)},strokeColor:a=>{yt("strokeColor","borderColor",a)},rotation:a=>{const Z=a.detail.rotation;this.setRotation(Z),this.annotationStorage.setValue(this.data.id,{rotation:Z})}})}_dispatchEventFromSandbox(yt,a){const Z=this._commonActions;for(const At of Object.keys(a.detail)){const Ct=yt[At]||Z[At];Ct==null||Ct(a)}}_setDefaultPropertiesFromJS(yt){if(!this.enableScripting)return;const a=this.annotationStorage.getRawValue(this.data.id);if(!a)return;const Z=this._commonActions;for(const[At,Ct]of Object.entries(a)){const Ft=Z[At];if(Ft){const Ht={detail:{[At]:Ct},target:yt};Ft(Ht),delete a[At]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:yt}=this.data;if(!yt)return;const[a,Z,At,Ct]=this.data.rect;if(yt.length===1){const[,{x:Re,y:Fe},{x:De,y:Be}]=yt[0];if(At===Re&&Ct===Fe&&a===De&&Z===Be)return}const{style:Ft}=this.container;let Ht;if(s(this,h)){const{borderColor:Re,borderWidth:Fe}=Ft;Ft.borderWidth=0,Ht=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${Re}" stroke-width="${Fe}">`],this.container.classList.add("hasBorder")}const Qt=At-a,ue=Ct-Z,{svgFactory:he}=this,xe=he.createElement("svg");xe.classList.add("quadrilateralsContainer"),xe.setAttribute("width",0),xe.setAttribute("height",0);const de=he.createElement("defs");xe.append(de);const fe=he.createElement("clipPath"),Se=`clippath_${this.data.id}`;fe.setAttribute("id",Se),fe.setAttribute("clipPathUnits","objectBoundingBox"),de.append(fe);for(const[,{x:Re,y:Fe},{x:De,y:Be}]of yt){const Ne=he.createElement("rect"),Ue=(De-a)/Qt,He=(Ct-Fe)/ue,$e=(Re-De)/Qt,ts=(Fe-Be)/ue;Ne.setAttribute("x",Ue),Ne.setAttribute("y",He),Ne.setAttribute("width",$e),Ne.setAttribute("height",ts),fe.append(Ne),Ht==null||Ht.push(`<rect vector-effect="non-scaling-stroke" x="${Ue}" y="${He}" width="${$e}" height="${ts}"/>`)}s(this,h)&&(Ht.push("</g></svg>')"),Ft.backgroundImage=Ht.join("")),this.container.append(xe),this.container.style.clipPath=`url(#${Se})`}_createPopup(){const{container:yt,data:a}=this;yt.setAttribute("aria-haspopup","dialog");const Z=new Y({data:{color:a.color,titleObj:a.titleObj,modificationDate:a.modificationDate,contentsObj:a.contentsObj,richText:a.richText,parentRect:a.rect,borderStyle:0,id:`popup_${a.id}`,rotation:a.rotation},parent:this.parent,elements:[this]});this.parent.div.append(Z.render())}render(){(0,i.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(yt,a=null){const Z=[];if(this._fieldObjects){const At=this._fieldObjects[yt];if(At)for(const{page:Ct,id:Ft,exportValues:Ht}of At){if(Ct===-1||Ft===a)continue;const Qt=typeof Ht=="string"?Ht:null,ue=document.querySelector(`[data-element-id="${Ft}"]`);if(ue&&!mt.has(ue)){(0,i.warn)(`_getElementsByName - element not allowed: ${Ft}`);continue}Z.push({id:Ft,exportValue:Qt,domElement:ue})}return Z}for(const At of document.getElementsByName(yt)){const{exportValue:Ct}=At,Ft=At.getAttribute("data-element-id");Ft!==a&&mt.has(At)&&Z.push({id:Ft,exportValue:Ct,domElement:At})}return Z}show(){var yt;this.container&&(this.container.hidden=!1),(yt=this.popup)==null||yt.maybeShow()}hide(){var yt;this.container&&(this.container.hidden=!0),(yt=this.popup)==null||yt.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const yt=this.getElementsToTriggerPopup();if(Array.isArray(yt))for(const a of yt)a.classList.add("highlightArea");else yt.classList.add("highlightArea")}_editOnDoubleClick(){const{annotationEditorType:yt,data:{id:a}}=this;this.container.addEventListener("dblclick",()=>{var Z;(Z=this.linkService.eventBus)==null||Z.dispatch("switchannotationeditormode",{source:this,mode:yt,editId:a})})}};h=new WeakMap;let st=c;class nt extends st{constructor(a,Z=null){super(a,{isRenderable:!0,ignoreBorder:!!(Z!=null&&Z.ignoreBorder),createQuadrilaterals:!0});Et(this,m);Et(this,it);this.isTooltipOnly=a.data.isTooltipOnly}render(){const{data:a,linkService:Z}=this,At=document.createElement("a");At.setAttribute("data-element-id",a.id);let Ct=!1;return a.url?(Z.addLinkAttributes(At,a.url,a.newWindow),Ct=!0):a.action?(this._bindNamedAction(At,a.action),Ct=!0):a.attachment?(this._bindAttachment(At,a.attachment),Ct=!0):a.setOCGState?(xt(this,it,ms).call(this,At,a.setOCGState),Ct=!0):a.dest?(this._bindLink(At,a.dest),Ct=!0):(a.actions&&(a.actions.Action||a.actions["Mouse Up"]||a.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(At,a),Ct=!0),a.resetForm?(this._bindResetFormAction(At,a.resetForm),Ct=!0):this.isTooltipOnly&&!Ct&&(this._bindLink(At,""),Ct=!0)),this.container.classList.add("linkAnnotation"),Ct&&this.container.append(At),this.container}_bindLink(a,Z){a.href=this.linkService.getDestinationHash(Z),a.onclick=()=>(Z&&this.linkService.goToDestination(Z),!1),(Z||Z==="")&&xt(this,m,Ge).call(this)}_bindNamedAction(a,Z){a.href=this.linkService.getAnchorUrl(""),a.onclick=()=>(this.linkService.executeNamedAction(Z),!1),xt(this,m,Ge).call(this)}_bindAttachment(a,Z){a.href=this.linkService.getAnchorUrl(""),a.onclick=()=>{var At;return(At=this.downloadManager)==null||At.openOrDownloadData(this.container,Z.content,Z.filename),!1},xt(this,m,Ge).call(this)}_bindJSAction(a,Z){a.href=this.linkService.getAnchorUrl("");const At=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const Ct of Object.keys(Z.actions)){const Ft=At.get(Ct);Ft&&(a[Ft]=()=>{var Ht;return(Ht=this.linkService.eventBus)==null||Ht.dispatch("dispatcheventinsandbox",{source:this,detail:{id:Z.id,name:Ct}}),!1})}a.onclick||(a.onclick=()=>!1),xt(this,m,Ge).call(this)}_bindResetFormAction(a,Z){const At=a.onclick;if(At||(a.href=this.linkService.getAnchorUrl("")),xt(this,m,Ge).call(this),!this._fieldObjects){(0,i.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),At||(a.onclick=()=>!1);return}a.onclick=()=>{var xe;At==null||At();const{fields:Ct,refs:Ft,include:Ht}=Z,Qt=[];if(Ct.length!==0||Ft.length!==0){const de=new Set(Ft);for(const fe of Ct){const Se=this._fieldObjects[fe]||[];for(const{id:Re}of Se)de.add(Re)}for(const fe of Object.values(this._fieldObjects))for(const Se of fe)de.has(Se.id)===Ht&&Qt.push(Se)}else for(const de of Object.values(this._fieldObjects))Qt.push(...de);const ue=this.annotationStorage,he=[];for(const de of Qt){const{id:fe}=de;switch(he.push(fe),de.type){case"text":{const Re=de.defaultValue||"";ue.setValue(fe,{value:Re});break}case"checkbox":case"radiobutton":{const Re=de.defaultValue===de.exportValues;ue.setValue(fe,{value:Re});break}case"combobox":case"listbox":{const Re=de.defaultValue||"";ue.setValue(fe,{value:Re});break}default:continue}const Se=document.querySelector(`[data-element-id="${fe}"]`);if(Se){if(!mt.has(Se)){(0,i.warn)(`_bindResetFormAction - element not allowed: ${fe}`);continue}}else continue;Se.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((xe=this.linkService.eventBus)==null||xe.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:he,name:"ResetForm"}})),!1}}}m=new WeakSet,Ge=function(){this.container.setAttribute("data-internal-link","")},it=new WeakSet,ms=function(a,Z){a.href=this.linkService.getAnchorUrl(""),a.onclick=()=>(this.linkService.executeSetOCGState(Z),!1),xt(this,m,Ge).call(this)};class j extends st{constructor(yt){super(yt,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const yt=document.createElement("img");return yt.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",yt.alt="[{{type}} Annotation]",yt.dataset.l10nId="text_annotation_type",yt.dataset.l10nArgs=JSON.stringify({type:this.data.name}),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(yt),this.container}}class tt extends st{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(yt){var a;this.data.hasOwnCanvas&&(((a=yt.previousSibling)==null?void 0:a.nodeName)==="CANVAS"&&(yt.previousSibling.hidden=!0),yt.hidden=!1)}_getKeyModifier(yt){const{isWin:a,isMac:Z}=i.FeatureTest.platform;return a&&yt.ctrlKey||Z&&yt.metaKey}_setEventListener(yt,a,Z,At,Ct){Z.includes("mouse")?yt.addEventListener(Z,Ft=>{var Ht;(Ht=this.linkService.eventBus)==null||Ht.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:At,value:Ct(Ft),shift:Ft.shiftKey,modifier:this._getKeyModifier(Ft)}})}):yt.addEventListener(Z,Ft=>{var Ht;if(Z==="blur"){if(!a.focused||!Ft.relatedTarget)return;a.focused=!1}else if(Z==="focus"){if(a.focused)return;a.focused=!0}Ct&&((Ht=this.linkService.eventBus)==null||Ht.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:At,value:Ct(Ft)}}))})}_setEventListeners(yt,a,Z,At){var Ct,Ft,Ht;for(const[Qt,ue]of Z)(ue==="Action"||(Ct=this.data.actions)!=null&&Ct[ue])&&((ue==="Focus"||ue==="Blur")&&(a||(a={focused:!1})),this._setEventListener(yt,a,Qt,ue,At),ue==="Focus"&&!((Ft=this.data.actions)!=null&&Ft.Blur)?this._setEventListener(yt,a,"blur","Blur",null):ue==="Blur"&&!((Ht=this.data.actions)!=null&&Ht.Focus)&&this._setEventListener(yt,a,"focus","Focus",null))}_setBackgroundColor(yt){const a=this.data.backgroundColor||null;yt.style.backgroundColor=a===null?"transparent":i.Util.makeHexColor(a[0],a[1],a[2])}_setTextStyle(yt){const a=["left","center","right"],{fontColor:Z}=this.data.defaultAppearanceData,At=this.data.defaultAppearanceData.fontSize||X,Ct=yt.style;let Ft;const Ht=2,Qt=ue=>Math.round(10*ue)/10;if(this.data.multiLine){const ue=Math.abs(this.data.rect[3]-this.data.rect[1]-Ht),he=Math.round(ue/(i.LINE_FACTOR*At))||1,xe=ue/he;Ft=Math.min(At,Qt(xe/i.LINE_FACTOR))}else{const ue=Math.abs(this.data.rect[3]-this.data.rect[1]-Ht);Ft=Math.min(At,Qt(ue/i.LINE_FACTOR))}Ct.fontSize=`calc(${Ft}px * var(--scale-factor))`,Ct.color=i.Util.makeHexColor(Z[0],Z[1],Z[2]),this.data.textAlignment!==null&&(Ct.textAlign=a[this.data.textAlignment])}_setRequired(yt,a){a?yt.setAttribute("required",!0):yt.removeAttribute("required"),yt.setAttribute("aria-required",a)}}class ct extends tt{constructor(yt){const a=yt.renderForms||!yt.data.hasAppearance&&!!yt.data.fieldValue;super(yt,{isRenderable:a})}setPropertyOnSiblings(yt,a,Z,At){const Ct=this.annotationStorage;for(const Ft of this._getElementsByName(yt.name,yt.id))Ft.domElement&&(Ft.domElement[a]=Z),Ct.setValue(Ft.id,{[At]:Z})}render(){var At,Ct;const yt=this.annotationStorage,a=this.data.id;this.container.classList.add("textWidgetAnnotation");let Z=null;if(this.renderForms){const Ft=yt.getValue(a,{value:this.data.fieldValue});let Ht=Ft.value||"";const Qt=yt.getValue(a,{charLimit:this.data.maxLen}).charLimit;Qt&&Ht.length>Qt&&(Ht=Ht.slice(0,Qt));let ue=Ft.formattedValue||((At=this.data.textContent)==null?void 0:At.join(`
`))||null;ue&&this.data.comb&&(ue=ue.replaceAll(/\s+/g,""));const he={userValue:Ht,formattedValue:ue,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(Z=document.createElement("textarea"),Z.textContent=ue??Ht,this.data.doNotScroll&&(Z.style.overflowY="hidden")):(Z=document.createElement("input"),Z.type="text",Z.setAttribute("value",ue??Ht),this.data.doNotScroll&&(Z.style.overflowX="hidden")),this.data.hasOwnCanvas&&(Z.hidden=!0),mt.add(Z),Z.setAttribute("data-element-id",a),Z.disabled=this.data.readOnly,Z.name=this.data.fieldName,Z.tabIndex=rt,this._setRequired(Z,this.data.required),Qt&&(Z.maxLength=Qt),Z.addEventListener("input",de=>{yt.setValue(a,{value:de.target.value}),this.setPropertyOnSiblings(Z,"value",de.target.value,"value"),he.formattedValue=null}),Z.addEventListener("resetform",de=>{const fe=this.data.defaultFieldValue??"";Z.value=he.userValue=fe,he.formattedValue=null});let xe=de=>{const{formattedValue:fe}=he;fe!=null&&(de.target.value=fe),de.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){Z.addEventListener("focus",fe=>{if(he.focused)return;const{target:Se}=fe;he.userValue&&(Se.value=he.userValue),he.lastCommittedValue=Se.value,he.commitKey=1,he.focused=!0}),Z.addEventListener("updatefromsandbox",fe=>{this.showElementAndHideCanvas(fe.target);const Se={value(Re){he.userValue=Re.detail.value??"",yt.setValue(a,{value:he.userValue.toString()}),Re.target.value=he.userValue},formattedValue(Re){const{formattedValue:Fe}=Re.detail;he.formattedValue=Fe,Fe!=null&&Re.target!==document.activeElement&&(Re.target.value=Fe),yt.setValue(a,{formattedValue:Fe})},selRange(Re){Re.target.setSelectionRange(...Re.detail.selRange)},charLimit:Re=>{var Ne;const{charLimit:Fe}=Re.detail,{target:De}=Re;if(Fe===0){De.removeAttribute("maxLength");return}De.setAttribute("maxLength",Fe);let Be=he.userValue;!Be||Be.length<=Fe||(Be=Be.slice(0,Fe),De.value=he.userValue=Be,yt.setValue(a,{value:Be}),(Ne=this.linkService.eventBus)==null||Ne.dispatch("dispatcheventinsandbox",{source:this,detail:{id:a,name:"Keystroke",value:Be,willCommit:!0,commitKey:1,selStart:De.selectionStart,selEnd:De.selectionEnd}}))}};this._dispatchEventFromSandbox(Se,fe)}),Z.addEventListener("keydown",fe=>{var Fe;he.commitKey=1;let Se=-1;if(fe.key==="Escape"?Se=0:fe.key==="Enter"&&!this.data.multiLine?Se=2:fe.key==="Tab"&&(he.commitKey=3),Se===-1)return;const{value:Re}=fe.target;he.lastCommittedValue!==Re&&(he.lastCommittedValue=Re,he.userValue=Re,(Fe=this.linkService.eventBus)==null||Fe.dispatch("dispatcheventinsandbox",{source:this,detail:{id:a,name:"Keystroke",value:Re,willCommit:!0,commitKey:Se,selStart:fe.target.selectionStart,selEnd:fe.target.selectionEnd}}))});const de=xe;xe=null,Z.addEventListener("blur",fe=>{var Re;if(!he.focused||!fe.relatedTarget)return;he.focused=!1;const{value:Se}=fe.target;he.userValue=Se,he.lastCommittedValue!==Se&&((Re=this.linkService.eventBus)==null||Re.dispatch("dispatcheventinsandbox",{source:this,detail:{id:a,name:"Keystroke",value:Se,willCommit:!0,commitKey:he.commitKey,selStart:fe.target.selectionStart,selEnd:fe.target.selectionEnd}})),de(fe)}),(Ct=this.data.actions)!=null&&Ct.Keystroke&&Z.addEventListener("beforeinput",fe=>{var He;he.lastCommittedValue=null;const{data:Se,target:Re}=fe,{value:Fe,selectionStart:De,selectionEnd:Be}=Re;let Ne=De,Ue=Be;switch(fe.inputType){case"deleteWordBackward":{const $e=Fe.substring(0,De).match(/\w*[^\w]*$/);$e&&(Ne-=$e[0].length);break}case"deleteWordForward":{const $e=Fe.substring(De).match(/^[^\w]*\w*/);$e&&(Ue+=$e[0].length);break}case"deleteContentBackward":De===Be&&(Ne-=1);break;case"deleteContentForward":De===Be&&(Ue+=1);break}fe.preventDefault(),(He=this.linkService.eventBus)==null||He.dispatch("dispatcheventinsandbox",{source:this,detail:{id:a,name:"Keystroke",value:Fe,change:Se||"",willCommit:!1,selStart:Ne,selEnd:Ue}})}),this._setEventListeners(Z,he,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],fe=>fe.target.value)}if(xe&&Z.addEventListener("blur",xe),this.data.comb){const fe=(this.data.rect[2]-this.data.rect[0])/Qt;Z.classList.add("comb"),Z.style.letterSpacing=`calc(${fe}px * var(--scale-factor) - 1ch)`}}else Z=document.createElement("div"),Z.textContent=this.data.fieldValue,Z.style.verticalAlign="middle",Z.style.display="table-cell";return this._setTextStyle(Z),this._setBackgroundColor(Z),this._setDefaultPropertiesFromJS(Z),this.container.append(Z),this.container}}class lt extends tt{constructor(yt){super(yt,{isRenderable:!!yt.data.hasOwnCanvas})}}class et extends tt{constructor(yt){super(yt,{isRenderable:yt.renderForms})}render(){const yt=this.annotationStorage,a=this.data,Z=a.id;let At=yt.getValue(Z,{value:a.exportValue===a.fieldValue}).value;typeof At=="string"&&(At=At!=="Off",yt.setValue(Z,{value:At})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const Ct=document.createElement("input");return mt.add(Ct),Ct.setAttribute("data-element-id",Z),Ct.disabled=a.readOnly,this._setRequired(Ct,this.data.required),Ct.type="checkbox",Ct.name=a.fieldName,At&&Ct.setAttribute("checked",!0),Ct.setAttribute("exportValue",a.exportValue),Ct.tabIndex=rt,Ct.addEventListener("change",Ft=>{const{name:Ht,checked:Qt}=Ft.target;for(const ue of this._getElementsByName(Ht,Z)){const he=Qt&&ue.exportValue===a.exportValue;ue.domElement&&(ue.domElement.checked=he),yt.setValue(ue.id,{value:he})}yt.setValue(Z,{value:Qt})}),Ct.addEventListener("resetform",Ft=>{const Ht=a.defaultFieldValue||"Off";Ft.target.checked=Ht===a.exportValue}),this.enableScripting&&this.hasJSActions&&(Ct.addEventListener("updatefromsandbox",Ft=>{const Ht={value(Qt){Qt.target.checked=Qt.detail.value!=="Off",yt.setValue(Z,{value:Qt.target.checked})}};this._dispatchEventFromSandbox(Ht,Ft)}),this._setEventListeners(Ct,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Ft=>Ft.target.checked)),this._setBackgroundColor(Ct),this._setDefaultPropertiesFromJS(Ct),this.container.append(Ct),this.container}}class f extends tt{constructor(yt){super(yt,{isRenderable:yt.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const yt=this.annotationStorage,a=this.data,Z=a.id;let At=yt.getValue(Z,{value:a.fieldValue===a.buttonValue}).value;typeof At=="string"&&(At=At!==a.buttonValue,yt.setValue(Z,{value:At}));const Ct=document.createElement("input");if(mt.add(Ct),Ct.setAttribute("data-element-id",Z),Ct.disabled=a.readOnly,this._setRequired(Ct,this.data.required),Ct.type="radio",Ct.name=a.fieldName,At&&Ct.setAttribute("checked",!0),Ct.tabIndex=rt,Ct.addEventListener("change",Ft=>{const{name:Ht,checked:Qt}=Ft.target;for(const ue of this._getElementsByName(Ht,Z))yt.setValue(ue.id,{value:!1});yt.setValue(Z,{value:Qt})}),Ct.addEventListener("resetform",Ft=>{const Ht=a.defaultFieldValue;Ft.target.checked=Ht!=null&&Ht===a.buttonValue}),this.enableScripting&&this.hasJSActions){const Ft=a.buttonValue;Ct.addEventListener("updatefromsandbox",Ht=>{const Qt={value:ue=>{const he=Ft===ue.detail.value;for(const xe of this._getElementsByName(ue.target.name)){const de=he&&xe.id===Z;xe.domElement&&(xe.domElement.checked=de),yt.setValue(xe.id,{value:de})}}};this._dispatchEventFromSandbox(Qt,Ht)}),this._setEventListeners(Ct,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Ht=>Ht.target.checked)}return this._setBackgroundColor(Ct),this._setDefaultPropertiesFromJS(Ct),this.container.append(Ct),this.container}}class _ extends nt{constructor(yt){super(yt,{ignoreBorder:yt.data.hasAppearance})}render(){const yt=super.render();yt.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(yt.title=this.data.alternativeText);const a=yt.lastChild;return this.enableScripting&&this.hasJSActions&&a&&(this._setDefaultPropertiesFromJS(a),a.addEventListener("updatefromsandbox",Z=>{this._dispatchEventFromSandbox({},Z)})),yt}}class pt extends tt{constructor(yt){super(yt,{isRenderable:yt.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const yt=this.annotationStorage,a=this.data.id,Z=yt.getValue(a,{value:this.data.fieldValue}),At=document.createElement("select");mt.add(At),At.setAttribute("data-element-id",a),At.disabled=this.data.readOnly,this._setRequired(At,this.data.required),At.name=this.data.fieldName,At.tabIndex=rt;let Ct=this.data.combo&&this.data.options.length>0;this.data.combo||(At.size=this.data.options.length,this.data.multiSelect&&(At.multiple=!0)),At.addEventListener("resetform",he=>{const xe=this.data.defaultFieldValue;for(const de of At.options)de.selected=de.value===xe});for(const he of this.data.options){const xe=document.createElement("option");xe.textContent=he.displayValue,xe.value=he.exportValue,Z.value.includes(he.exportValue)&&(xe.setAttribute("selected",!0),Ct=!1),At.append(xe)}let Ft=null;if(Ct){const he=document.createElement("option");he.value=" ",he.setAttribute("hidden",!0),he.setAttribute("selected",!0),At.prepend(he),Ft=()=>{he.remove(),At.removeEventListener("input",Ft),Ft=null},At.addEventListener("input",Ft)}const Ht=he=>{const xe=he?"value":"textContent",{options:de,multiple:fe}=At;return fe?Array.prototype.filter.call(de,Se=>Se.selected).map(Se=>Se[xe]):de.selectedIndex===-1?null:de[de.selectedIndex][xe]};let Qt=Ht(!1);const ue=he=>{const xe=he.target.options;return Array.prototype.map.call(xe,de=>({displayValue:de.textContent,exportValue:de.value}))};return this.enableScripting&&this.hasJSActions?(At.addEventListener("updatefromsandbox",he=>{const xe={value(de){Ft==null||Ft();const fe=de.detail.value,Se=new Set(Array.isArray(fe)?fe:[fe]);for(const Re of At.options)Re.selected=Se.has(Re.value);yt.setValue(a,{value:Ht(!0)}),Qt=Ht(!1)},multipleSelection(de){At.multiple=!0},remove(de){const fe=At.options,Se=de.detail.remove;fe[Se].selected=!1,At.remove(Se),fe.length>0&&Array.prototype.findIndex.call(fe,Fe=>Fe.selected)===-1&&(fe[0].selected=!0),yt.setValue(a,{value:Ht(!0),items:ue(de)}),Qt=Ht(!1)},clear(de){for(;At.length!==0;)At.remove(0);yt.setValue(a,{value:null,items:[]}),Qt=Ht(!1)},insert(de){const{index:fe,displayValue:Se,exportValue:Re}=de.detail.insert,Fe=At.children[fe],De=document.createElement("option");De.textContent=Se,De.value=Re,Fe?Fe.before(De):At.append(De),yt.setValue(a,{value:Ht(!0),items:ue(de)}),Qt=Ht(!1)},items(de){const{items:fe}=de.detail;for(;At.length!==0;)At.remove(0);for(const Se of fe){const{displayValue:Re,exportValue:Fe}=Se,De=document.createElement("option");De.textContent=Re,De.value=Fe,At.append(De)}At.options.length>0&&(At.options[0].selected=!0),yt.setValue(a,{value:Ht(!0),items:ue(de)}),Qt=Ht(!1)},indices(de){const fe=new Set(de.detail.indices);for(const Se of de.target.options)Se.selected=fe.has(Se.index);yt.setValue(a,{value:Ht(!0)}),Qt=Ht(!1)},editable(de){de.target.disabled=!de.detail.editable}};this._dispatchEventFromSandbox(xe,he)}),At.addEventListener("input",he=>{var de;const xe=Ht(!0);yt.setValue(a,{value:xe}),he.preventDefault(),(de=this.linkService.eventBus)==null||de.dispatch("dispatcheventinsandbox",{source:this,detail:{id:a,name:"Keystroke",value:Qt,changeEx:xe,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(At,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],he=>he.target.value)):At.addEventListener("input",function(he){yt.setValue(a,{value:Ht(!0)})}),this.data.combo&&this._setTextStyle(At),this._setBackgroundColor(At),this._setDefaultPropertiesFromJS(At),this.container.append(At),this.container}}class Y extends st{constructor(yt){const{data:a,elements:Z}=yt;super(yt,{isRenderable:st._hasPopupData(a)}),this.elements=Z}render(){this.container.classList.add("popupAnnotation");const yt=new g({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),a=[];for(const Z of this.elements)Z.popup=yt,a.push(Z.data.id),Z.addHighlightArea();return this.container.setAttribute("aria-controls",a.map(Z=>`${i.AnnotationPrefix}${Z}`).join(",")),this.container}}class g{constructor({container:yt,color:a,elements:Z,titleObj:At,modificationDate:Ct,contentsObj:Ft,richText:Ht,parent:Qt,rect:ue,parentRect:he,open:xe}){Et(this,Ae);Et(this,ve);Et(this,Te);Et(this,Ce);Et(this,vt,null);Et(this,Nt,xt(this,Ae,bs).bind(this));Et(this,Lt,xt(this,Ce,$n).bind(this));Et(this,jt,xt(this,Te,Hn).bind(this));Et(this,zt,xt(this,ve,dn).bind(this));Et(this,Yt,null);Et(this,Gt,null);Et(this,le,null);Et(this,ge,null);Et(this,ne,null);Et(this,pe,null);Et(this,Kt,!1);Et(this,Ot,null);Et(this,It,null);Et(this,Xt,null);Et(this,ae,null);Et(this,oe,!1);var fe;Ut(this,Gt,yt),Ut(this,ae,At),Ut(this,le,Ft),Ut(this,Xt,Ht),Ut(this,ne,Qt),Ut(this,Yt,a),Ut(this,It,ue),Ut(this,pe,he),Ut(this,ge,Z);const de=b.PDFDateString.toDateObject(Ct);de&&Ut(this,vt,Qt.l10n.get("annotation_date_string",{date:de.toLocaleDateString(),time:de.toLocaleTimeString()})),this.trigger=Z.flatMap(Se=>Se.getElementsToTriggerPopup());for(const Se of this.trigger)Se.addEventListener("click",s(this,zt)),Se.addEventListener("mouseenter",s(this,jt)),Se.addEventListener("mouseleave",s(this,Lt)),Se.classList.add("popupTriggerArea");for(const Se of Z)(fe=Se.container)==null||fe.addEventListener("keydown",s(this,Nt));s(this,Gt).hidden=!0,xe&&xt(this,ve,dn).call(this)}render(){if(s(this,Ot))return;const{page:{view:yt},viewport:{rawDims:{pageWidth:a,pageHeight:Z,pageX:At,pageY:Ct}}}=s(this,ne),Ft=Ut(this,Ot,document.createElement("div"));if(Ft.className="popup",s(this,Yt)){const Ne=Ft.style.outlineColor=i.Util.makeHexColor(...s(this,Yt));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?Ft.style.backgroundColor=`color-mix(in srgb, ${Ne} 30%, white)`:Ft.style.backgroundColor=i.Util.makeHexColor(...s(this,Yt).map(He=>Math.floor(.7*(255-He)+He)))}const Ht=document.createElement("span");Ht.className="header";const Qt=document.createElement("h1");if(Ht.append(Qt),{dir:Qt.dir,str:Qt.textContent}=s(this,ae),Ft.append(Ht),s(this,vt)){const Ne=document.createElement("span");Ne.classList.add("popupDate"),s(this,vt).then(Ue=>{Ne.textContent=Ue}),Ht.append(Ne)}const ue=s(this,le),he=s(this,Xt);if(he!=null&&he.str&&(!(ue!=null&&ue.str)||ue.str===he.str))ht.XfaLayer.render({xfaHtml:he.html,intent:"richText",div:Ft}),Ft.lastChild.classList.add("richText","popupContent");else{const Ne=this._formatContents(ue);Ft.append(Ne)}let xe=!!s(this,pe),de=xe?s(this,pe):s(this,It);for(const Ne of s(this,ge))if(!de||i.Util.intersect(Ne.data.rect,de)!==null){de=Ne.data.rect,xe=!0;break}const fe=i.Util.normalizeRect([de[0],yt[3]-de[1]+yt[1],de[2],yt[3]-de[3]+yt[1]]),Se=5,Re=xe?de[2]-de[0]+Se:0,Fe=fe[0]+Re,De=fe[1],{style:Be}=s(this,Gt);Be.left=`${100*(Fe-At)/a}%`,Be.top=`${100*(De-Ct)/Z}%`,s(this,Gt).append(Ft)}_formatContents({str:yt,dir:a}){const Z=document.createElement("p");Z.classList.add("popupContent"),Z.dir=a;const At=yt.split(/(?:\r\n?|\n)/);for(let Ct=0,Ft=At.length;Ct<Ft;++Ct){const Ht=At[Ct];Z.append(document.createTextNode(Ht)),Ct<Ft-1&&Z.append(document.createElement("br"))}return Z}forceHide(){Ut(this,oe,this.isVisible),s(this,oe)&&(s(this,Gt).hidden=!0)}maybeShow(){s(this,oe)&&(Ut(this,oe,!1),s(this,Gt).hidden=!1)}get isVisible(){return s(this,Gt).hidden===!1}}vt=new WeakMap,Nt=new WeakMap,Lt=new WeakMap,jt=new WeakMap,zt=new WeakMap,Yt=new WeakMap,Gt=new WeakMap,le=new WeakMap,ge=new WeakMap,ne=new WeakMap,pe=new WeakMap,Kt=new WeakMap,Ot=new WeakMap,It=new WeakMap,Xt=new WeakMap,ae=new WeakMap,oe=new WeakMap,Ae=new WeakSet,bs=function(yt){yt.altKey||yt.shiftKey||yt.ctrlKey||yt.metaKey||(yt.key==="Enter"||yt.key==="Escape"&&s(this,Kt))&&xt(this,ve,dn).call(this)},ve=new WeakSet,dn=function(){Ut(this,Kt,!s(this,Kt)),s(this,Kt)?(xt(this,Te,Hn).call(this),s(this,Gt).addEventListener("click",s(this,zt)),s(this,Gt).addEventListener("keydown",s(this,Nt))):(xt(this,Ce,$n).call(this),s(this,Gt).removeEventListener("click",s(this,zt)),s(this,Gt).removeEventListener("keydown",s(this,Nt)))},Te=new WeakSet,Hn=function(){s(this,Ot)||this.render(),this.isVisible?s(this,Kt)&&s(this,Gt).classList.add("focused"):(s(this,Gt).hidden=!1,s(this,Gt).style.zIndex=parseInt(s(this,Gt).style.zIndex)+1e3)},Ce=new WeakSet,$n=function(){s(this,Gt).classList.remove("focused"),!(s(this,Kt)||!this.isVisible)&&(s(this,Gt).hidden=!0,s(this,Gt).style.zIndex=parseInt(s(this,Gt).style.zIndex)-1e3)};class ft extends st{constructor(yt){super(yt,{isRenderable:!0,ignoreBorder:!0}),this.textContent=yt.data.textContent,this.textPosition=yt.data.textPosition,this.annotationEditorType=i.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const yt=document.createElement("div");yt.classList.add("annotationTextContent"),yt.setAttribute("role","comment");for(const a of this.textContent){const Z=document.createElement("span");Z.textContent=a,yt.append(Z)}this.container.append(yt)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}e.FreeTextAnnotationElement=ft;class $ extends st{constructor(a){super(a,{isRenderable:!0,ignoreBorder:!0});Et(this,Dt,null)}render(){this.container.classList.add("lineAnnotation");const a=this.data,{width:Z,height:At}=_t(a.rect),Ct=this.svgFactory.create(Z,At,!0),Ft=Ut(this,Dt,this.svgFactory.createElement("svg:line"));return Ft.setAttribute("x1",a.rect[2]-a.lineCoordinates[0]),Ft.setAttribute("y1",a.rect[3]-a.lineCoordinates[1]),Ft.setAttribute("x2",a.rect[2]-a.lineCoordinates[2]),Ft.setAttribute("y2",a.rect[3]-a.lineCoordinates[3]),Ft.setAttribute("stroke-width",a.borderStyle.width||1),Ft.setAttribute("stroke","transparent"),Ft.setAttribute("fill","transparent"),Ct.append(Ft),this.container.append(Ct),!a.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return s(this,Dt)}addHighlightArea(){this.container.classList.add("highlightArea")}}Dt=new WeakMap;class Tt extends st{constructor(a){super(a,{isRenderable:!0,ignoreBorder:!0});Et(this,kt,null)}render(){this.container.classList.add("squareAnnotation");const a=this.data,{width:Z,height:At}=_t(a.rect),Ct=this.svgFactory.create(Z,At,!0),Ft=a.borderStyle.width,Ht=Ut(this,kt,this.svgFactory.createElement("svg:rect"));return Ht.setAttribute("x",Ft/2),Ht.setAttribute("y",Ft/2),Ht.setAttribute("width",Z-Ft),Ht.setAttribute("height",At-Ft),Ht.setAttribute("stroke-width",Ft||1),Ht.setAttribute("stroke","transparent"),Ht.setAttribute("fill","transparent"),Ct.append(Ht),this.container.append(Ct),!a.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return s(this,kt)}addHighlightArea(){this.container.classList.add("highlightArea")}}kt=new WeakMap;class wt extends st{constructor(a){super(a,{isRenderable:!0,ignoreBorder:!0});Et(this,Zt,null)}render(){this.container.classList.add("circleAnnotation");const a=this.data,{width:Z,height:At}=_t(a.rect),Ct=this.svgFactory.create(Z,At,!0),Ft=a.borderStyle.width,Ht=Ut(this,Zt,this.svgFactory.createElement("svg:ellipse"));return Ht.setAttribute("cx",Z/2),Ht.setAttribute("cy",At/2),Ht.setAttribute("rx",Z/2-Ft/2),Ht.setAttribute("ry",At/2-Ft/2),Ht.setAttribute("stroke-width",Ft||1),Ht.setAttribute("stroke","transparent"),Ht.setAttribute("fill","transparent"),Ct.append(Ht),this.container.append(Ct),!a.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return s(this,Zt)}addHighlightArea(){this.container.classList.add("highlightArea")}}Zt=new WeakMap;class at extends st{constructor(a){super(a,{isRenderable:!0,ignoreBorder:!0});Et(this,ee,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const a=this.data,{width:Z,height:At}=_t(a.rect),Ct=this.svgFactory.create(Z,At,!0);let Ft=[];for(const Qt of a.vertices){const ue=Qt.x-a.rect[0],he=a.rect[3]-Qt.y;Ft.push(ue+","+he)}Ft=Ft.join(" ");const Ht=Ut(this,ee,this.svgFactory.createElement(this.svgElementName));return Ht.setAttribute("points",Ft),Ht.setAttribute("stroke-width",a.borderStyle.width||1),Ht.setAttribute("stroke","transparent"),Ht.setAttribute("fill","transparent"),Ct.append(Ht),this.container.append(Ct),!a.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return s(this,ee)}addHighlightArea(){this.container.classList.add("highlightArea")}}ee=new WeakMap;class Rt extends at{constructor(yt){super(yt),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Bt extends st{constructor(yt){super(yt,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class $t extends st{constructor(a){super(a,{isRenderable:!0,ignoreBorder:!0});Et(this,Oe,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=i.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const a=this.data,{width:Z,height:At}=_t(a.rect),Ct=this.svgFactory.create(Z,At,!0);for(const Ft of a.inkLists){let Ht=[];for(const ue of Ft){const he=ue.x-a.rect[0],xe=a.rect[3]-ue.y;Ht.push(`${he},${xe}`)}Ht=Ht.join(" ");const Qt=this.svgFactory.createElement(this.svgElementName);s(this,Oe).push(Qt),Qt.setAttribute("points",Ht),Qt.setAttribute("stroke-width",a.borderStyle.width||1),Qt.setAttribute("stroke","transparent"),Qt.setAttribute("fill","transparent"),!a.popupRef&&this.hasPopupData&&this._createPopup(),Ct.append(Qt)}return this.container.append(Ct),this.container}getElementsToTriggerPopup(){return s(this,Oe)}addHighlightArea(){this.container.classList.add("highlightArea")}}Oe=new WeakMap,e.InkAnnotationElement=$t;class Pt extends st{constructor(yt){super(yt,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class Vt extends st{constructor(yt){super(yt,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class Jt extends st{constructor(yt){super(yt,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class se extends st{constructor(yt){super(yt,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class re extends st{constructor(yt){super(yt,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}e.StampAnnotationElement=re;class ut extends st{constructor(a){var Ct;super(a,{isRenderable:!0});Et(this,Mt);Et(this,Le,null);const{filename:Z,content:At}=this.data.file;this.filename=(0,b.getFilenameFromUrl)(Z,!0),this.content=At,(Ct=this.linkService.eventBus)==null||Ct.dispatch("fileattachmentannotation",{source:this,filename:Z,content:At})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:a,data:Z}=this;let At;Z.hasAppearance||Z.fillAlpha===0?At=document.createElement("div"):(At=document.createElement("img"),At.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(Z.name)?"paperclip":"pushpin"}.svg`,Z.fillAlpha&&Z.fillAlpha<1&&(At.style=`filter: opacity(${Math.round(Z.fillAlpha*100)}%);`)),At.addEventListener("dblclick",xt(this,Mt,Gn).bind(this)),Ut(this,Le,At);const{isMac:Ct}=i.FeatureTest.platform;return a.addEventListener("keydown",Ft=>{Ft.key==="Enter"&&(Ct?Ft.metaKey:Ft.ctrlKey)&&xt(this,Mt,Gn).call(this)}),!Z.popupRef&&this.hasPopupData?this._createPopup():At.classList.add("popupTriggerArea"),a.append(At),a}getElementsToTriggerPopup(){return s(this,Le)}addHighlightArea(){this.container.classList.add("highlightArea")}}Le=new WeakMap,Mt=new WeakSet,Gn=function(){var a;(a=this.downloadManager)==null||a.openOrDownloadData(this.container,this.content,this.filename)};class o{constructor({div:yt,accessibilityManager:a,annotationCanvasMap:Z,l10n:At,page:Ct,viewport:Ft}){Et(this,ye);Et(this,te);Et(this,be,null);Et(this,ce,null);Et(this,_e,new Map);this.div=yt,Ut(this,be,a),Ut(this,ce,Z),this.l10n=At,this.page=Ct,this.viewport=Ft,this.zIndex=0,this.l10n||(this.l10n=Wt.NullL10n)}async render(yt){const{annotations:a}=yt,Z=this.div;(0,b.setLayerDimensions)(Z,this.viewport);const At=new Map,Ct={data:null,layer:Z,linkService:yt.linkService,downloadManager:yt.downloadManager,imageResourcesPath:yt.imageResourcesPath||"",renderForms:yt.renderForms!==!1,svgFactory:new b.DOMSVGFactory,annotationStorage:yt.annotationStorage||new St.AnnotationStorage,enableScripting:yt.enableScripting===!0,hasJSActions:yt.hasJSActions,fieldObjects:yt.fieldObjects,parent:this,elements:null};for(const Ft of a){if(Ft.noHTML)continue;const Ht=Ft.annotationType===i.AnnotationType.POPUP;if(Ht){const he=At.get(Ft.id);if(!he)continue;Ct.elements=he}else{const{width:he,height:xe}=_t(Ft.rect);if(he<=0||xe<=0)continue}Ct.data=Ft;const Qt=dt.create(Ct);if(!Qt.isRenderable)continue;if(!Ht&&Ft.popupRef){const he=At.get(Ft.popupRef);he?he.push(Qt):At.set(Ft.popupRef,[Qt])}Qt.annotationEditorType>0&&s(this,_e).set(Qt.data.id,Qt);const ue=Qt.render();Ft.hidden&&(ue.style.visibility="hidden"),xt(this,ye,_s).call(this,ue,Ft.id)}xt(this,te,Vn).call(this),await this.l10n.translate(Z)}update({viewport:yt}){const a=this.div;this.viewport=yt,(0,b.setLayerDimensions)(a,{rotation:yt.rotation}),xt(this,te,Vn).call(this),a.hidden=!1}getEditableAnnotations(){return Array.from(s(this,_e).values())}getEditableAnnotation(yt){return s(this,_e).get(yt)}}be=new WeakMap,ce=new WeakMap,_e=new WeakMap,ye=new WeakSet,_s=function(yt,a){var At;const Z=yt.firstChild||yt;Z.id=`${i.AnnotationPrefix}${a}`,this.div.append(yt),(At=s(this,be))==null||At.moveElementInDOM(this.div,yt,Z,!1)},te=new WeakSet,Vn=function(){if(!s(this,ce))return;const yt=this.div;for(const[a,Z]of s(this,ce)){const At=yt.querySelector(`[data-annotation-id="${a}"]`);if(!At)continue;const{firstChild:Ct}=At;Ct?Ct.nodeName==="CANVAS"?Ct.replaceWith(Z):Ct.before(Z):At.append(Z)}s(this,ce).clear()},e.AnnotationLayer=o},(d,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ColorConverters=void 0;function ot(St){return Math.floor(Math.max(0,Math.min(1,St))*255).toString(16).padStart(2,"0")}function i(St){return Math.max(0,Math.min(255,255*St))}class b{static CMYK_G([bt,Wt,ht,rt]){return["G",1-Math.min(1,.3*bt+.59*ht+.11*Wt+rt)]}static G_CMYK([bt]){return["CMYK",0,0,0,1-bt]}static G_RGB([bt]){return["RGB",bt,bt,bt]}static G_rgb([bt]){return bt=i(bt),[bt,bt,bt]}static G_HTML([bt]){const Wt=ot(bt);return`#${Wt}${Wt}${Wt}`}static RGB_G([bt,Wt,ht]){return["G",.3*bt+.59*Wt+.11*ht]}static RGB_rgb(bt){return bt.map(i)}static RGB_HTML(bt){return`#${bt.map(ot).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([bt,Wt,ht,rt]){return["RGB",1-Math.min(1,bt+rt),1-Math.min(1,ht+rt),1-Math.min(1,Wt+rt)]}static CMYK_rgb([bt,Wt,ht,rt]){return[i(1-Math.min(1,bt+rt)),i(1-Math.min(1,ht+rt)),i(1-Math.min(1,Wt+rt))]}static CMYK_HTML(bt){const Wt=this.CMYK_RGB(bt).slice(1);return this.RGB_HTML(Wt)}static RGB_CMYK([bt,Wt,ht]){const rt=1-bt,X=1-Wt,mt=1-ht,_t=Math.min(rt,X,mt);return["CMYK",rt,X,mt,_t]}}e.ColorConverters=b},(d,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.NullL10n=void 0,e.getL10nFallback=i;const ot={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}} × {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}} × {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing…",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image",editor_alt_text_button_label:"Alt text",editor_alt_text_edit_button_label:"Edit alt text",editor_alt_text_decorative_tooltip:"Marked as decorative"};ot.print_progress_percent="{{progress}}%";function i(bt,Wt){switch(bt){case"find_match_count":bt=`find_match_count[${Wt.total===1?"one":"other"}]`;break;case"find_match_count_limit":bt=`find_match_count_limit[${Wt.limit===1?"one":"other"}]`;break}return ot[bt]||""}function b(bt,Wt){return Wt?bt.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(ht,rt)=>rt in Wt?Wt[rt]:"{{"+rt+"}}"):bt}const St={async getLanguage(){return"en-us"},async getDirection(){return"ltr"},async get(bt,Wt=null,ht=i(bt,Wt)){return b(ht,Wt)},async translate(bt){}};e.NullL10n=St},(d,e,ot)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.XfaLayer=void 0;var i=ot(25);class b{static setupStorage(bt,Wt,ht,rt,X){const mt=rt.getValue(Wt,{value:null});switch(ht.name){case"textarea":if(mt.value!==null&&(bt.textContent=mt.value),X==="print")break;bt.addEventListener("input",_t=>{rt.setValue(Wt,{value:_t.target.value})});break;case"input":if(ht.attributes.type==="radio"||ht.attributes.type==="checkbox"){if(mt.value===ht.attributes.xfaOn?bt.setAttribute("checked",!0):mt.value===ht.attributes.xfaOff&&bt.removeAttribute("checked"),X==="print")break;bt.addEventListener("change",_t=>{rt.setValue(Wt,{value:_t.target.checked?_t.target.getAttribute("xfaOn"):_t.target.getAttribute("xfaOff")})})}else{if(mt.value!==null&&bt.setAttribute("value",mt.value),X==="print")break;bt.addEventListener("input",_t=>{rt.setValue(Wt,{value:_t.target.value})})}break;case"select":if(mt.value!==null){bt.setAttribute("value",mt.value);for(const _t of ht.children)_t.attributes.value===mt.value?_t.attributes.selected=!0:_t.attributes.hasOwnProperty("selected")&&delete _t.attributes.selected}bt.addEventListener("input",_t=>{const dt=_t.target.options,st=dt.selectedIndex===-1?"":dt[dt.selectedIndex].value;rt.setValue(Wt,{value:st})});break}}static setAttributes({html:bt,element:Wt,storage:ht=null,intent:rt,linkService:X}){const{attributes:mt}=Wt,_t=bt instanceof HTMLAnchorElement;mt.type==="radio"&&(mt.name=`${mt.name}-${rt}`);for(const[dt,st]of Object.entries(mt))if(st!=null)switch(dt){case"class":st.length&&bt.setAttribute(dt,st.join(" "));break;case"dataId":break;case"id":bt.setAttribute("data-element-id",st);break;case"style":Object.assign(bt.style,st);break;case"textContent":bt.textContent=st;break;default:(!_t||dt!=="href"&&dt!=="newWindow")&&bt.setAttribute(dt,st)}_t&&X.addLinkAttributes(bt,mt.href,mt.newWindow),ht&&mt.dataId&&this.setupStorage(bt,mt.dataId,Wt,ht)}static render(bt){var nt;const Wt=bt.annotationStorage,ht=bt.linkService,rt=bt.xfaHtml,X=bt.intent||"display",mt=document.createElement(rt.name);rt.attributes&&this.setAttributes({html:mt,element:rt,intent:X,linkService:ht});const _t=[[rt,-1,mt]],dt=bt.div;if(dt.append(mt),bt.viewport){const j=`matrix(${bt.viewport.transform.join(",")})`;dt.style.transform=j}X!=="richText"&&dt.setAttribute("class","xfaLayer xfaFont");const st=[];for(;_t.length>0;){const[j,tt,ct]=_t.at(-1);if(tt+1===j.children.length){_t.pop();continue}const lt=j.children[++_t.at(-1)[1]];if(lt===null)continue;const{name:et}=lt;if(et==="#text"){const _=document.createTextNode(lt.value);st.push(_),ct.append(_);continue}const f=(nt=lt==null?void 0:lt.attributes)!=null&&nt.xmlns?document.createElementNS(lt.attributes.xmlns,et):document.createElement(et);if(ct.append(f),lt.attributes&&this.setAttributes({html:f,element:lt,storage:Wt,intent:X,linkService:ht}),lt.children&&lt.children.length>0)_t.push([lt,-1,f]);else if(lt.value){const _=document.createTextNode(lt.value);i.XfaText.shouldBuildText(et)&&st.push(_),f.append(_)}}for(const j of dt.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))j.setAttribute("readOnly",!0);return{textDivs:st}}static update(bt){const Wt=`matrix(${bt.viewport.transform.join(",")})`;bt.div.style.transform=Wt,bt.div.hidden=!1}}e.XfaLayer=b},(d,e,ot)=>{var rt,X,mt,_t,dt,st,nt,j,tt,ct,lt,et,f,_,pt,ys,g,As,$,vs,wt,Es,Rt,zn,$t,Ss,Vt,qn,se,Ts,ut,Ps,h,ws,m,Cs,it,xs,vt,We,Lt,Xn,zt,fn,Gt,pn,ge,Xe,pe,Yn,Ot,gn,Xt,Rs,oe,Kn,Pe,ks,we,Fs,Ee,Jn,qt,mn,kt,Ye;Object.defineProperty(e,"__esModule",{value:!0}),e.InkEditor=void 0;var i=ot(1),b=ot(4),St=ot(29),bt=ot(6),Wt=ot(5);const ee=class ee extends b.AnnotationEditor{constructor(Mt){super({...Mt,name:"inkEditor"});Et(this,pt);Et(this,g);Et(this,$);Et(this,wt);Et(this,Rt);Et(this,$t);Et(this,Vt);Et(this,se);Et(this,ut);Et(this,h);Et(this,m);Et(this,it);Et(this,vt);Et(this,Lt);Et(this,zt);Et(this,Gt);Et(this,ge);Et(this,pe);Et(this,Ot);Et(this,we);Et(this,Ee);Et(this,qt);Et(this,kt);Et(this,rt,0);Et(this,X,0);Et(this,mt,this.canvasPointermove.bind(this));Et(this,_t,this.canvasPointerleave.bind(this));Et(this,dt,this.canvasPointerup.bind(this));Et(this,st,this.canvasPointerdown.bind(this));Et(this,nt,new Path2D);Et(this,j,!1);Et(this,tt,!1);Et(this,ct,!1);Et(this,lt,null);Et(this,et,0);Et(this,f,0);Et(this,_,null);this.color=Mt.color||null,this.thickness=Mt.thickness||null,this.opacity=Mt.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(Mt){b.AnnotationEditor.initialize(Mt,{strings:["editor_ink_canvas_aria_label","editor_ink2_aria_label"]})}static updateDefaultParams(Mt,ie){switch(Mt){case i.AnnotationEditorParamsType.INK_THICKNESS:ee._defaultThickness=ie;break;case i.AnnotationEditorParamsType.INK_COLOR:ee._defaultColor=ie;break;case i.AnnotationEditorParamsType.INK_OPACITY:ee._defaultOpacity=ie/100;break}}updateParams(Mt,ie){switch(Mt){case i.AnnotationEditorParamsType.INK_THICKNESS:xt(this,pt,ys).call(this,ie);break;case i.AnnotationEditorParamsType.INK_COLOR:xt(this,g,As).call(this,ie);break;case i.AnnotationEditorParamsType.INK_OPACITY:xt(this,$,vs).call(this,ie);break}}static get defaultPropertiesToUpdate(){return[[i.AnnotationEditorParamsType.INK_THICKNESS,ee._defaultThickness],[i.AnnotationEditorParamsType.INK_COLOR,ee._defaultColor||b.AnnotationEditor._defaultLineColor],[i.AnnotationEditorParamsType.INK_OPACITY,Math.round(ee._defaultOpacity*100)]]}get propertiesToUpdate(){return[[i.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||ee._defaultThickness],[i.AnnotationEditorParamsType.INK_COLOR,this.color||ee._defaultColor||b.AnnotationEditor._defaultLineColor],[i.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??ee._defaultOpacity))]]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(xt(this,zt,fn).call(this),xt(this,Gt,pn).call(this)),this.isAttachedToDOM||(this.parent.add(this),xt(this,ge,Xe).call(this)),xt(this,kt,Ye).call(this)))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,s(this,lt).disconnect(),Ut(this,lt,null),super.remove())}setParent(Mt){!this.parent&&Mt?this._uiManager.removeShouldRescale(this):this.parent&&Mt===null&&this._uiManager.addShouldRescale(this),super.setParent(Mt)}onScaleChanging(){const[Mt,ie]=this.parentDimensions,be=this.width*Mt,ce=this.height*ie;this.setDimensions(be,ce)}enableEditMode(){s(this,j)||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",s(this,st)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",s(this,st)))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){s(this,j)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),Ut(this,j,!0),this.div.classList.add("disabled"),xt(this,kt,Ye).call(this,!0),this.makeResizable(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(Mt){this._focusEventsAllowed&&(super.focusin(Mt),this.enableEditMode())}canvasPointerdown(Mt){Mt.button!==0||!this.isInEditMode()||s(this,j)||(this.setInForeground(),Mt.preventDefault(),Mt.type!=="mouse"&&this.div.focus(),xt(this,$t,Ss).call(this,Mt.offsetX,Mt.offsetY))}canvasPointermove(Mt){Mt.preventDefault(),xt(this,Vt,qn).call(this,Mt.offsetX,Mt.offsetY)}canvasPointerup(Mt){Mt.preventDefault(),xt(this,Lt,Xn).call(this,Mt)}canvasPointerleave(Mt){xt(this,Lt,Xn).call(this,Mt)}get isResizable(){return!this.isEmpty()&&s(this,j)}render(){if(this.div)return this.div;let Mt,ie;this.width&&(Mt=this.x,ie=this.y),super.render(),b.AnnotationEditor._l10nPromise.get("editor_ink2_aria_label").then(Me=>{var te;return(te=this.div)==null?void 0:te.setAttribute("aria-label",Me)});const[be,ce,_e,ye]=xt(this,wt,Es).call(this);if(this.setAt(be,ce,0,0),this.setDims(_e,ye),xt(this,zt,fn).call(this),this.width){const[Me,te]=this.parentDimensions;this.setAspectRatio(this.width*Me,this.height*te),this.setAt(Mt*Me,ie*te,this.width*Me,this.height*te),Ut(this,ct,!0),xt(this,ge,Xe).call(this),this.setDims(this.width*Me,this.height*te),xt(this,vt,We).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return xt(this,Gt,pn).call(this),this.div}setDimensions(Mt,ie){const be=Math.round(Mt),ce=Math.round(ie);if(s(this,et)===be&&s(this,f)===ce)return;Ut(this,et,be),Ut(this,f,ce),this.canvas.style.visibility="hidden";const[_e,ye]=this.parentDimensions;this.width=Mt/_e,this.height=ie/ye,this.fixAndSetPosition(),s(this,j)&&xt(this,pe,Yn).call(this,Mt,ie),xt(this,ge,Xe).call(this),xt(this,vt,We).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(Mt,ie,be){var Ct,Ft,Ht;if(Mt instanceof St.InkAnnotationElement)return null;const ce=super.deserialize(Mt,ie,be);ce.thickness=Mt.thickness,ce.color=i.Util.makeHexColor(...Mt.color),ce.opacity=Mt.opacity;const[_e,ye]=ce.pageDimensions,Me=ce.width*_e,te=ce.height*ye,ke=ce.parentScale,me=Mt.thickness/2;Ut(ce,j,!0),Ut(ce,et,Math.round(Me)),Ut(ce,f,Math.round(te));const{paths:yt,rect:a,rotation:Z}=Mt;for(let{bezier:Qt}of yt){Qt=xt(Ct=ee,Pe,ks).call(Ct,Qt,a,Z);const ue=[];ce.paths.push(ue);let he=ke*(Qt[0]-me),xe=ke*(Qt[1]-me);for(let fe=2,Se=Qt.length;fe<Se;fe+=6){const Re=ke*(Qt[fe]-me),Fe=ke*(Qt[fe+1]-me),De=ke*(Qt[fe+2]-me),Be=ke*(Qt[fe+3]-me),Ne=ke*(Qt[fe+4]-me),Ue=ke*(Qt[fe+5]-me);ue.push([[he,xe],[Re,Fe],[De,Be],[Ne,Ue]]),he=Ne,xe=Ue}const de=xt(this,Xt,Rs).call(this,ue);ce.bezierPath2D.push(de)}const At=xt(Ft=ce,Ee,Jn).call(Ft);return Ut(ce,X,Math.max(b.AnnotationEditor.MIN_SIZE,At[2]-At[0])),Ut(ce,rt,Math.max(b.AnnotationEditor.MIN_SIZE,At[3]-At[1])),xt(Ht=ce,pe,Yn).call(Ht,Me,te),ce}serialize(){if(this.isEmpty())return null;const Mt=this.getRect(0,0),ie=b.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:i.AnnotationEditorType.INK,color:ie,thickness:this.thickness,opacity:this.opacity,paths:xt(this,we,Fs).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,Mt),pageIndex:this.pageIndex,rect:Mt,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}};rt=new WeakMap,X=new WeakMap,mt=new WeakMap,_t=new WeakMap,dt=new WeakMap,st=new WeakMap,nt=new WeakMap,j=new WeakMap,tt=new WeakMap,ct=new WeakMap,lt=new WeakMap,et=new WeakMap,f=new WeakMap,_=new WeakMap,pt=new WeakSet,ys=function(Mt){const ie=this.thickness;this.addCommands({cmd:()=>{this.thickness=Mt,xt(this,kt,Ye).call(this)},undo:()=>{this.thickness=ie,xt(this,kt,Ye).call(this)},mustExec:!0,type:i.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},g=new WeakSet,As=function(Mt){const ie=this.color;this.addCommands({cmd:()=>{this.color=Mt,xt(this,vt,We).call(this)},undo:()=>{this.color=ie,xt(this,vt,We).call(this)},mustExec:!0,type:i.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},$=new WeakSet,vs=function(Mt){Mt/=100;const ie=this.opacity;this.addCommands({cmd:()=>{this.opacity=Mt,xt(this,vt,We).call(this)},undo:()=>{this.opacity=ie,xt(this,vt,We).call(this)},mustExec:!0,type:i.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},wt=new WeakSet,Es=function(){const{parentRotation:Mt,parentDimensions:[ie,be]}=this;switch(Mt){case 90:return[0,be,be,ie];case 180:return[ie,be,ie,be];case 270:return[ie,0,be,ie];default:return[0,0,ie,be]}},Rt=new WeakSet,zn=function(){const{ctx:Mt,color:ie,opacity:be,thickness:ce,parentScale:_e,scaleFactor:ye}=this;Mt.lineWidth=ce*_e/ye,Mt.lineCap="round",Mt.lineJoin="round",Mt.miterLimit=10,Mt.strokeStyle=`${ie}${(0,Wt.opacityToHex)(be)}`},$t=new WeakSet,Ss=function(Mt,ie){this.canvas.addEventListener("contextmenu",bt.noContextMenu),this.canvas.addEventListener("pointerleave",s(this,_t)),this.canvas.addEventListener("pointermove",s(this,mt)),this.canvas.addEventListener("pointerup",s(this,dt)),this.canvas.removeEventListener("pointerdown",s(this,st)),this.isEditing=!0,s(this,ct)||(Ut(this,ct,!0),xt(this,ge,Xe).call(this),this.thickness||(this.thickness=ee._defaultThickness),this.color||(this.color=ee._defaultColor||b.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=ee._defaultOpacity)),this.currentPath.push([Mt,ie]),Ut(this,tt,!1),xt(this,Rt,zn).call(this),Ut(this,_,()=>{xt(this,h,ws).call(this),s(this,_)&&window.requestAnimationFrame(s(this,_))}),window.requestAnimationFrame(s(this,_))},Vt=new WeakSet,qn=function(Mt,ie){const[be,ce]=this.currentPath.at(-1);if(this.currentPath.length>1&&Mt===be&&ie===ce)return;const _e=this.currentPath;let ye=s(this,nt);if(_e.push([Mt,ie]),Ut(this,tt,!0),_e.length<=2){ye.moveTo(..._e[0]),ye.lineTo(Mt,ie);return}_e.length===3&&(Ut(this,nt,ye=new Path2D),ye.moveTo(..._e[0])),xt(this,m,Cs).call(this,ye,..._e.at(-3),..._e.at(-2),Mt,ie)},se=new WeakSet,Ts=function(){if(this.currentPath.length===0)return;const Mt=this.currentPath.at(-1);s(this,nt).lineTo(...Mt)},ut=new WeakSet,Ps=function(Mt,ie){Ut(this,_,null),Mt=Math.min(Math.max(Mt,0),this.canvas.width),ie=Math.min(Math.max(ie,0),this.canvas.height),xt(this,Vt,qn).call(this,Mt,ie),xt(this,se,Ts).call(this);let be;if(this.currentPath.length!==1)be=xt(this,it,xs).call(this);else{const te=[Mt,ie];be=[[te,te.slice(),te.slice(),te]]}const ce=s(this,nt),_e=this.currentPath;this.currentPath=[],Ut(this,nt,new Path2D);const ye=()=>{this.allRawPaths.push(_e),this.paths.push(be),this.bezierPath2D.push(ce),this.rebuild()},Me=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(xt(this,zt,fn).call(this),xt(this,Gt,pn).call(this)),xt(this,kt,Ye).call(this))};this.addCommands({cmd:ye,undo:Me,mustExec:!0})},h=new WeakSet,ws=function(){if(!s(this,tt))return;Ut(this,tt,!1);const Mt=Math.ceil(this.thickness*this.parentScale),ie=this.currentPath.slice(-3),be=ie.map(ye=>ye[0]),ce=ie.map(ye=>ye[1]);Math.min(...be)-Mt,Math.max(...be)+Mt,Math.min(...ce)-Mt,Math.max(...ce)+Mt;const{ctx:_e}=this;_e.save(),_e.clearRect(0,0,this.canvas.width,this.canvas.height);for(const ye of this.bezierPath2D)_e.stroke(ye);_e.stroke(s(this,nt)),_e.restore()},m=new WeakSet,Cs=function(Mt,ie,be,ce,_e,ye,Me){const te=(ie+ce)/2,ke=(be+_e)/2,me=(ce+ye)/2,yt=(_e+Me)/2;Mt.bezierCurveTo(te+2*(ce-te)/3,ke+2*(_e-ke)/3,me+2*(ce-me)/3,yt+2*(_e-yt)/3,me,yt)},it=new WeakSet,xs=function(){const Mt=this.currentPath;if(Mt.length<=2)return[[Mt[0],Mt[0],Mt.at(-1),Mt.at(-1)]];const ie=[];let be,[ce,_e]=Mt[0];for(be=1;be<Mt.length-2;be++){const[a,Z]=Mt[be],[At,Ct]=Mt[be+1],Ft=(a+At)/2,Ht=(Z+Ct)/2,Qt=[ce+2*(a-ce)/3,_e+2*(Z-_e)/3],ue=[Ft+2*(a-Ft)/3,Ht+2*(Z-Ht)/3];ie.push([[ce,_e],Qt,ue,[Ft,Ht]]),[ce,_e]=[Ft,Ht]}const[ye,Me]=Mt[be],[te,ke]=Mt[be+1],me=[ce+2*(ye-ce)/3,_e+2*(Me-_e)/3],yt=[te+2*(ye-te)/3,ke+2*(Me-ke)/3];return ie.push([[ce,_e],me,yt,[te,ke]]),ie},vt=new WeakSet,We=function(){if(this.isEmpty()){xt(this,Ot,gn).call(this);return}xt(this,Rt,zn).call(this);const{canvas:Mt,ctx:ie}=this;ie.setTransform(1,0,0,1,0,0),ie.clearRect(0,0,Mt.width,Mt.height),xt(this,Ot,gn).call(this);for(const be of this.bezierPath2D)ie.stroke(be)},Lt=new WeakSet,Xn=function(Mt){this.canvas.removeEventListener("pointerleave",s(this,_t)),this.canvas.removeEventListener("pointermove",s(this,mt)),this.canvas.removeEventListener("pointerup",s(this,dt)),this.canvas.addEventListener("pointerdown",s(this,st)),setTimeout(()=>{this.canvas.removeEventListener("contextmenu",bt.noContextMenu)},10),xt(this,ut,Ps).call(this,Mt.offsetX,Mt.offsetY),this.addToAnnotationStorage(),this.setInBackground()},zt=new WeakSet,fn=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",b.AnnotationEditor._l10nPromise.get("editor_ink_canvas_aria_label").then(Mt=>{var ie;return(ie=this.canvas)==null?void 0:ie.setAttribute("aria-label",Mt)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},Gt=new WeakSet,pn=function(){Ut(this,lt,new ResizeObserver(Mt=>{const ie=Mt[0].contentRect;ie.width&&ie.height&&this.setDimensions(ie.width,ie.height)})),s(this,lt).observe(this.div)},ge=new WeakSet,Xe=function(){if(!s(this,ct))return;const[Mt,ie]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*Mt),this.canvas.height=Math.ceil(this.height*ie),xt(this,Ot,gn).call(this)},pe=new WeakSet,Yn=function(Mt,ie){const be=xt(this,qt,mn).call(this),ce=(Mt-be)/s(this,X),_e=(ie-be)/s(this,rt);this.scaleFactor=Math.min(ce,_e)},Ot=new WeakSet,gn=function(){const Mt=xt(this,qt,mn).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+Mt,this.translationY*this.scaleFactor+Mt)},Xt=new WeakSet,Rs=function(Mt){const ie=new Path2D;for(let be=0,ce=Mt.length;be<ce;be++){const[_e,ye,Me,te]=Mt[be];be===0&&ie.moveTo(..._e),ie.bezierCurveTo(ye[0],ye[1],Me[0],Me[1],te[0],te[1])}return ie},oe=new WeakSet,Kn=function(Mt,ie,be){const[ce,_e,ye,Me]=ie;switch(be){case 0:for(let te=0,ke=Mt.length;te<ke;te+=2)Mt[te]+=ce,Mt[te+1]=Me-Mt[te+1];break;case 90:for(let te=0,ke=Mt.length;te<ke;te+=2){const me=Mt[te];Mt[te]=Mt[te+1]+ce,Mt[te+1]=me+_e}break;case 180:for(let te=0,ke=Mt.length;te<ke;te+=2)Mt[te]=ye-Mt[te],Mt[te+1]+=_e;break;case 270:for(let te=0,ke=Mt.length;te<ke;te+=2){const me=Mt[te];Mt[te]=ye-Mt[te+1],Mt[te+1]=Me-me}break;default:throw new Error("Invalid rotation")}return Mt},Pe=new WeakSet,ks=function(Mt,ie,be){const[ce,_e,ye,Me]=ie;switch(be){case 0:for(let te=0,ke=Mt.length;te<ke;te+=2)Mt[te]-=ce,Mt[te+1]=Me-Mt[te+1];break;case 90:for(let te=0,ke=Mt.length;te<ke;te+=2){const me=Mt[te];Mt[te]=Mt[te+1]-_e,Mt[te+1]=me-ce}break;case 180:for(let te=0,ke=Mt.length;te<ke;te+=2)Mt[te]=ye-Mt[te],Mt[te+1]-=_e;break;case 270:for(let te=0,ke=Mt.length;te<ke;te+=2){const me=Mt[te];Mt[te]=Me-Mt[te+1],Mt[te+1]=ye-me}break;default:throw new Error("Invalid rotation")}return Mt},we=new WeakSet,Fs=function(Mt,ie,be,ce){var ke,me;const _e=[],ye=this.thickness/2,Me=Mt*ie+ye,te=Mt*be+ye;for(const yt of this.paths){const a=[],Z=[];for(let At=0,Ct=yt.length;At<Ct;At++){const[Ft,Ht,Qt,ue]=yt[At],he=Mt*Ft[0]+Me,xe=Mt*Ft[1]+te,de=Mt*Ht[0]+Me,fe=Mt*Ht[1]+te,Se=Mt*Qt[0]+Me,Re=Mt*Qt[1]+te,Fe=Mt*ue[0]+Me,De=Mt*ue[1]+te;At===0&&(a.push(he,xe),Z.push(he,xe)),a.push(de,fe,Se,Re,Fe,De),Z.push(de,fe),At===Ct-1&&Z.push(Fe,De)}_e.push({bezier:xt(ke=ee,oe,Kn).call(ke,a,ce,this.rotation),points:xt(me=ee,oe,Kn).call(me,Z,ce,this.rotation)})}return _e},Ee=new WeakSet,Jn=function(){let Mt=1/0,ie=-1/0,be=1/0,ce=-1/0;for(const _e of this.paths)for(const[ye,Me,te,ke]of _e){const me=i.Util.bezierBoundingBox(...ye,...Me,...te,...ke);Mt=Math.min(Mt,me[0]),be=Math.min(be,me[1]),ie=Math.max(ie,me[2]),ce=Math.max(ce,me[3])}return[Mt,be,ie,ce]},qt=new WeakSet,mn=function(){return s(this,j)?Math.ceil(this.thickness*this.parentScale):0},kt=new WeakSet,Ye=function(Mt=!1){if(this.isEmpty())return;if(!s(this,j)){xt(this,vt,We).call(this);return}const ie=xt(this,Ee,Jn).call(this),be=xt(this,qt,mn).call(this);Ut(this,X,Math.max(b.AnnotationEditor.MIN_SIZE,ie[2]-ie[0])),Ut(this,rt,Math.max(b.AnnotationEditor.MIN_SIZE,ie[3]-ie[1]));const ce=Math.ceil(be+s(this,X)*this.scaleFactor),_e=Math.ceil(be+s(this,rt)*this.scaleFactor),[ye,Me]=this.parentDimensions;this.width=ce/ye,this.height=_e/Me,this.setAspectRatio(ce,_e);const te=this.translationX,ke=this.translationY;this.translationX=-ie[0],this.translationY=-ie[1],xt(this,ge,Xe).call(this),xt(this,vt,We).call(this),Ut(this,et,ce),Ut(this,f,_e),this.setDims(ce,_e);const me=Mt?be/this.scaleFactor/2:0;this.translate(te-this.translationX-me,ke-this.translationY-me)},Et(ee,Xt),Et(ee,oe),Et(ee,Pe),Ie(ee,"_defaultColor",null),Ie(ee,"_defaultOpacity",1),Ie(ee,"_defaultThickness",1),Ie(ee,"_type","ink");let ht=ee;e.InkEditor=ht},(d,e,ot)=>{var ht,rt,X,mt,_t,dt,st,nt,j,tt,ct,nn,et,sn,_,bn,Y,Qn,ft,Ms,Tt,Ds,at,Zn,Bt,_n,Pt,Ls;Object.defineProperty(e,"__esModule",{value:!0}),e.StampEditor=void 0;var i=ot(1),b=ot(4),St=ot(6),bt=ot(29);const Jt=class Jt extends b.AnnotationEditor{constructor(ut){super({...ut,name:"stampEditor"});Et(this,ct);Et(this,et);Et(this,_);Et(this,Y);Et(this,ft);Et(this,Tt);Et(this,at);Et(this,Bt);Et(this,Pt);Et(this,ht,null);Et(this,rt,null);Et(this,X,null);Et(this,mt,null);Et(this,_t,null);Et(this,dt,null);Et(this,st,null);Et(this,nt,null);Et(this,j,!1);Et(this,tt,!1);Ut(this,mt,ut.bitmapUrl),Ut(this,_t,ut.bitmapFile)}static initialize(ut){b.AnnotationEditor.initialize(ut)}static get supportedTypes(){const ut=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return(0,i.shadow)(this,"supportedTypes",ut.map(o=>`image/${o}`))}static get supportedTypesStr(){return(0,i.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(ut){return this.supportedTypes.includes(ut)}static paste(ut,o){o.pasteEditor(i.AnnotationEditorType.STAMP,{bitmapFile:ut.getAsFile()})}remove(){var ut,o;s(this,rt)&&(Ut(this,ht,null),this._uiManager.imageManager.deleteId(s(this,rt)),(ut=s(this,dt))==null||ut.remove(),Ut(this,dt,null),(o=s(this,st))==null||o.disconnect(),Ut(this,st,null)),super.remove()}rebuild(){if(!this.parent){s(this,rt)&&xt(this,_,bn).call(this);return}super.rebuild(),this.div!==null&&(s(this,rt)&&xt(this,_,bn).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(s(this,X)||s(this,ht)||s(this,mt)||s(this,_t))}get isResizable(){return!0}render(){if(this.div)return this.div;let ut,o;if(this.width&&(ut=this.x,o=this.y),super.render(),this.div.hidden=!0,s(this,ht)?xt(this,Y,Qn).call(this):xt(this,_,bn).call(this),this.width){const[h,c]=this.parentDimensions;this.setAt(ut*h,o*c,this.width*h,this.height*c)}return this.div}static deserialize(ut,o,h){if(ut instanceof bt.StampAnnotationElement)return null;const c=super.deserialize(ut,o,h),{rect:m,bitmapUrl:k,bitmapId:it,isSvg:gt,accessibilityData:vt}=ut;it&&h.imageManager.isValidId(it)?Ut(c,rt,it):Ut(c,mt,k),Ut(c,j,gt);const[Nt,Lt]=c.pageDimensions;return c.width=(m[2]-m[0])/Nt,c.height=(m[3]-m[1])/Lt,vt&&(c.altTextData=vt),c}serialize(ut=!1,o=null){if(this.isEmpty())return null;const h={annotationType:i.AnnotationEditorType.STAMP,bitmapId:s(this,rt),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:s(this,j),structTreeParentId:this._structTreeParentId};if(ut)return h.bitmapUrl=xt(this,Bt,_n).call(this,!0),h.accessibilityData=this.altTextData,h;const{decorative:c,altText:m}=this.altTextData;if(!c&&m&&(h.accessibilityData={type:"Figure",alt:m}),o===null)return h;o.stamps||(o.stamps=new Map);const k=s(this,j)?(h.rect[2]-h.rect[0])*(h.rect[3]-h.rect[1]):null;if(!o.stamps.has(s(this,rt)))o.stamps.set(s(this,rt),{area:k,serialized:h}),h.bitmap=xt(this,Bt,_n).call(this,!1);else if(s(this,j)){const it=o.stamps.get(s(this,rt));k>it.area&&(it.area=k,it.serialized.bitmap.close(),it.serialized.bitmap=xt(this,Bt,_n).call(this,!1))}return h}};ht=new WeakMap,rt=new WeakMap,X=new WeakMap,mt=new WeakMap,_t=new WeakMap,dt=new WeakMap,st=new WeakMap,nt=new WeakMap,j=new WeakMap,tt=new WeakMap,ct=new WeakSet,nn=function(ut,o=!1){if(!ut){this.remove();return}Ut(this,ht,ut.bitmap),o||(Ut(this,rt,ut.id),Ut(this,j,ut.isSvg)),xt(this,Y,Qn).call(this)},et=new WeakSet,sn=function(){Ut(this,X,null),this._uiManager.enableWaiting(!1),s(this,dt)&&this.div.focus()},_=new WeakSet,bn=function(){if(s(this,rt)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(s(this,rt)).then(o=>xt(this,ct,nn).call(this,o,!0)).finally(()=>xt(this,et,sn).call(this));return}if(s(this,mt)){const o=s(this,mt);Ut(this,mt,null),this._uiManager.enableWaiting(!0),Ut(this,X,this._uiManager.imageManager.getFromUrl(o).then(h=>xt(this,ct,nn).call(this,h)).finally(()=>xt(this,et,sn).call(this)));return}if(s(this,_t)){const o=s(this,_t);Ut(this,_t,null),this._uiManager.enableWaiting(!0),Ut(this,X,this._uiManager.imageManager.getFromFile(o).then(h=>xt(this,ct,nn).call(this,h)).finally(()=>xt(this,et,sn).call(this)));return}const ut=document.createElement("input");ut.type="file",ut.accept=Jt.supportedTypesStr,Ut(this,X,new Promise(o=>{ut.addEventListener("change",async()=>{if(!ut.files||ut.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const h=await this._uiManager.imageManager.getFromFile(ut.files[0]);xt(this,ct,nn).call(this,h)}o()}),ut.addEventListener("cancel",()=>{this.remove(),o()})}).finally(()=>xt(this,et,sn).call(this))),ut.click()},Y=new WeakSet,Qn=function(){const{div:ut}=this;let{width:o,height:h}=s(this,ht);const[c,m]=this.pageDimensions,k=.75;if(this.width)o=this.width*c,h=this.height*m;else if(o>k*c||h>k*m){const Nt=Math.min(k*c/o,k*m/h);o*=Nt,h*=Nt}const[it,gt]=this.parentDimensions;this.setDims(o*it/c,h*gt/m),this._uiManager.enableWaiting(!1);const vt=Ut(this,dt,document.createElement("canvas"));ut.append(vt),ut.hidden=!1,xt(this,at,Zn).call(this,o,h),xt(this,Pt,Ls).call(this),s(this,tt)||(this.parent.addUndoableEditor(this),Ut(this,tt,!0)),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"inserted_image"}}}),this.addAltTextButton()},ft=new WeakSet,Ms=function(ut,o){var k;const[h,c]=this.parentDimensions;this.width=ut/h,this.height=o/c,this.setDims(ut,o),(k=this._initialOptions)!=null&&k.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,s(this,nt)!==null&&clearTimeout(s(this,nt)),Ut(this,nt,setTimeout(()=>{Ut(this,nt,null),xt(this,at,Zn).call(this,ut,o)},200))},Tt=new WeakSet,Ds=function(ut,o){const{width:h,height:c}=s(this,ht);let m=h,k=c,it=s(this,ht);for(;m>2*ut||k>2*o;){const gt=m,vt=k;m>2*ut&&(m=m>=16384?Math.floor(m/2)-1:Math.ceil(m/2)),k>2*o&&(k=k>=16384?Math.floor(k/2)-1:Math.ceil(k/2));const Nt=new OffscreenCanvas(m,k);Nt.getContext("2d").drawImage(it,0,0,gt,vt,0,0,m,k),it=Nt.transferToImageBitmap()}return it},at=new WeakSet,Zn=function(ut,o){ut=Math.ceil(ut),o=Math.ceil(o);const h=s(this,dt);if(!h||h.width===ut&&h.height===o)return;h.width=ut,h.height=o;const c=s(this,j)?s(this,ht):xt(this,Tt,Ds).call(this,ut,o),m=h.getContext("2d");m.filter=this._uiManager.hcmFilter,m.drawImage(c,0,0,c.width,c.height,0,0,ut,o)},Bt=new WeakSet,_n=function(ut){if(ut){if(s(this,j)){const c=this._uiManager.imageManager.getSvgUrl(s(this,rt));if(c)return c}const o=document.createElement("canvas");return{width:o.width,height:o.height}=s(this,ht),o.getContext("2d").drawImage(s(this,ht),0,0),o.toDataURL()}if(s(this,j)){const[o,h]=this.pageDimensions,c=Math.round(this.width*o*St.PixelsPerInch.PDF_TO_CSS_UNITS),m=Math.round(this.height*h*St.PixelsPerInch.PDF_TO_CSS_UNITS),k=new OffscreenCanvas(c,m);return k.getContext("2d").drawImage(s(this,ht),0,0,s(this,ht).width,s(this,ht).height,0,0,c,m),k.transferToImageBitmap()}return structuredClone(s(this,ht))},Pt=new WeakSet,Ls=function(){Ut(this,st,new ResizeObserver(ut=>{const o=ut[0].contentRect;o.width&&o.height&&xt(this,ft,Ms).call(this,o.width,o.height)})),s(this,st).observe(this.div)},Ie(Jt,"_type","stamp");let Wt=Jt;e.StampEditor=Wt}],__webpack_module_cache__={};function __w_pdfjs_require__(d){var e=__webpack_module_cache__[d];if(e!==void 0)return e.exports;var ot=__webpack_module_cache__[d]={exports:{}};return __webpack_modules__[d](ot,ot.exports,__w_pdfjs_require__),ot.exports}var __webpack_exports__={};return(()=>{var d=__webpack_exports__;Object.defineProperty(d,"__esModule",{value:!0}),Object.defineProperty(d,"AbortException",{enumerable:!0,get:function(){return e.AbortException}}),Object.defineProperty(d,"AnnotationEditorLayer",{enumerable:!0,get:function(){return St.AnnotationEditorLayer}}),Object.defineProperty(d,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return e.AnnotationEditorParamsType}}),Object.defineProperty(d,"AnnotationEditorType",{enumerable:!0,get:function(){return e.AnnotationEditorType}}),Object.defineProperty(d,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return bt.AnnotationEditorUIManager}}),Object.defineProperty(d,"AnnotationLayer",{enumerable:!0,get:function(){return Wt.AnnotationLayer}}),Object.defineProperty(d,"AnnotationMode",{enumerable:!0,get:function(){return e.AnnotationMode}}),Object.defineProperty(d,"CMapCompressionType",{enumerable:!0,get:function(){return e.CMapCompressionType}}),Object.defineProperty(d,"DOMSVGFactory",{enumerable:!0,get:function(){return i.DOMSVGFactory}}),Object.defineProperty(d,"FeatureTest",{enumerable:!0,get:function(){return e.FeatureTest}}),Object.defineProperty(d,"GlobalWorkerOptions",{enumerable:!0,get:function(){return ht.GlobalWorkerOptions}}),Object.defineProperty(d,"ImageKind",{enumerable:!0,get:function(){return e.ImageKind}}),Object.defineProperty(d,"InvalidPDFException",{enumerable:!0,get:function(){return e.InvalidPDFException}}),Object.defineProperty(d,"MissingPDFException",{enumerable:!0,get:function(){return e.MissingPDFException}}),Object.defineProperty(d,"OPS",{enumerable:!0,get:function(){return e.OPS}}),Object.defineProperty(d,"PDFDataRangeTransport",{enumerable:!0,get:function(){return ot.PDFDataRangeTransport}}),Object.defineProperty(d,"PDFDateString",{enumerable:!0,get:function(){return i.PDFDateString}}),Object.defineProperty(d,"PDFWorker",{enumerable:!0,get:function(){return ot.PDFWorker}}),Object.defineProperty(d,"PasswordResponses",{enumerable:!0,get:function(){return e.PasswordResponses}}),Object.defineProperty(d,"PermissionFlag",{enumerable:!0,get:function(){return e.PermissionFlag}}),Object.defineProperty(d,"PixelsPerInch",{enumerable:!0,get:function(){return i.PixelsPerInch}}),Object.defineProperty(d,"PromiseCapability",{enumerable:!0,get:function(){return e.PromiseCapability}}),Object.defineProperty(d,"RenderingCancelledException",{enumerable:!0,get:function(){return i.RenderingCancelledException}}),Object.defineProperty(d,"SVGGraphics",{enumerable:!0,get:function(){return ot.SVGGraphics}}),Object.defineProperty(d,"UnexpectedResponseException",{enumerable:!0,get:function(){return e.UnexpectedResponseException}}),Object.defineProperty(d,"Util",{enumerable:!0,get:function(){return e.Util}}),Object.defineProperty(d,"VerbosityLevel",{enumerable:!0,get:function(){return e.VerbosityLevel}}),Object.defineProperty(d,"XfaLayer",{enumerable:!0,get:function(){return rt.XfaLayer}}),Object.defineProperty(d,"build",{enumerable:!0,get:function(){return ot.build}}),Object.defineProperty(d,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return e.createValidAbsoluteUrl}}),Object.defineProperty(d,"getDocument",{enumerable:!0,get:function(){return ot.getDocument}}),Object.defineProperty(d,"getFilenameFromUrl",{enumerable:!0,get:function(){return i.getFilenameFromUrl}}),Object.defineProperty(d,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return i.getPdfFilenameFromUrl}}),Object.defineProperty(d,"getXfaPageViewport",{enumerable:!0,get:function(){return i.getXfaPageViewport}}),Object.defineProperty(d,"isDataScheme",{enumerable:!0,get:function(){return i.isDataScheme}}),Object.defineProperty(d,"isPdfFile",{enumerable:!0,get:function(){return i.isPdfFile}}),Object.defineProperty(d,"loadScript",{enumerable:!0,get:function(){return i.loadScript}}),Object.defineProperty(d,"noContextMenu",{enumerable:!0,get:function(){return i.noContextMenu}}),Object.defineProperty(d,"normalizeUnicode",{enumerable:!0,get:function(){return e.normalizeUnicode}}),Object.defineProperty(d,"renderTextLayer",{enumerable:!0,get:function(){return b.renderTextLayer}}),Object.defineProperty(d,"setLayerDimensions",{enumerable:!0,get:function(){return i.setLayerDimensions}}),Object.defineProperty(d,"shadow",{enumerable:!0,get:function(){return e.shadow}}),Object.defineProperty(d,"updateTextLayer",{enumerable:!0,get:function(){return b.updateTextLayer}}),Object.defineProperty(d,"version",{enumerable:!0,get:function(){return ot.version}});var e=__w_pdfjs_require__(1),ot=__w_pdfjs_require__(2),i=__w_pdfjs_require__(6),b=__w_pdfjs_require__(26),St=__w_pdfjs_require__(27),bt=__w_pdfjs_require__(5),Wt=__w_pdfjs_require__(29),ht=__w_pdfjs_require__(14),rt=__w_pdfjs_require__(32)})(),__webpack_exports__})())})(pdf$1);var pdfExports=pdf$1.exports;const pdf=getDefaultExportFromCjs(pdfExports),pdfjsModule=_mergeNamespaces({__proto__:null,default:pdf},[pdfExports]),pdfjs="default"in pdfjsModule?pdf:pdfjsModule,pdfjs$1=pdfjs;var __spreadArray=globalThis&&globalThis.__spreadArray||function(d,e,ot){if(ot||arguments.length===2)for(var i=0,b=e.length,St;i<b;i++)(St||!(i in e))&&(St||(St=Array.prototype.slice.call(e,0,i)),St[i]=e[i]);return d.concat(St||Array.prototype.slice.call(e))},clipboardEvents=["onCopy","onCut","onPaste"],compositionEvents=["onCompositionEnd","onCompositionStart","onCompositionUpdate"],focusEvents=["onFocus","onBlur"],formEvents=["onInput","onInvalid","onReset","onSubmit"],imageEvents=["onLoad","onError"],keyboardEvents=["onKeyDown","onKeyPress","onKeyUp"],mediaEvents=["onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onError","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting"],mouseEvents=["onClick","onContextMenu","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp"],dragEvents=["onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop"],selectionEvents=["onSelect"],touchEvents=["onTouchCancel","onTouchEnd","onTouchMove","onTouchStart"],pointerEvents=["onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onGotPointerCapture","onLostPointerCapture","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut"],uiEvents=["onScroll"],wheelEvents=["onWheel"],animationEvents=["onAnimationStart","onAnimationEnd","onAnimationIteration"],transitionEvents=["onTransitionEnd"],otherEvents=["onToggle"],changeEvents=["onChange"],allEvents=__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray([],clipboardEvents,!0),compositionEvents,!0),focusEvents,!0),formEvents,!0),imageEvents,!0),keyboardEvents,!0),mediaEvents,!0),mouseEvents,!0),dragEvents,!0),selectionEvents,!0),touchEvents,!0),pointerEvents,!0),uiEvents,!0),wheelEvents,!0),animationEvents,!0),transitionEvents,!0),changeEvents,!0),otherEvents,!0);function makeEventProps(d,e){var ot={};return allEvents.forEach(function(i){var b=d[i];b&&(e?ot[i]=function(St){return b(St,e(i))}:ot[i]=b)}),ot}function makeCancellablePromise(d){var e=!1,ot=new Promise(function(i,b){d.then(function(St){return!e&&i(St)}).catch(function(St){return!e&&b(St)})});return{promise:ot,cancel:function(){e=!0}}}function r(d){var e,ot,i="";if(typeof d=="string"||typeof d=="number")i+=d;else if(typeof d=="object")if(Array.isArray(d)){var b=d.length;for(e=0;e<b;e++)d[e]&&(ot=r(d[e]))&&(i&&(i+=" "),i+=ot)}else for(ot in d)d[ot]&&(i&&(i+=" "),i+=ot);return i}function clsx(){for(var d,e,ot=0,i="",b=arguments.length;ot<b;ot++)(d=arguments[ot])&&(e=r(d))&&(i&&(i+=" "),i+=e);return i}var isProduction=!0,prefix="Invariant failed";function invariant(d,e){if(!d){if(isProduction)throw new Error(prefix);var ot=typeof e=="function"?e():e,i=ot?"".concat(prefix,": ").concat(ot):prefix;throw new Error(i)}}const DocumentContext=reactExports.createContext(null);function Message({children:d,type:e}){return React.createElement("div",{className:`react-pdf__message react-pdf__message--${e}`},d)}const DEFAULT_LINK_REL="noopener noreferrer nofollow";class LinkService{constructor(){this.externalLinkEnabled=!0,this.externalLinkRel=void 0,this.externalLinkTarget=void 0,this.isInPresentationMode=!1,this.pdfDocument=void 0,this.pdfViewer=void 0}setDocument(e){this.pdfDocument=e}setViewer(e){this.pdfViewer=e}setExternalLinkRel(e){this.externalLinkRel=e}setExternalLinkTarget(e){this.externalLinkTarget=e}setHistory(){}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return invariant(this.pdfViewer,"PDF viewer is not initialized."),this.pdfViewer.currentPageNumber||0}set page(e){invariant(this.pdfViewer,"PDF viewer is not initialized."),this.pdfViewer.currentPageNumber=e}get rotation(){return 0}set rotation(e){}goToDestination(e){return new Promise(ot=>{invariant(this.pdfDocument,"PDF document not loaded."),invariant(e,"Destination is not specified."),typeof e=="string"?this.pdfDocument.getDestination(e).then(ot):Array.isArray(e)?ot(e):e.then(ot)}).then(ot=>{invariant(Array.isArray(ot),`"${ot}" is not a valid destination array.`);const i=ot[0];new Promise(b=>{invariant(this.pdfDocument,"PDF document not loaded."),i instanceof Object?this.pdfDocument.getPageIndex(i).then(St=>{b(St)}).catch(()=>{invariant(!1,`"${i}" is not a valid page reference.`)}):typeof i=="number"?b(i):invariant(!1,`"${i}" is not a valid destination reference.`)}).then(b=>{const St=b+1;invariant(this.pdfViewer,"PDF viewer is not initialized."),invariant(St>=1&&St<=this.pagesCount,`"${St}" is not a valid page number.`),this.pdfViewer.scrollPageIntoView({dest:ot,pageIndex:b,pageNumber:St})})})}navigateTo(e){this.goToDestination(e)}goToPage(e){const ot=e-1;invariant(this.pdfViewer,"PDF viewer is not initialized."),invariant(e>=1&&e<=this.pagesCount,`"${e}" is not a valid page number.`),this.pdfViewer.scrollPageIntoView({pageIndex:ot,pageNumber:e})}addLinkAttributes(e,ot,i){e.href=ot,e.rel=this.externalLinkRel||DEFAULT_LINK_REL,e.target=i?"_blank":this.externalLinkTarget||""}getDestinationHash(){return"#"}getAnchorUrl(){return"#"}setHash(){}executeNamedAction(){}cachePageRef(){}isPageVisible(){return!0}isPageCached(){return!0}executeSetOCGState(){}}const PasswordResponses={NEED_PASSWORD:1,INCORRECT_PASSWORD:2},PasswordResponses$1=PasswordResponses,isBrowser=typeof document<"u",isLocalFileSystem=isBrowser&&window.location.protocol==="file:";function isDefined(d){return typeof d<"u"}function isProvided(d){return isDefined(d)&&d!==null}function isString(d){return typeof d=="string"}function isArrayBuffer(d){return d instanceof ArrayBuffer}function isBlob(d){return invariant(isBrowser,"isBlob can only be used in a browser environment"),d instanceof Blob}function isDataURI(d){return isString(d)&&/^data:/.test(d)}function dataURItoByteString(d){invariant(isDataURI(d),"Invalid data URI.");const[e="",ot=""]=d.split(",");return e.split(";").indexOf("base64")!==-1?atob(ot):unescape(ot)}function getDevicePixelRatio(){return isBrowser&&window.devicePixelRatio||1}const allowFileAccessFromFilesTip="On Chromium based browsers, you can use --allow-file-access-from-files flag for debugging purposes.";function displayCORSWarning(){warning$1(!isLocalFileSystem,`Loading PDF as base64 strings/URLs may not work on protocols other than HTTP/HTTPS. ${allowFileAccessFromFilesTip}`)}function displayWorkerWarning(){warning$1(!isLocalFileSystem,`Loading PDF.js worker may not work on protocols other than HTTP/HTTPS. ${allowFileAccessFromFilesTip}`)}function cancelRunningTask(d){d&&d.cancel&&d.cancel()}function makePageCallback(d,e){return Object.defineProperty(d,"width",{get(){return this.view[2]*e},configurable:!0}),Object.defineProperty(d,"height",{get(){return this.view[3]*e},configurable:!0}),Object.defineProperty(d,"originalWidth",{get(){return this.view[2]},configurable:!0}),Object.defineProperty(d,"originalHeight",{get(){return this.view[3]},configurable:!0}),d}function isCancelException(d){return d.name==="RenderingCancelledException"}function loadFromFile(d){return new Promise((e,ot)=>{const i=new FileReader;i.onload=()=>{if(!i.result)return ot(new Error("Error while reading a file."));e(i.result)},i.onerror=b=>{if(!b.target)return ot(new Error("Error while reading a file."));const{error:St}=b.target;if(!St)return ot(new Error("Error while reading a file."));switch(St.code){case St.NOT_FOUND_ERR:return ot(new Error("Error while reading a file: File not found."));case St.SECURITY_ERR:return ot(new Error("Error while reading a file: Security error."));case St.ABORT_ERR:return ot(new Error("Error while reading a file: Aborted."));default:return ot(new Error("Error while reading a file."))}},i.readAsArrayBuffer(d)})}function reducer(d,e){switch(e.type){case"RESOLVE":return{value:e.value,error:void 0};case"REJECT":return{value:!1,error:e.error};case"RESET":return{value:void 0,error:void 0};default:return d}}function useResolver(){return reactExports.useReducer(reducer,{value:void 0,error:void 0})}const{PDFDataRangeTransport:PDFDataRangeTransport$1}=pdfjs$1,eventProps=(()=>{const d={};return allEvents.forEach(e=>{d[e]=PropTypes.func}),d})(),isTypedArray=PropTypes.oneOfType([PropTypes.instanceOf(Int8Array),PropTypes.instanceOf(Uint8Array),PropTypes.instanceOf(Uint8ClampedArray),PropTypes.instanceOf(Int16Array),PropTypes.instanceOf(Uint16Array),PropTypes.instanceOf(Int32Array),PropTypes.instanceOf(Uint32Array),PropTypes.instanceOf(Float32Array),PropTypes.instanceOf(Float64Array)]),fileTypes=[PropTypes.string,PropTypes.instanceOf(ArrayBuffer),PropTypes.shape({data:PropTypes.oneOfType([PropTypes.string,PropTypes.instanceOf(ArrayBuffer),PropTypes.arrayOf(PropTypes.number.isRequired),isTypedArray]).isRequired}),PropTypes.shape({range:PropTypes.instanceOf(PDFDataRangeTransport$1).isRequired}),PropTypes.shape({url:PropTypes.string.isRequired})];typeof Blob<"u"&&fileTypes.push(PropTypes.instanceOf(Blob));const isClassName=PropTypes.oneOfType([PropTypes.string,PropTypes.arrayOf(PropTypes.string)]),isFile=PropTypes.oneOfType(fileTypes);PropTypes.instanceOf(LinkService);PropTypes.oneOf(["_self","_blank","_parent","_top"]);PropTypes.shape({commonObjs:PropTypes.shape({}).isRequired,getAnnotations:PropTypes.func.isRequired,getTextContent:PropTypes.func.isRequired,getViewport:PropTypes.func.isRequired,render:PropTypes.func.isRequired});const isPageIndex=function d(e,ot,i){const{[ot]:b,pageNumber:St,pdf:bt}=e;if(!isDefined(bt))return null;if(isDefined(b)){if(typeof b!="number")return new Error(`\`${ot}\` of type \`${typeof b}\` supplied to \`${i}\`, expected \`number\`.`);if(b<0)return new Error(`Expected \`${ot}\` to be greater or equal to 0.`);const{numPages:Wt}=bt;if(b+1>Wt)return new Error(`Expected \`${ot}\` to be less or equal to ${Wt-1}.`)}else if(!isDefined(St))return new Error(`\`${ot}\` not supplied. Either pageIndex or pageNumber must be supplied to \`${i}\`.`);return null},isPageNumber=function d(e,ot,i){const{[ot]:b,pageIndex:St,pdf:bt}=e;if(!isDefined(bt))return null;if(isDefined(b)){if(typeof b!="number")return new Error(`\`${ot}\` of type \`${typeof b}\` supplied to \`${i}\`, expected \`number\`.`);if(b<1)return new Error(`Expected \`${ot}\` to be greater or equal to 1.`);const{numPages:Wt}=bt;if(b>Wt)return new Error(`Expected \`${ot}\` to be less or equal to ${Wt}.`)}else if(!isDefined(St))return new Error(`\`${ot}\` not supplied. Either pageIndex or pageNumber must be supplied to \`${i}\`.`);return null},isPdf=PropTypes.oneOfType([PropTypes.any,PropTypes.oneOf([!1])]),isRef=PropTypes.oneOfType([PropTypes.func,PropTypes.exact({current:PropTypes.any})]),isRenderMode=PropTypes.oneOf(["canvas","custom","none","svg"]),isRotate=PropTypes.oneOf([0,90,180,270]);var __awaiter=globalThis&&globalThis.__awaiter||function(d,e,ot,i){function b(St){return St instanceof ot?St:new ot(function(bt){bt(St)})}return new(ot||(ot=Promise))(function(St,bt){function Wt(X){try{rt(i.next(X))}catch(mt){bt(mt)}}function ht(X){try{rt(i.throw(X))}catch(mt){bt(mt)}}function rt(X){X.done?St(X.value):b(X.value).then(Wt,ht)}rt((i=i.apply(d,e||[])).next())})},__rest$1=globalThis&&globalThis.__rest||function(d,e){var ot={};for(var i in d)Object.prototype.hasOwnProperty.call(d,i)&&e.indexOf(i)<0&&(ot[i]=d[i]);if(d!=null&&typeof Object.getOwnPropertySymbols=="function")for(var b=0,i=Object.getOwnPropertySymbols(d);b<i.length;b++)e.indexOf(i[b])<0&&Object.prototype.propertyIsEnumerable.call(d,i[b])&&(ot[i[b]]=d[i[b]]);return ot};const{PDFDataRangeTransport}=pdfjs$1,defaultOnPassword=(d,e)=>{switch(e){case PasswordResponses$1.NEED_PASSWORD:{const ot=prompt("Enter the password to open this PDF file.");d(ot);break}case PasswordResponses$1.INCORRECT_PASSWORD:{const ot=prompt("Invalid password. Please try again.");d(ot);break}}};function isParameterObject(d){return typeof d=="object"&&d!==null&&("data"in d||"range"in d||"url"in d)}const Document=reactExports.forwardRef(function d(e,ot){var{children:i,className:b,error:St="Failed to load PDF file.",externalLinkRel:bt,externalLinkTarget:Wt,file:ht,inputRef:rt,imageResourcesPath:X,loading:mt="Loading PDF…",noData:_t="No PDF file specified.",onItemClick:dt,onLoadError:st,onLoadProgress:nt,onLoadSuccess:j,onPassword:tt=defaultOnPassword,onSourceError:ct,onSourceSuccess:lt,options:et,renderMode:f,rotate:_}=e,pt=__rest$1(e,["children","className","error","externalLinkRel","externalLinkTarget","file","inputRef","imageResourcesPath","loading","noData","onItemClick","onLoadError","onLoadProgress","onLoadSuccess","onPassword","onSourceError","onSourceSuccess","options","renderMode","rotate"]);const[Y,g]=useResolver(),{value:ft,error:$}=Y,[Tt,wt]=useResolver(),{value:at,error:Rt}=Tt,Bt=reactExports.useRef(new LinkService),$t=reactExports.useRef([]),Pt=reactExports.useRef(),Vt=reactExports.useRef();reactExports.useEffect(()=>{ht&&ht!==Pt.current&&isParameterObject(ht)&&(warning$1(!dequal(ht,Pt.current),`File prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "file" prop.`),Pt.current=ht)},[ht]),reactExports.useEffect(()=>{et&&et!==Vt.current&&(warning$1(!dequal(et,Vt.current),`Options prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "options" prop.`),Vt.current=et)},[et]);const Jt=reactExports.useRef({scrollPageIntoView:Yt=>{const{dest:Gt,pageNumber:le,pageIndex:ge=le-1}=Yt;if(dt){dt({dest:Gt,pageIndex:ge,pageNumber:le});return}const ne=$t.current[ge];if(ne){ne.scrollIntoView();return}warning$1(!1,`An internal link leading to page ${le} was clicked, but neither <Document> was provided with onItemClick nor it was able to find the page within itself. Either provide onItemClick to <Document> and handle navigating by yourself or ensure that all pages are rendered within <Document>.`)}});reactExports.useImperativeHandle(ot,()=>({linkService:Bt,pages:$t,viewer:Jt}),[]);function se(){lt&&lt()}function re(){$&&(warning$1(!1,$.toString()),ct&&ct($))}function ut(){g({type:"RESET"})}reactExports.useEffect(ut,[ht,g]);const o=reactExports.useCallback(()=>__awaiter(this,void 0,void 0,function*(){if(!ht)return null;if(typeof ht=="string")return isDataURI(ht)?{data:dataURItoByteString(ht)}:(displayCORSWarning(),{url:ht});if(ht instanceof PDFDataRangeTransport)return{range:ht};if(isArrayBuffer(ht))return{data:ht};if(isBrowser&&isBlob(ht))return{data:yield loadFromFile(ht)};if(invariant(typeof ht=="object","Invalid parameter in file, need either Uint8Array, string or a parameter object"),invariant(isParameterObject(ht),"Invalid parameter object: need either .data, .range or .url"),"url"in ht&&typeof ht.url=="string"){if(isDataURI(ht.url)){const{url:Yt}=ht,Gt=__rest$1(ht,["url"]),le=dataURItoByteString(Yt);return Object.assign({data:le},Gt)}displayCORSWarning()}return ht}),[ht]);reactExports.useEffect(()=>{const Yt=makeCancellablePromise(o());return Yt.promise.then(Gt=>{g({type:"RESOLVE",value:Gt})}).catch(Gt=>{g({type:"REJECT",error:Gt})}),()=>{cancelRunningTask(Yt)}},[o,g]),reactExports.useEffect(()=>{if(!(typeof ft>"u")){if(ft===!1){re();return}se()}},[ft]);function h(){at&&(j&&j(at),$t.current=new Array(at.numPages),Bt.current.setDocument(at))}function c(){Rt&&(warning$1(!1,Rt.toString()),st&&st(Rt))}function m(){wt({type:"RESET"})}reactExports.useEffect(m,[wt,ft]);function k(){if(!ft)return;const Yt=Object.assign(Object.assign({},et),{isEvalSupported:!1}),Gt=Object.assign(Object.assign({},ft),Yt),le=pdfjs$1.getDocument(Gt);nt&&(le.onProgress=nt),tt&&(le.onPassword=tt);const ge=le;return ge.promise.then(ne=>{wt({type:"RESOLVE",value:ne})}).catch(ne=>{ge.destroyed||wt({type:"REJECT",error:ne})}),()=>{ge.destroy()}}reactExports.useEffect(k,[et,wt,ft]),reactExports.useEffect(()=>{if(!(typeof at>"u")){if(at===!1){c();return}h()}},[at]);function it(){Bt.current.setViewer(Jt.current),Bt.current.setExternalLinkRel(bt),Bt.current.setExternalLinkTarget(Wt)}reactExports.useEffect(it,[bt,Wt]);function gt(Yt,Gt){$t.current[Yt]=Gt}function vt(Yt){delete $t.current[Yt]}const Nt=reactExports.useMemo(()=>({imageResourcesPath:X,linkService:Bt.current,onItemClick:dt,pdf:at,registerPage:gt,renderMode:f,rotate:_,unregisterPage:vt}),[X,dt,at,f,_]),Lt=reactExports.useMemo(()=>makeEventProps(pt,()=>at),[pt,at]);function jt(){return React.createElement(DocumentContext.Provider,{value:Nt},i)}function zt(){return ht?at==null?React.createElement(Message,{type:"loading"},typeof mt=="function"?mt():mt):at===!1?React.createElement(Message,{type:"error"},typeof St=="function"?St():St):jt():React.createElement(Message,{type:"no-data"},typeof _t=="function"?_t():_t)}return React.createElement("div",Object.assign({className:clsx("react-pdf__Document",b),ref:rt,style:{"--scale-factor":"1"}},Lt),zt())}),isFunctionOrNode$1=PropTypes.oneOfType([PropTypes.func,PropTypes.node]);Document.propTypes=Object.assign(Object.assign({},eventProps),{children:PropTypes.node,className:isClassName,error:isFunctionOrNode$1,externalLinkRel:PropTypes.string,externalLinkTarget:PropTypes.oneOf(["_self","_blank","_parent","_top"]),file:isFile,imageResourcesPath:PropTypes.string,inputRef:isRef,loading:isFunctionOrNode$1,noData:isFunctionOrNode$1,onItemClick:PropTypes.func,onLoadError:PropTypes.func,onLoadProgress:PropTypes.func,onLoadSuccess:PropTypes.func,onPassword:PropTypes.func,onSourceError:PropTypes.func,onSourceSuccess:PropTypes.func,options:PropTypes.shape({canvasFactory:PropTypes.any,canvasMaxAreaInBytes:PropTypes.number,cMapPacked:PropTypes.bool,CMapReaderFactory:PropTypes.any,cMapUrl:PropTypes.string,disableAutoFetch:PropTypes.bool,disableFontFace:PropTypes.bool,disableRange:PropTypes.bool,disableStream:PropTypes.bool,docBaseUrl:PropTypes.string,enableXfa:PropTypes.bool,filterFactory:PropTypes.any,fontExtraProperties:PropTypes.bool,httpHeaders:PropTypes.object,isEvalSupported:PropTypes.bool,isOffscreenCanvasSupported:PropTypes.bool,length:PropTypes.number,maxImageSize:PropTypes.number,ownerDocument:PropTypes.any,password:PropTypes.string,pdfBug:PropTypes.bool,rangeChunkSize:PropTypes.number,StandardFontDataFactory:PropTypes.any,standardFontDataUrl:PropTypes.string,stopAtErrors:PropTypes.bool,useSystemFonts:PropTypes.bool,useWorkerFetch:PropTypes.bool,verbosity:PropTypes.number,withCredentials:PropTypes.bool,worker:PropTypes.any}),rotate:PropTypes.number});const Document$1=Document;function useDocumentContext(){return reactExports.useContext(DocumentContext)}function mergeRefs(){for(var d=[],e=0;e<arguments.length;e++)d[e]=arguments[e];var ot=d.filter(Boolean);if(ot.length<=1){var i=ot[0];return i||null}return function(St){ot.forEach(function(bt){typeof bt=="function"?bt(St):bt&&(bt.current=St)})}}const PageContext=reactExports.createContext(null),PDF_ROLE_TO_HTML_ROLE={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},HEADING_PATTERN=/^H(\d+)$/;function isPdfRole(d){return d in PDF_ROLE_TO_HTML_ROLE}function isStructTreeNode(d){return"children"in d}function isStructTreeNodeWithOnlyContentChild(d){return isStructTreeNode(d)?d.children.length===1&&0 in d.children&&"id"in d.children[0]:!1}function getRoleAttributes(d){const e={};if(isStructTreeNode(d)){const{role:ot}=d,i=ot.match(HEADING_PATTERN);if(i)e.role="heading",e["aria-level"]=Number(i[1]);else if(isPdfRole(ot)){const b=PDF_ROLE_TO_HTML_ROLE[ot];b&&(e.role=b)}}return e}function getBaseAttributes(d){const e={};if(isStructTreeNode(d)){if(d.alt!==void 0&&(e["aria-label"]=d.alt),d.lang!==void 0&&(e.lang=d.lang),isStructTreeNodeWithOnlyContentChild(d)){const[ot]=d.children;if(ot){const i=getBaseAttributes(ot);return Object.assign(Object.assign({},e),i)}}}else"id"in d&&(e["aria-owns"]=d.id);return e}function getAttributes(d){return d?Object.assign(Object.assign({},getRoleAttributes(d)),getBaseAttributes(d)):null}function StructTreeItem({className:d,node:e}){const ot=reactExports.useMemo(()=>getAttributes(e),[e]),i=reactExports.useMemo(()=>!isStructTreeNode(e)||isStructTreeNodeWithOnlyContentChild(e)?null:e.children.map((b,St)=>React.createElement(StructTreeItem,{key:St,node:b})),[e]);return React.createElement("span",Object.assign({className:d},ot),i)}function usePageContext(){return reactExports.useContext(PageContext)}function StructTree(){const d=usePageContext();invariant(d,"Unable to find Page context.");const{onGetStructTreeError:e,onGetStructTreeSuccess:ot}=d,[i,b]=useResolver(),{value:St,error:bt}=i,{customTextRenderer:Wt,page:ht}=d;function rt(){St&&ot&&ot(St)}function X(){bt&&(warning$1(!1,bt.toString()),e&&e(bt))}function mt(){b({type:"RESET"})}reactExports.useEffect(mt,[b,ht]);function _t(){if(Wt||!ht)return;const dt=makeCancellablePromise(ht.getStructTree()),st=dt;return dt.promise.then(nt=>{b({type:"RESOLVE",value:nt})}).catch(nt=>{b({type:"REJECT",error:nt})}),()=>cancelRunningTask(st)}return reactExports.useEffect(_t,[Wt,ht,b]),reactExports.useEffect(()=>{if(St!==void 0){if(St===!1){X();return}rt()}},[St]),St?React.createElement(StructTreeItem,{className:"react-pdf__Page__structTree structTree",node:St}):null}const ANNOTATION_MODE=pdfjs$1.AnnotationMode;function PageCanvas(d){const e=usePageContext();invariant(e,"Unable to find Page context.");const ot=Object.assign(Object.assign({},e),d),{_className:i,canvasBackground:b,devicePixelRatio:St=getDevicePixelRatio(),onRenderError:bt,onRenderSuccess:Wt,page:ht,renderForms:rt,renderTextLayer:X,rotate:mt,scale:_t}=ot,{canvasRef:dt}=d;invariant(ht,"Attempted to render page canvas, but no page was specified.");const st=reactExports.useRef(null);function nt(){ht&&Wt&&Wt(makePageCallback(ht,_t))}function j(f){isCancelException(f)||(warning$1(!1,f.toString()),bt&&bt(f))}const tt=reactExports.useMemo(()=>ht.getViewport({scale:_t*St,rotation:mt}),[St,ht,mt,_t]),ct=reactExports.useMemo(()=>ht.getViewport({scale:_t,rotation:mt}),[ht,mt,_t]);function lt(){if(!ht)return;ht.cleanup();const{current:f}=st;if(!f)return;f.width=tt.width,f.height=tt.height,f.style.width=`${Math.floor(ct.width)}px`,f.style.height=`${Math.floor(ct.height)}px`,f.style.visibility="hidden";const _={annotationMode:rt?ANNOTATION_MODE.ENABLE_FORMS:ANNOTATION_MODE.ENABLE,canvasContext:f.getContext("2d",{alpha:!1}),viewport:tt};b&&(_.background=b);const pt=ht.render(_),Y=pt;return pt.promise.then(()=>{f.style.visibility="",nt()}).catch(j),()=>cancelRunningTask(Y)}reactExports.useEffect(lt,[b,st,St,ht,rt,tt,ct]);const et=reactExports.useCallback(()=>{const{current:f}=st;f&&(f.width=0,f.height=0)},[st]);return reactExports.useEffect(()=>et,[et]),React.createElement("canvas",{className:`${i}__canvas`,dir:"ltr",ref:mergeRefs(dt,st),style:{display:"block",userSelect:"none"}},X?React.createElement(StructTree,null):null)}function PageSVG(){const d=usePageContext();invariant(d,"Unable to find Page context.");const{_className:e,onRenderSuccess:ot,onRenderError:i,page:b,rotate:St,scale:bt}=d;invariant(b,"Attempted to render page SVG, but no page was specified.");const[Wt,ht]=useResolver(),{value:rt,error:X}=Wt;function mt(){b&&ot&&ot(makePageCallback(b,bt))}function _t(){X&&(isCancelException(X)||(warning$1(!1,X.toString()),i&&i(X)))}const dt=reactExports.useMemo(()=>b.getViewport({scale:bt,rotation:St}),[b,St,bt]);function st(){ht({type:"RESET"})}reactExports.useEffect(st,[b,ht,dt]);function nt(){if(!b)return;const lt=makeCancellablePromise(b.getOperatorList());return lt.promise.then(et=>{new pdfjs$1.SVGGraphics(b.commonObjs,b.objs).getSVG(et,dt).then(_=>{if(!(_ instanceof SVGElement))throw new Error("getSVG returned unexpected result.");ht({type:"RESOLVE",value:_})}).catch(_=>{ht({type:"REJECT",error:_})})}).catch(et=>{ht({type:"REJECT",error:et})}),()=>cancelRunningTask(lt)}reactExports.useEffect(nt,[b,ht,dt]),reactExports.useEffect(()=>{if(rt!==void 0){if(rt===!1){_t();return}mt()}},[rt]);function j(lt){if(!lt||!rt)return;lt.firstElementChild||lt.appendChild(rt);const{width:et,height:f}=dt;rt.setAttribute("width",`${et}`),rt.setAttribute("height",`${f}`)}const{width:tt,height:ct}=dt;return React.createElement("div",{className:`${e}__svg`,ref:lt=>j(lt),style:{display:"block",backgroundColor:"white",overflow:"hidden",width:tt,height:ct,userSelect:"none"}})}function isTextItem(d){return"str"in d}function TextLayer(){const d=usePageContext();invariant(d,"Unable to find Page context.");const{customTextRenderer:e,onGetTextError:ot,onGetTextSuccess:i,onRenderTextLayerError:b,onRenderTextLayerSuccess:St,page:bt,pageIndex:Wt,pageNumber:ht,rotate:rt,scale:X}=d;invariant(bt,"Attempted to load page text content, but no page was specified.");const[mt,_t]=useResolver(),{value:dt,error:st}=mt,nt=reactExports.useRef(null),j=reactExports.useRef();warning$1(parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-text-layer"),10)===1,"TextLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-text-layer");function tt(){dt&&i&&i(dt)}function ct(){st&&(warning$1(!1,st.toString()),ot&&ot(st))}function lt(){_t({type:"RESET"})}reactExports.useEffect(lt,[bt,_t]);function et(){if(!bt)return;const $=makeCancellablePromise(bt.getTextContent()),Tt=$;return $.promise.then(wt=>{_t({type:"RESOLVE",value:wt})}).catch(wt=>{_t({type:"REJECT",error:wt})}),()=>cancelRunningTask(Tt)}reactExports.useEffect(et,[bt,_t]),reactExports.useEffect(()=>{if(dt!==void 0){if(dt===!1){ct();return}tt()}},[dt]);const f=reactExports.useCallback(()=>{St&&St()},[St]),_=reactExports.useCallback($=>{warning$1(!1,$.toString()),b&&b($)},[b]);function pt(){const $=j.current;$&&$.classList.add("active")}function Y(){const $=j.current;$&&$.classList.remove("active")}const g=reactExports.useMemo(()=>bt.getViewport({scale:X,rotation:rt}),[bt,rt,X]);function ft(){if(!bt||!dt)return;const{current:$}=nt;if(!$)return;$.innerHTML="";const Tt=bt.streamTextContent({includeMarkedContent:!0}),wt={container:$,textContentSource:Tt,viewport:g},at=pdfjs$1.renderTextLayer(wt),Rt=at;return at.promise.then(()=>{const Bt=document.createElement("div");Bt.className="endOfContent",$.append(Bt),j.current=Bt;const $t=$.querySelectorAll('[role="presentation"]');if(e){let Pt=0;dt.items.forEach((Vt,Jt)=>{if(!isTextItem(Vt))return;const se=$t[Pt];if(!se)return;const re=e(Object.assign({pageIndex:Wt,pageNumber:ht,itemIndex:Jt},Vt));se.innerHTML=re,Pt+=Vt.str&&Vt.hasEOL?2:1})}f()}).catch(_),()=>cancelRunningTask(Rt)}return reactExports.useLayoutEffect(ft,[e,_,f,bt,Wt,ht,dt,g]),React.createElement("div",{className:clsx("react-pdf__Page__textContent","textLayer"),onMouseUp:Y,onMouseDown:pt,ref:nt})}function AnnotationLayer(){const d=useDocumentContext(),e=usePageContext();invariant(e,"Unable to find Page context.");const ot=Object.assign(Object.assign({},d),e),{imageResourcesPath:i,linkService:b,onGetAnnotationsError:St,onGetAnnotationsSuccess:bt,onRenderAnnotationLayerError:Wt,onRenderAnnotationLayerSuccess:ht,page:rt,pdf:X,renderForms:mt,rotate:_t,scale:dt=1}=ot;invariant(X,"Attempted to load page annotations, but no document was specified. Wrap <Page /> in a <Document /> or pass explicit `pdf` prop."),invariant(rt,"Attempted to load page annotations, but no page was specified."),invariant(b,"Attempted to load page annotations, but no linkService was specified.");const[st,nt]=useResolver(),{value:j,error:tt}=st,ct=reactExports.useRef(null);warning$1(parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-annotation-layer"),10)===1,"AnnotationLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-annotations");function lt(){j&&bt&&bt(j)}function et(){tt&&(warning$1(!1,tt.toString()),St&&St(tt))}function f(){nt({type:"RESET"})}reactExports.useEffect(f,[nt,rt]);function _(){if(!rt)return;const $=makeCancellablePromise(rt.getAnnotations()),Tt=$;return $.promise.then(wt=>{nt({type:"RESOLVE",value:wt})}).catch(wt=>{nt({type:"REJECT",error:wt})}),()=>{cancelRunningTask(Tt)}}reactExports.useEffect(_,[nt,rt,mt]),reactExports.useEffect(()=>{if(j!==void 0){if(j===!1){et();return}lt()}},[j]);function pt(){ht&&ht()}function Y($){warning$1(!1,`${$}`),Wt&&Wt($)}const g=reactExports.useMemo(()=>rt.getViewport({scale:dt,rotation:_t}),[rt,_t,dt]);function ft(){if(!X||!rt||!b||!j)return;const{current:$}=ct;if(!$)return;const Tt=g.clone({dontFlip:!0}),wt={accessibilityManager:null,annotationCanvasMap:null,div:$,l10n:null,page:rt,viewport:Tt},at={annotations:j,annotationStorage:X.annotationStorage,div:$,downloadManager:null,imageResourcesPath:i,linkService:b,page:rt,renderForms:mt,viewport:Tt};$.innerHTML="";try{new pdfjs$1.AnnotationLayer(wt).render(at),pt()}catch(Rt){Y(Rt)}return()=>{}}return reactExports.useEffect(ft,[j,i,b,rt,mt,g]),React.createElement("div",{className:clsx("react-pdf__Page__annotations","annotationLayer"),ref:ct})}var __rest=globalThis&&globalThis.__rest||function(d,e){var ot={};for(var i in d)Object.prototype.hasOwnProperty.call(d,i)&&e.indexOf(i)<0&&(ot[i]=d[i]);if(d!=null&&typeof Object.getOwnPropertySymbols=="function")for(var b=0,i=Object.getOwnPropertySymbols(d);b<i.length;b++)e.indexOf(i[b])<0&&Object.prototype.propertyIsEnumerable.call(d,i[b])&&(ot[i[b]]=d[i[b]]);return ot};const defaultScale=1,Page=function d(e){const ot=useDocumentContext(),i=Object.assign(Object.assign({},ot),e),{_className:b="react-pdf__Page",_enableRegisterUnregisterPage:St=!0,canvasBackground:bt,canvasRef:Wt,children:ht,className:rt,customRenderer:X,customTextRenderer:mt,devicePixelRatio:_t,error:dt="Failed to load the page.",height:st,inputRef:nt,loading:j="Loading page…",noData:tt="No page specified.",onGetAnnotationsError:ct,onGetAnnotationsSuccess:lt,onGetStructTreeError:et,onGetStructTreeSuccess:f,onGetTextError:_,onGetTextSuccess:pt,onLoadError:Y,onLoadSuccess:g,onRenderAnnotationLayerError:ft,onRenderAnnotationLayerSuccess:$,onRenderError:Tt,onRenderSuccess:wt,onRenderTextLayerError:at,onRenderTextLayerSuccess:Rt,pageIndex:Bt,pageNumber:$t,pdf:Pt,registerPage:Vt,renderAnnotationLayer:Jt=!0,renderForms:se=!1,renderMode:re="canvas",renderTextLayer:ut=!0,rotate:o,scale:h=defaultScale,unregisterPage:c,width:m}=i,k=__rest(i,["_className","_enableRegisterUnregisterPage","canvasBackground","canvasRef","children","className","customRenderer","customTextRenderer","devicePixelRatio","error","height","inputRef","loading","noData","onGetAnnotationsError","onGetAnnotationsSuccess","onGetStructTreeError","onGetStructTreeSuccess","onGetTextError","onGetTextSuccess","onLoadError","onLoadSuccess","onRenderAnnotationLayerError","onRenderAnnotationLayerSuccess","onRenderError","onRenderSuccess","onRenderTextLayerError","onRenderTextLayerSuccess","pageIndex","pageNumber","pdf","registerPage","renderAnnotationLayer","renderForms","renderMode","renderTextLayer","rotate","scale","unregisterPage","width"]),[it,gt]=useResolver(),{value:vt,error:Nt}=it,Lt=reactExports.useRef(null);invariant(Pt,"Attempted to load a page, but no document was specified. Wrap <Page /> in a <Document /> or pass explicit `pdf` prop.");const jt=isProvided($t)?$t-1:Bt??null,zt=$t??(isProvided(Bt)?Bt+1:null),Yt=o??(vt?vt.rotate:null),Gt=reactExports.useMemo(()=>{if(!vt)return null;let Te=1;const Ee=h??defaultScale;if(m||st){const Ce=vt.getViewport({scale:1,rotation:Yt});m?Te=m/Ce.width:st&&(Te=st/Ce.height)}return Ee*Te},[st,vt,Yt,h,m]);function le(){return()=>{isProvided(jt)&&St&&c&&c(jt)}}reactExports.useEffect(le,[St,Pt,jt,c]);function ge(){if(g){if(!vt||!Gt)return;g(makePageCallback(vt,Gt))}if(St&&Vt){if(!isProvided(jt)||!Lt.current)return;Vt(jt,Lt.current)}}function ne(){Nt&&(warning$1(!1,Nt.toString()),Y&&Y(Nt))}function pe(){gt({type:"RESET"})}reactExports.useEffect(pe,[gt,Pt,jt]);function Kt(){if(!Pt||!zt)return;const Te=makeCancellablePromise(Pt.getPage(zt)),Ee=Te;return Te.promise.then(Ce=>{gt({type:"RESOLVE",value:Ce})}).catch(Ce=>{gt({type:"REJECT",error:Ce})}),()=>cancelRunningTask(Ee)}reactExports.useEffect(Kt,[gt,Pt,jt,zt,Vt]),reactExports.useEffect(()=>{if(vt!==void 0){if(vt===!1){ne();return}ge()}},[vt,Gt]);const Ot=reactExports.useMemo(()=>vt&&isProvided(jt)&&zt&&isProvided(Yt)&&isProvided(Gt)?{_className:b,canvasBackground:bt,customTextRenderer:mt,devicePixelRatio:_t,onGetAnnotationsError:ct,onGetAnnotationsSuccess:lt,onGetStructTreeError:et,onGetStructTreeSuccess:f,onGetTextError:_,onGetTextSuccess:pt,onRenderAnnotationLayerError:ft,onRenderAnnotationLayerSuccess:$,onRenderError:Tt,onRenderSuccess:wt,onRenderTextLayerError:at,onRenderTextLayerSuccess:Rt,page:vt,pageIndex:jt,pageNumber:zt,renderForms:se,renderTextLayer:ut,rotate:Yt,scale:Gt}:null,[b,bt,mt,_t,ct,lt,et,f,_,pt,ft,$,Tt,wt,at,Rt,vt,jt,zt,se,ut,Yt,Gt]),It=reactExports.useMemo(()=>makeEventProps(k,()=>vt&&(Gt?makePageCallback(vt,Gt):void 0)),[k,vt,Gt]),Xt=`${jt}@${Gt}/${Yt}`,ae=`${jt}/${Yt}`;function oe(){switch(re){case"custom":return invariant(X,'renderMode was set to "custom", but no customRenderer was passed.'),React.createElement(X,{key:`${Xt}_custom`});case"none":return null;case"svg":return React.createElement(PageSVG,{key:`${ae}_svg`});case"canvas":default:return React.createElement(PageCanvas,{key:`${Xt}_canvas`,canvasRef:Wt})}}function Ae(){return ut?React.createElement(TextLayer,{key:`${Xt}_text`}):null}function Pe(){return Jt?React.createElement(AnnotationLayer,{key:`${Xt}_annotations`}):null}function ve(){return React.createElement(PageContext.Provider,{value:Ot},oe(),Ae(),Pe(),ht)}function we(){return zt?Pt===null||vt===void 0||vt===null?React.createElement(Message,{type:"loading"},typeof j=="function"?j():j):Pt===!1||vt===!1?React.createElement(Message,{type:"error"},typeof dt=="function"?dt():dt):ve():React.createElement(Message,{type:"no-data"},typeof tt=="function"?tt():tt)}return React.createElement("div",Object.assign({className:clsx(b,rt),"data-page-number":zt,ref:mergeRefs(nt,Lt),style:{"--scale-factor":`${Gt}`,backgroundColor:bt||"white",position:"relative",minWidth:"min-content",minHeight:"min-content"}},It),we())},isFunctionOrNode=PropTypes.oneOfType([PropTypes.func,PropTypes.node]);Page.propTypes=Object.assign(Object.assign({},eventProps),{canvasBackground:PropTypes.string,canvasRef:isRef,children:PropTypes.node,className:isClassName,customRenderer:PropTypes.func,customTextRenderer:PropTypes.func,devicePixelRatio:PropTypes.number,error:isFunctionOrNode,height:PropTypes.number,imageResourcesPath:PropTypes.string,inputRef:isRef,loading:isFunctionOrNode,noData:isFunctionOrNode,onGetTextError:PropTypes.func,onGetTextSuccess:PropTypes.func,onLoadError:PropTypes.func,onLoadSuccess:PropTypes.func,onRenderError:PropTypes.func,onRenderSuccess:PropTypes.func,onRenderTextLayerError:PropTypes.func,onRenderTextLayerSuccess:PropTypes.func,pageIndex:isPageIndex,pageNumber:isPageNumber,pdf:isPdf,renderAnnotationLayer:PropTypes.bool,renderForms:PropTypes.bool,renderMode:isRenderMode,renderTextLayer:PropTypes.bool,rotate:isRotate,scale:PropTypes.number,width:PropTypes.number});const Page$1=Page;displayWorkerWarning();pdfjs$1.GlobalWorkerOptions.workerSrc="pdf.worker.js";export{Document$1 as D,PropTypes as P,React$1 as R,React as a,Page$1 as b,getDefaultExportFromCjs as g,pdfjs$1 as p,reactExports as r};
